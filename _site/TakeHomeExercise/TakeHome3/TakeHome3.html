<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joshua TING">
<meta name="dcterms.date" content="2024-10-21">

<title>Navigating Geospatial Mines - Take Home Exercise 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Navigating Geospatial Mines</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-On Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn1/HandsOn1.html">
 <span class="dropdown-text">Hands-On Exercise 1a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn1b/HandsOn1b.html">
 <span class="dropdown-text">Hands-On Exercise 1b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn2a/HandsOn2a.html">
 <span class="dropdown-text">Hands-On Exercise 2a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn2b/HandsOn2b.html">
 <span class="dropdown-text">Hands-On Exercise 2b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn3/HandsOn3.html">
 <span class="dropdown-text">Hands-On Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn4/HandsOn4.html">
 <span class="dropdown-text">Hands-On Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn5a/HandsOn5a.html">
 <span class="dropdown-text">Hands-On Exercise 5a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn5b/HandsOn5b.html">
 <span class="dropdown-text">Hands-On Exercise 5b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn6/HandsOn6.html">
 <span class="dropdown-text">Hands-On Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn7/HandsOn7.html">
 <span class="dropdown-text">Hands-On Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn8/HandsOn8.html">
 <span class="dropdown-text">Hands-On Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn9/HandsOn9.html">
 <span class="dropdown-text">Hands-On Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn10/HandsOn10a.html">
 <span class="dropdown-text">Hands-On Exercise 10a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../HandsOnExercise/HandsOn10/HandsOn10b.html">
 <span class="dropdown-text">Hands-On Exercise 10b</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../InClassExercise/InClass1/InClass1.html">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../InClassExercise/InClass2/InClass2.html">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../InClassExercise/InClass3/InClass3.html">
 <span class="dropdown-text">In-Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../InClassExercise/InClass4/InClass4.html">
 <span class="dropdown-text">In-Class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../InClassExercise/InClass5/InClass5.html">
 <span class="dropdown-text">In-Class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../InClassExercise/InClass6/InClass6.html">
 <span class="dropdown-text">In-Class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../InClassExercise/InClass7/InClass7.html">
 <span class="dropdown-text">In-Class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../InClassExercise/InClass8/InClass8.html">
 <span class="dropdown-text">In-Class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../InClassExercise/InClass9/InClass9.html">
 <span class="dropdown-text">In-Class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../InClassExercise/InClass10/InClass10.html">
 <span class="dropdown-text">In-Class Exercise 10a</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../TakeHomeExercise/TakeHome1/TakeHome1.html">
 <span class="dropdown-text">Take-Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../TakeHomeExercise/TakeHome2/TakeHome2.html">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../TakeHomeExercise/TakeHome3/TakeHome3.html">
 <span class="dropdown-text">Take-Home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">about the author.</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#take-home-exercise-3b-predicting-hdb-resale-prices-with-geographically-weighted-machine-learning-methods" id="toc-take-home-exercise-3b-predicting-hdb-resale-prices-with-geographically-weighted-machine-learning-methods" class="nav-link active" data-scroll-target="#take-home-exercise-3b-predicting-hdb-resale-prices-with-geographically-weighted-machine-learning-methods"><span class="header-section-number">1</span> Take-home Exercise 3b: Predicting HDB Resale Prices with Geographically Weighted Machine Learning Methods</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"><span class="header-section-number">1.1</span> Overview</a>
  <ul class="collapse">
  <li><a href="#purpose" id="toc-purpose" class="nav-link" data-scroll-target="#purpose"><span class="header-section-number">1.1.1</span> Purpose</a></li>
  </ul></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started"><span class="header-section-number">1.2</span> Getting Started</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data"><span class="header-section-number">1.3</span> The Data</a></li>
  <li><a href="#importing-data" id="toc-importing-data" class="nav-link" data-scroll-target="#importing-data"><span class="header-section-number">1.4</span> Importing Data</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling"><span class="header-section-number">1.5</span> Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#hdb-resale" id="toc-hdb-resale" class="nav-link" data-scroll-target="#hdb-resale"><span class="header-section-number">1.5.1</span> HDB Resale</a></li>
  <li><a href="#overview-of-data-sets-in-coordinate-reference-system" id="toc-overview-of-data-sets-in-coordinate-reference-system" class="nav-link" data-scroll-target="#overview-of-data-sets-in-coordinate-reference-system"><span class="header-section-number">1.5.2</span> Overview of Data sets in Coordinate Reference System</a></li>
  <li><a href="#mpsz" id="toc-mpsz" class="nav-link" data-scroll-target="#mpsz"><span class="header-section-number">1.5.3</span> MPSZ</a></li>
  <li><a href="#bus-stops" id="toc-bus-stops" class="nav-link" data-scroll-target="#bus-stops"><span class="header-section-number">1.5.4</span> Bus Stops</a></li>
  <li><a href="#eldercare" id="toc-eldercare" class="nav-link" data-scroll-target="#eldercare"><span class="header-section-number">1.5.5</span> Eldercare</a></li>
  <li><a href="#hawker" id="toc-hawker" class="nav-link" data-scroll-target="#hawker"><span class="header-section-number">1.5.6</span> Hawker</a></li>
  <li><a href="#kindergarten" id="toc-kindergarten" class="nav-link" data-scroll-target="#kindergarten"><span class="header-section-number">1.5.7</span> Kindergarten</a></li>
  <li><a href="#school" id="toc-school" class="nav-link" data-scroll-target="#school"><span class="header-section-number">1.5.8</span> School</a></li>
  <li><a href="#malls" id="toc-malls" class="nav-link" data-scroll-target="#malls"><span class="header-section-number">1.5.9</span> Malls</a></li>
  <li><a href="#park" id="toc-park" class="nav-link" data-scroll-target="#park"><span class="header-section-number">1.5.10</span> Park</a></li>
  <li><a href="#mrt" id="toc-mrt" class="nav-link" data-scroll-target="#mrt"><span class="header-section-number">1.5.11</span> MRT</a></li>
  <li><a href="#supermarket" id="toc-supermarket" class="nav-link" data-scroll-target="#supermarket"><span class="header-section-number">1.5.12</span> Supermarket</a></li>
  </ul></li>
  <li><a href="#computing-proximity-to-resale-transactions" id="toc-computing-proximity-to-resale-transactions" class="nav-link" data-scroll-target="#computing-proximity-to-resale-transactions"><span class="header-section-number">1.6</span> Computing Proximity to Resale Transactions</a></li>
  <li><a href="#visualisations" id="toc-visualisations" class="nav-link" data-scroll-target="#visualisations"><span class="header-section-number">1.7</span> Visualisations</a></li>
  <li><a href="#final-amendments" id="toc-final-amendments" class="nav-link" data-scroll-target="#final-amendments"><span class="header-section-number">1.8</span> Final Amendments</a></li>
  <li><a href="#machine-learning" id="toc-machine-learning" class="nav-link" data-scroll-target="#machine-learning"><span class="header-section-number">1.9</span> Machine Learning</a>
  <ul class="collapse">
  <li><a href="#data-sampling" id="toc-data-sampling" class="nav-link" data-scroll-target="#data-sampling"><span class="header-section-number">1.9.1</span> Data Sampling</a></li>
  <li><a href="#computing-correlation-matrix" id="toc-computing-correlation-matrix" class="nav-link" data-scroll-target="#computing-correlation-matrix"><span class="header-section-number">1.9.2</span> Computing Correlation Matrix</a></li>
  <li><a href="#retrieving-stored-data" id="toc-retrieving-stored-data" class="nav-link" data-scroll-target="#retrieving-stored-data"><span class="header-section-number">1.9.3</span> Retrieving Stored Data</a></li>
  </ul></li>
  <li><a href="#building-a-non-spatial-multiple-linear-regression" id="toc-building-a-non-spatial-multiple-linear-regression" class="nav-link" data-scroll-target="#building-a-non-spatial-multiple-linear-regression"><span class="header-section-number">1.10</span> Building a non-spatial multiple linear regression</a></li>
  <li><a href="#geographically-weighted-regression" id="toc-geographically-weighted-regression" class="nav-link" data-scroll-target="#geographically-weighted-regression"><span class="header-section-number">1.11</span> Geographically Weighted Regression</a>
  <ul class="collapse">
  <li><a href="#converting-the-sf-data.frame-to-spatialpointdataframe" id="toc-converting-the-sf-data.frame-to-spatialpointdataframe" class="nav-link" data-scroll-target="#converting-the-sf-data.frame-to-spatialpointdataframe"><span class="header-section-number">1.11.1</span> Converting the sf data.frame to SpatialPointDataFrame</a></li>
  <li><a href="#computing-adaptive-bandwidth" id="toc-computing-adaptive-bandwidth" class="nav-link" data-scroll-target="#computing-adaptive-bandwidth"><span class="header-section-number">1.11.2</span> Computing adaptive bandwidth</a></li>
  <li><a href="#constructing-the-adaptive-bandwidth-gwr-model" id="toc-constructing-the-adaptive-bandwidth-gwr-model" class="nav-link" data-scroll-target="#constructing-the-adaptive-bandwidth-gwr-model"><span class="header-section-number">1.11.3</span> Constructing the adaptive bandwidth gwr model</a></li>
  <li><a href="#retrieve-gwr-output-object" id="toc-retrieve-gwr-output-object" class="nav-link" data-scroll-target="#retrieve-gwr-output-object"><span class="header-section-number">1.11.4</span> Retrieve gwr output object</a></li>
  <li><a href="#converting-the-test-data-from-sf-data.frame-to-spatialpointdataframe" id="toc-converting-the-test-data-from-sf-data.frame-to-spatialpointdataframe" class="nav-link" data-scroll-target="#converting-the-test-data-from-sf-data.frame-to-spatialpointdataframe"><span class="header-section-number">1.11.5</span> Converting the test data from sf data.frame to SpatialPointDataFrame</a></li>
  <li><a href="#computing-adaptive-bandwidth-for-the-test-data" id="toc-computing-adaptive-bandwidth-for-the-test-data" class="nav-link" data-scroll-target="#computing-adaptive-bandwidth-for-the-test-data"><span class="header-section-number">1.11.6</span> Computing adaptive bandwidth for the test data</a></li>
  <li><a href="#computing-predicted-values-of-the-test-data" id="toc-computing-predicted-values-of-the-test-data" class="nav-link" data-scroll-target="#computing-predicted-values-of-the-test-data"><span class="header-section-number">1.11.7</span> Computing predicted values of the test data</a></li>
  </ul></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest"><span class="header-section-number">1.12</span> Random Forest</a>
  <ul class="collapse">
  <li><a href="#extracting-coordinates-data" id="toc-extracting-coordinates-data" class="nav-link" data-scroll-target="#extracting-coordinates-data"><span class="header-section-number">1.12.1</span> Extracting coordinates data</a></li>
  <li><a href="#dropping-geometry-field" id="toc-dropping-geometry-field" class="nav-link" data-scroll-target="#dropping-geometry-field"><span class="header-section-number">1.12.2</span> Dropping geometry field</a></li>
  </ul></li>
  <li><a href="#calibrating-random-forest-model" id="toc-calibrating-random-forest-model" class="nav-link" data-scroll-target="#calibrating-random-forest-model"><span class="header-section-number">1.13</span> Calibrating Random Forest Model</a></li>
  <li><a href="#calibrating-geographical-random-forest-model" id="toc-calibrating-geographical-random-forest-model" class="nav-link" data-scroll-target="#calibrating-geographical-random-forest-model"><span class="header-section-number">1.14</span> Calibrating Geographical Random Forest Model</a>
  <ul class="collapse">
  <li><a href="#predicting-by-using-test-data" id="toc-predicting-by-using-test-data" class="nav-link" data-scroll-target="#predicting-by-using-test-data"><span class="header-section-number">1.14.1</span> Predicting by using test data</a></li>
  <li><a href="#calculating-root-mean-square-error" id="toc-calculating-root-mean-square-error" class="nav-link" data-scroll-target="#calculating-root-mean-square-error"><span class="header-section-number">1.14.2</span> Calculating Root Mean Square Error</a></li>
  </ul></li>
  <li><a href="#visualising-the-predicted-values" id="toc-visualising-the-predicted-values" class="nav-link" data-scroll-target="#visualising-the-predicted-values"><span class="header-section-number">1.15</span> Visualising the predicted values</a></li>
  <li><a href="#evaluation-of-model-geographically-weighted-regression-vs-random-forest" id="toc-evaluation-of-model-geographically-weighted-regression-vs-random-forest" class="nav-link" data-scroll-target="#evaluation-of-model-geographically-weighted-regression-vs-random-forest"><span class="header-section-number">1.16</span> Evaluation of Model: Geographically Weighted Regression Vs Random Forest</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><span class="header-section-number">1.17</span> Limitations</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">1.18</span> Conclusion</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take Home Exercise 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Joshua TING </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 21, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">November 11, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="take-home-exercise-3b-predicting-hdb-resale-prices-with-geographically-weighted-machine-learning-methods" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Take-home Exercise 3b: Predicting HDB Resale Prices with Geographically Weighted Machine Learning Methods</h1>
<section id="overview" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1.1</span> Overview</h2>
<section id="purpose" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="purpose"><span class="header-section-number">1.1.1</span> Purpose</h3>
<p>In this take-home exercise, We will calibrate a predictive model to predict HDB resale prices between July-September 2024 by using HDB resale transaction records in 2023.</p>
</section>
</section>
<section id="getting-started" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="getting-started"><span class="header-section-number">1.2</span> Getting Started</h2>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, readr, sf, httr, jsonlite, rvest, dplyr, units, lubridate, tmap, ggplot2,ggpubr, beepr, corrplot, spdep, GWmodel, SpatialML, rsample, Metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Package</strong></th>
<th><strong>Function</strong></th>
<th><strong>Explanation</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>tidyverse</strong></td>
<td><code>dplyr::select</code>, <code>dplyr::mutate</code>, <code>ggplot2::ggplot</code>, <code>tibble::tibble</code></td>
<td>A collection of R packages for data manipulation (<code>dplyr</code>), data visualization (<code>ggplot2</code>), and reading (<code>readr</code>). <code>tibble</code> is for working with data frames.</td>
</tr>
<tr class="even">
<td><strong>readr</strong></td>
<td><code>readr::read_csv</code>, <code>readr::write_csv</code></td>
<td>Functions for reading and writing CSV files efficiently.</td>
</tr>
<tr class="odd">
<td><strong>sf</strong></td>
<td><code>sf::st_as_sf</code>, <code>sf::st_transform</code>, <code>sf::st_drop_geometry</code>, <code>sf::st_is_empty</code>, <code>sf::st_coordinates</code></td>
<td>Functions for handling spatial data, including converting data to <code>sf</code> objects, transforming coordinates, and checking for empty geometries.</td>
</tr>
<tr class="even">
<td><strong>httr</strong></td>
<td><code>httr::GET</code>, <code>httr::POST</code></td>
<td>Functions for making HTTP requests, such as GET and POST, to interact with web APIs.</td>
</tr>
<tr class="odd">
<td><strong>jsonlite</strong></td>
<td><code>jsonlite::fromJSON</code>, <code>jsonlite::toJSON</code></td>
<td>Functions to parse JSON data into R objects and to convert R objects into JSON format.</td>
</tr>
<tr class="even">
<td><strong>rvest</strong></td>
<td><code>rvest::read_html</code>, <code>rvest::html_nodes</code>, <code>rvest::html_table</code></td>
<td>Used for web scraping, including reading HTML content and extracting elements from web pages.</td>
</tr>
<tr class="odd">
<td><strong>dplyr</strong></td>
<td><code>dplyr::select</code>, <code>dplyr::mutate</code>, <code>dplyr::filter</code>, <code>dplyr::summarize</code></td>
<td>A core package for data manipulation, used for selecting columns, creating new columns, filtering data, and summarizing results.</td>
</tr>
<tr class="even">
<td><strong>units</strong></td>
<td><code>units::set_units</code>, <code>units::as_units</code></td>
<td>Provides functions for handling and converting physical units in R.</td>
</tr>
<tr class="odd">
<td><strong>lubridate</strong></td>
<td><code>lubridate::ymd</code>, <code>lubridate::mdy</code>, <code>lubridate::today</code></td>
<td>Functions to parse, manipulate, and work with date-time objects in a variety of formats.</td>
</tr>
<tr class="even">
<td><strong>tmap</strong></td>
<td><code>tmap::tm_shape</code>, <code>tmap::tm_borders</code>, <code>tmap::tm_fill</code></td>
<td>A package for thematic mapping. Functions allow for creating maps with geographic boundaries, fill colors, and more.</td>
</tr>
<tr class="odd">
<td><strong>ggplot2</strong></td>
<td><code>ggplot2::ggplot</code>, <code>ggplot2::geom_point</code>, <code>ggplot2::geom_line</code></td>
<td>The main visualization package in R, used for creating static graphics such as scatter plots, line charts, histograms, and more.</td>
</tr>
<tr class="even">
<td><strong>ggpubr</strong></td>
<td><code>ggpubr::ggarrange</code>, <code>ggpubr::stat_cor</code></td>
<td>Enhances <code>ggplot2</code> by allowing for arranging multiple plots and adding statistical tests, like correlation coefficients, to plots.</td>
</tr>
<tr class="odd">
<td><strong>beepr</strong></td>
<td><code>beepr::beep</code></td>
<td>A simple function to play sounds as notifications, commonly used to alert the user when an operation is complete.</td>
</tr>
<tr class="even">
<td><strong>corrplot</strong></td>
<td><code>corrplot::corrplot</code></td>
<td>Used to visualize correlation matrices, offering various plotting styles and methods for better presentation of correlations.</td>
</tr>
<tr class="odd">
<td><strong>spdep</strong></td>
<td><code>spdep::nb2listw</code>, <code>spdep::spautolm</code></td>
<td>Provides spatial econometrics tools, such as calculating spatial weights and performing spatial autoregressive models.</td>
</tr>
<tr class="even">
<td><strong>GWmodel</strong></td>
<td><code>GWmodel::gwr.basic</code>, <code>GWmodel::grf</code>, <code>GWmodel::bw.gwr</code></td>
<td>Functions for geographically weighted regression (GWR), including model fitting (<code>gwr.basic</code>), bandwidth selection, and fitting spatial regression trees.</td>
</tr>
<tr class="odd">
<td><strong>SpatialML</strong></td>
<td><code>SpatialML::SpatialCV</code>, <code>SpatialML::SpatialML</code></td>
<td>Used for machine learning models in spatial contexts, including spatial cross-validation and spatially explicit machine learning techniques.</td>
</tr>
<tr class="even">
<td><strong>rsample</strong></td>
<td><code>rsample::initial_split</code>, <code>rsample::training</code>, <code>rsample::testing</code></td>
<td>Provides tools for resampling and splitting data into training and testing sets for model validation.</td>
</tr>
<tr class="odd">
<td><strong>Metrics</strong></td>
<td><code>Metrics::rmse</code>, <code>Metrics::mae</code>, <code>Metrics::mse</code></td>
<td>Functions to calculate various performance metrics for model evaluation, including Root Mean Square Error (RMSE), Mean Absolute Error (MAE), and Mean Squared Error (MSE).</td>
</tr>
</tbody>
</table>
</section>
<section id="the-data" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="the-data"><span class="header-section-number">1.3</span> The Data</h2>
<ol type="1">
<li>Aspatial Dataset:</li>
</ol>
<ul>
<li>HDB Resale Flat Prices from <a href="https://data.gov.sg./datasets?query=HDB+resale+flat+prices&amp;page=1&amp;resultId=189">Data.gov.s</a>g</li>
</ul>
<ol start="2" type="1">
<li>Geospatial Dataset:</li>
</ol>
<ul>
<li><p>MPSZ: Boundaries of Singapore from <a href="https://www.ura.gov.sg/Corporate/Planning/Master-Plan">ura.gov.sg</a></p></li>
<li><p>Bus Stops: A list of bus stops locally from <a href="https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=bus%20stop">datamall.lta.gov.sg</a></p></li>
<li><p>Eldercare (SHP): A list of elder care centres locally from <a href="https://data.gov.sg./datasets?query=eldercare&amp;page=1&amp;resultId=d_3545b068e3f3506c56b2cb6b6117b884">data.gov.sg</a></p></li>
<li><p>Hawker Centres (KML): a list of hawker centres from <a href="https://data.gov.sg./datasets?query=hawker+centre&amp;page=1&amp;resultId=d_ccca3606c337a5c386b9c88dc0dd08b6">data.gov.sg</a></p></li>
<li><p>Kindergarten (KML) from <a href="https://data.gov.sg/datasets?query=kindergarten&amp;page=1&amp;resultId=d_95aa63998d7de94dd4cb3e8e43a5f6d5">data.gov.sg</a></p></li>
<li><p>Malls (CSV) from <a href="https://www.kaggle.com/datasets/karthikgangula/shopping-mall-coordinates">kaggle.com</a></p></li>
<li><p>Train Station (SHP) from <a href="https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=train%20station">datamall.lta.gov.sg</a></p></li>
<li><p>SDCP Park (kml) from <a href="https://data.gov.sg/datasets?query=park&amp;page=1&amp;resultId=d_dec52717093b20d30677a938d39f0dac">data.gov.sg</a></p></li>
<li><p>Schools (CSV) from <a href="https://data.gov.sg/datasets?query=general+information+of+schools&amp;page=1&amp;resultId=d_688b934f82c1059ed0a6993d2a829089">data.gov.sg</a></p></li>
<li><p>Supermarket (KML) from <a href="https://data.gov.sg/datasets?query=supermarketsKML&amp;page=1&amp;resultId=d_8a77ee0446716b2ce475a587004afc73">data.gov.sg</a></p></li>
</ul>
</section>
<section id="importing-data" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="importing-data"><span class="header-section-number">1.4</span> Importing Data</h2>
<ol type="1">
<li>Aspatial Data:</li>
</ol>
<ul>
<li>HDB Resale</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>resale2023 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/rawdata/aspatial/hdb/resale.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span> <span class="st">"2023-01"</span> <span class="sc">&amp;</span> month <span class="sc">&lt;=</span> <span class="st">"2024-09"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="2" type="1">
<li>Geospatial Data:</li>
</ol>
<ul>
<li>MPSZ in shapefile format</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">=</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/rawdata/geospatial/mpsz"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">layer =</span> <span class="st">"MP14_SUBZONE_NO_SEA_PL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MP14_SUBZONE_NO_SEA_PL' from data source 
  `/Users/joshuatingsiyuan14/Desktop/isaiahting/ISSS626_GAA/TakeHomeExercise/TakeHome3/data/rawdata/geospatial/mpsz' 
  using driver `ESRI Shapefile'
Simple feature collection with 323 features and 15 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33
Projected CRS: SVY21</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpsz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TakeHome3_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Bus Stops in shapefile format</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>busstop <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/rawdata/geospatial/busstop"</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">layer =</span> <span class="st">"BusStop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `BusStop' from data source 
  `/Users/joshuatingsiyuan14/Desktop/isaiahting/ISSS626_GAA/TakeHomeExercise/TakeHome3/data/rawdata/geospatial/busstop' 
  using driver `ESRI Shapefile'
Simple feature collection with 5166 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48285.52 ymax: 52983.82
Projected CRS: SVY21</code></pre>
</div>
</div>
<ul>
<li><strong>Eldercare</strong> in shapefile format</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>eldercare <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/rawdata/geospatial/eldercare"</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">layer =</span> <span class="st">"ELDERCARE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `ELDERCARE' from data source 
  `/Users/joshuatingsiyuan14/Desktop/isaiahting/ISSS626_GAA/TakeHomeExercise/TakeHome3/data/rawdata/geospatial/eldercare' 
  using driver `ESRI Shapefile'
Simple feature collection with 133 features and 18 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9
Projected CRS: SVY21</code></pre>
</div>
</div>
<ul>
<li>Hawker Centres in kml format</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>hawker <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/rawdata/geospatial/hawker/HawkerCentres.kml"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `HAWKERCENTRE' from data source 
  `/Users/joshuatingsiyuan14/Desktop/isaiahting/ISSS626_GAA/TakeHomeExercise/TakeHome3/data/rawdata/geospatial/hawker/HawkerCentres.kml' 
  using driver `KML'
Simple feature collection with 125 features and 2 fields
Geometry type: POINT
Dimension:     XYZ
Bounding box:  xmin: 103.6974 ymin: 1.272716 xmax: 103.9882 ymax: 1.449017
z_range:       zmin: 0 zmax: 0
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<ul>
<li>Kindergarten in fml format</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>kindergarten <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/rawdata/geospatial/kindergarten/Kindergartens.kml"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `KINDERGARTENS' from data source 
  `/Users/joshuatingsiyuan14/Desktop/isaiahting/ISSS626_GAA/TakeHomeExercise/TakeHome3/data/rawdata/geospatial/kindergarten/Kindergartens.kml' 
  using driver `KML'
Simple feature collection with 448 features and 2 fields
Geometry type: POINT
Dimension:     XYZ
Bounding box:  xmin: 103.6887 ymin: 1.247759 xmax: 103.9717 ymax: 1.455452
z_range:       zmin: 0 zmax: 0
Geodetic CRS:  WGS 84</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>kindergarten <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(kindergarten, <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Shopping Malls in csv format</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mall <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/rawdata/geospatial/mall/shopping_mall_coordinates.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Train Station in shapefile format</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mrt <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/rawdata/geospatial/mrt"</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"RapidTransitSystemStation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `RapidTransitSystemStation' from data source 
  `/Users/joshuatingsiyuan14/Desktop/isaiahting/ISSS626_GAA/TakeHomeExercise/TakeHome3/data/rawdata/geospatial/mrt' 
  using driver `ESRI Shapefile'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 230 features and 5 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 6068.209 ymin: 27478.44 xmax: 45377.5 ymax: 47913.58
Projected CRS: SVY21</code></pre>
</div>
</div>
<ul>
<li>SDCP Park in kml format</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>park <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/rawdata/geospatial/park/NParksParksandNatureReservesKML.kml"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `NPARKS_PARKS' from data source 
  `/Users/joshuatingsiyuan14/Desktop/isaiahting/ISSS626_GAA/TakeHomeExercise/TakeHome3/data/rawdata/geospatial/park/NParksParksandNatureReservesKML.kml' 
  using driver `KML'
Simple feature collection with 430 features and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY, XYZ
Bounding box:  xmin: 103.6925 ymin: 1.2115 xmax: 104.0544 ymax: 1.46419
z_range:       zmin: 0 zmax: 0
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<ul>
<li>Schools in csv format</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>school <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/rawdata/geospatial/school/Generalinformationofschools.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">postal_code =</span> <span class="fu">as.character</span>(postal_code))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Supermarket in kml format</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>supermarket <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/rawdata/geospatial/supermarket/SupermarketsKML.kml"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `SUPERMARKETS' from data source 
  `/Users/joshuatingsiyuan14/Desktop/isaiahting/ISSS626_GAA/TakeHomeExercise/TakeHome3/data/rawdata/geospatial/supermarket/SupermarketsKML.kml' 
  using driver `KML'
Simple feature collection with 526 features and 2 fields
Geometry type: POINT
Dimension:     XYZ
Bounding box:  xmin: 103.6258 ymin: 1.24715 xmax: 104.0036 ymax: 1.461526
z_range:       zmin: 0 zmax: 0
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Standardising CRS
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ironically, all of these data sets are from Singapore, yet, it presents with varied CRS.</p>
<p>Therefore, in this exercise, SVY21 (EPSG 3414) will be the standardised CRS as all data relates to local context.</p>
</div>
</div>
</section>
<section id="data-wrangling" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="data-wrangling"><span class="header-section-number">1.5</span> Data Wrangling</h2>
<section id="hdb-resale" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="hdb-resale"><span class="header-section-number">1.5.1</span> HDB Resale</h3>
<p>In tidying up the HDB resale data, the column <em>block</em> &amp; <em>street_name</em> are combined and <em>remaining_lease</em> are split in two columns for ease of manipulation. Additionally, we are changing the column <em>remaining_lease_yr</em> as an integer and splitting it to month and year.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>resale_tidy <span class="ot">&lt;-</span> resale2023 <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">address =</span> <span class="fu">paste</span>(block,street_name)) <span class="sc">%&gt;%</span> <span class="co">#combined block &amp; street name</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">remaining_lease_yr =</span> <span class="fu">as.integer</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_sub</span>(remaining_lease, <span class="dv">0</span>, <span class="dv">2</span>)))<span class="sc">%&gt;%</span> <span class="co">#extract remaining lease by yr</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">remaining_lease_mth =</span> <span class="fu">as.integer</span>(</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_sub</span>(remaining_lease, <span class="dv">9</span>, <span class="dv">11</span>))) <span class="co">#extract remaining lease by month</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>resale_selected <span class="ot">&lt;-</span> resale_tidy <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span> <span class="st">"2023-01"</span> <span class="sc">&amp;</span> month <span class="sc">&lt;=</span> <span class="st">"2024-09"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>add_list <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(resale_selected<span class="sc">$</span>address)) <span class="co">#parse a list as API cannot read df</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#unique reduces records to pass to portal</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#sort is used to easier to find geo codes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Fetching Data from onemap API</p>
<p>As the HDB resale data lack of coordinates, API was used to extract the coordinates.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>get_coords <span class="ot">&lt;-</span> <span class="cf">function</span>(add_list){</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame to store all retrieved coordinates</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  postal_coords <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> add_list){</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">'https://www.onemap.gov.sg/api/common/elastic/search?'</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">query=</span><span class="fu">list</span>(<span class="at">searchVal=</span>i,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">returnGeom=</span><span class="st">'Y'</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">getAddrDetails=</span><span class="st">'Y'</span>))</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="fu">rawToChar</span>(r<span class="sc">$</span>content))</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    found <span class="ot">&lt;-</span> data<span class="sc">$</span>found</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> data<span class="sc">$</span>results</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a new data frame for each address</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If single result, append </span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (found <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>      postal <span class="ot">&lt;-</span> res<span class="sc">$</span>POSTAL </span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>      lat <span class="ot">&lt;-</span> res<span class="sc">$</span>LATITUDE</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>      lng <span class="ot">&lt;-</span> res<span class="sc">$</span>LONGITUDE</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>      new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">address =</span> i, </span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">postal =</span> postal, </span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>                           <span class="at">latitude_wgs84 =</span> lat,  <span class="co"># renamed to clarify coordinate system</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>                           <span class="at">longitude_wgs84 =</span> lng) <span class="co"># renamed to clarify coordinate system</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If multiple results, drop NIL and append top 1</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (found <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Remove those with NIL as postal</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>      res_sub <span class="ot">&lt;-</span> res[res<span class="sc">$</span>POSTAL <span class="sc">!=</span> <span class="st">"NIL"</span>, ]</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Set as NA first if no Postal</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(res_sub) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>          new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">address =</span> i, </span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>                               <span class="at">postal =</span> <span class="cn">NA</span>, </span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>                               <span class="at">latitude_wgs84 =</span> <span class="cn">NA</span>, </span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>                               <span class="at">longitude_wgs84 =</span> <span class="cn">NA</span>)</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>{</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>        top1 <span class="ot">&lt;-</span> <span class="fu">head</span>(res_sub, <span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>        postal <span class="ot">&lt;-</span> top1<span class="sc">$</span>POSTAL </span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>        lat <span class="ot">&lt;-</span> top1<span class="sc">$</span>LATITUDE</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>        lng <span class="ot">&lt;-</span> top1<span class="sc">$</span>LONGITUDE</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>        new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">address =</span> i, </span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>                             <span class="at">postal =</span> postal, </span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>                             <span class="at">latitude_wgs84 =</span> lat, </span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>                             <span class="at">longitude_wgs84 =</span> lng)</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>      new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">address =</span> i, </span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>                           <span class="at">postal =</span> <span class="cn">NA</span>, </span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>                           <span class="at">latitude_wgs84 =</span> <span class="cn">NA</span>, </span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>                           <span class="at">longitude_wgs84 =</span> <span class="cn">NA</span>)</span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the row</span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>    postal_coords <span class="ot">&lt;-</span> <span class="fu">rbind</span>(postal_coords, new_row)</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to sf object with WGS84 coordinates (EPSG:4326)</span></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out rows with NA coordinates first</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>  valid_coords <span class="ot">&lt;-</span> postal_coords[<span class="sc">!</span><span class="fu">is.na</span>(postal_coords<span class="sc">$</span>latitude_wgs84) <span class="sc">&amp;</span> </span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">!</span><span class="fu">is.na</span>(postal_coords<span class="sc">$</span>longitude_wgs84), ]</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(valid_coords) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>    coords_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(valid_coords, </span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>                         <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude_wgs84"</span>, <span class="st">"latitude_wgs84"</span>),</span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>                         <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Transform to SVY21 (EPSG:3414)</span></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>    coords_svy21 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(coords_sf, <span class="dv">3414</span>)</span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract coordinates</span></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>    coords_matrix <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(coords_svy21)</span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add SVY21 coordinates back to the original dataframe with desired column names</span></span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>    valid_coords<span class="sc">$</span>longitude <span class="ot">&lt;-</span> coords_matrix[, <span class="dv">1</span>]  <span class="co"># SVY21 X coordinate as longitude</span></span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>    valid_coords<span class="sc">$</span>latitude <span class="ot">&lt;-</span> coords_matrix[, <span class="dv">2</span>]   <span class="co"># SVY21 Y coordinate as latitude</span></span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Merge back with rows that had NA coordinates</span></span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">merge</span>(postal_coords, valid_coords[<span class="fu">c</span>(<span class="st">"address"</span>, <span class="st">"longitude"</span>, <span class="st">"latitude"</span>)], </span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="st">"address"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If no valid coordinates, add empty SVY21 columns</span></span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> postal_coords</span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>    result<span class="sc">$</span>longitude <span class="ot">&lt;-</span> <span class="cn">NA</span>  <span class="co"># SVY21 coordinates</span></span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>    result<span class="sc">$</span>latitude <span class="ot">&lt;-</span> <span class="cn">NA</span>   <span class="co"># SVY21 coordinates</span></span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Below is the code chunk that populates the coordinates in longitude, latitude and postal code against the address in the <em>add_list</em>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">get_coords</span>(add_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The longtitude and latitude is then combined into geometry and the crs has been set to EPSG = 3414.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>coords_sf <span class="ot">&lt;-</span> coords <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">3414</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(address, postal, longitude, latitude, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Following which, the <em>coords_sf</em> is then combined to the <em>resale_selected</em> df by address, forming a new df <em>resale_geom</em></p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>resale_geom <span class="ot">&lt;-</span> resale_selected <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(coords_sf, <span class="at">by =</span> <span class="st">"address"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Assigning CRS EPSG 3414 to resale_geom</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>resale_geom <span class="ot">&lt;-</span> resale_geom <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span><span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">3414</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Using st_crs() to check if it is the correct CRS.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(resale_geom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
</div>
<p>In ensuring these are the variables we need, we use select() to include the variables. Then, we compute the unit age with the formula of 99 year (convention HDB lease years) - remaining lease year. Lastly, we change the column <em>month</em> to POSICxt so we can manipulate in ease later on.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>resale_geom <span class="ot">&lt;-</span> resale_geom <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(address, town, resale_price, month, flat_type, floor_area_sqm, remaining_lease_yr,longitude, latitude, geometry) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit_age =</span> <span class="dv">99</span> <span class="sc">-</span> remaining_lease_yr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="overview-of-data-sets-in-coordinate-reference-system" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="overview-of-data-sets-in-coordinate-reference-system"><span class="header-section-number">1.5.2</span> Overview of Data sets in Coordinate Reference System</h3>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">WGS 84</th>
<th style="text-align: center;">SVY21</th>
<th style="text-align: center;">No PCS / CSV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Hawker</td>
<td style="text-align: center;">Bus Stop</td>
<td style="text-align: center;">HDB Resale</td>
</tr>
<tr class="even">
<td style="text-align: center;">Kindergarten</td>
<td style="text-align: center;">Eldercare</td>
<td style="text-align: center;">Mall</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Park</td>
<td style="text-align: center;">MRT</td>
<td style="text-align: center;">School</td>
</tr>
<tr class="even">
<td style="text-align: center;">Supermarket</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Coordinate System</strong></p>
<p>Viewing the sf, we noticed that the coordinates are in WGS84 - EPSG 4326. This may not be suitable for our data manipulation later on as we are standardising it to our local coordinates system which is SVY 21 EPSG 3414.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Overview of Coordinate System</strong></p>
<p>WGS84 (EPSG: 4326) - Global Use</p>
<ol type="1">
<li><p><strong>Definition</strong>: WGS84 (World Geodetic System 1984) is a global coordinate system that defines latitude and longitude on a three-dimensional ellipsoid. It is the standard used by the Global Positioning System (GPS).</p></li>
<li><p><strong>Coordinate System</strong>: It uses a geographic coordinate system based on a spheroid, where coordinates are given in degrees (latitude and longitude).</p></li>
<li><p><strong>Application</strong>: WGS84 is used globally for mapping, navigation, and geolocation applications. It provides a standard reference for geographic information systems (GIS) and is essential for interoperability between different systems.</p></li>
<li><p><strong>Units</strong>: The coordinates are expressed in degrees.</p></li>
</ol>
<p>SVY21 (EPSG: 3413) - Singapore Use</p>
<ol type="1">
<li><p><strong>Definition</strong>: SVY21 (Singapore Vertical 21) is a national coordinate system specifically designed for Singapore. It is based on the Transverse Mercator projection and is tailored to provide accurate measurements within Singapore’s geographic boundaries.</p></li>
<li><p><strong>Coordinate System</strong>: SVY21 uses a projected coordinate system, where coordinates are given in meters. The system is more suitable for local applications because it minimizes distortions in a specific area.</p></li>
<li><p><strong>Application</strong>: SVY21 is primarily used for urban planning, construction, and various governmental applications within Singapore. It provides higher accuracy for local measurements compared to global systems like WGS84.</p></li>
<li><p><strong>Units</strong>: The coordinates are expressed in meters.</p></li>
</ol>
</div>
</div>
</section>
<section id="mpsz" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="mpsz"><span class="header-section-number">1.5.3</span> MPSZ</h3>
<p>First, we would like to check if there is any shared boudaries in this sf as this will churned as invalid polygons in the data. We will then noticed that there are several “Ring Self-Intersection” specifically, there are 9 polygons with self-intersection issues which is not good for the data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_is_valid</span>(mpsz, <span class="at">reason =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "Valid Geometry"                                           
  [2] "Valid Geometry"                                           
  [3] "Valid Geometry"                                           
  [4] "Valid Geometry"                                           
  [5] "Valid Geometry"                                           
  [6] "Valid Geometry"                                           
  [7] "Valid Geometry"                                           
  [8] "Valid Geometry"                                           
  [9] "Valid Geometry"                                           
 [10] "Valid Geometry"                                           
 [11] "Valid Geometry"                                           
 [12] "Valid Geometry"                                           
 [13] "Valid Geometry"                                           
 [14] "Valid Geometry"                                           
 [15] "Valid Geometry"                                           
 [16] "Valid Geometry"                                           
 [17] "Valid Geometry"                                           
 [18] "Valid Geometry"                                           
 [19] "Valid Geometry"                                           
 [20] "Valid Geometry"                                           
 [21] "Valid Geometry"                                           
 [22] "Valid Geometry"                                           
 [23] "Valid Geometry"                                           
 [24] "Valid Geometry"                                           
 [25] "Valid Geometry"                                           
 [26] "Valid Geometry"                                           
 [27] "Valid Geometry"                                           
 [28] "Valid Geometry"                                           
 [29] "Valid Geometry"                                           
 [30] "Valid Geometry"                                           
 [31] "Valid Geometry"                                           
 [32] "Valid Geometry"                                           
 [33] "Valid Geometry"                                           
 [34] "Valid Geometry"                                           
 [35] "Valid Geometry"                                           
 [36] "Valid Geometry"                                           
 [37] "Valid Geometry"                                           
 [38] "Ring Self-intersection[27932.3925999999 21982.7971999999]"
 [39] "Ring Self-intersection[26885.4439000003 26668.3121000007]"
 [40] "Valid Geometry"                                           
 [41] "Valid Geometry"                                           
 [42] "Valid Geometry"                                           
 [43] "Ring Self-intersection[26920.1689999998 26978.5440999996]"
 [44] "Valid Geometry"                                           
 [45] "Valid Geometry"                                           
 [46] "Valid Geometry"                                           
 [47] "Valid Geometry"                                           
 [48] "Valid Geometry"                                           
 [49] "Valid Geometry"                                           
 [50] "Valid Geometry"                                           
 [51] "Valid Geometry"                                           
 [52] "Valid Geometry"                                           
 [53] "Valid Geometry"                                           
 [54] "Valid Geometry"                                           
 [55] "Valid Geometry"                                           
 [56] "Valid Geometry"                                           
 [57] "Valid Geometry"                                           
 [58] "Valid Geometry"                                           
 [59] "Valid Geometry"                                           
 [60] "Valid Geometry"                                           
 [61] "Valid Geometry"                                           
 [62] "Valid Geometry"                                           
 [63] "Valid Geometry"                                           
 [64] "Valid Geometry"                                           
 [65] "Valid Geometry"                                           
 [66] "Valid Geometry"                                           
 [67] "Valid Geometry"                                           
 [68] "Valid Geometry"                                           
 [69] "Valid Geometry"                                           
 [70] "Valid Geometry"                                           
 [71] "Valid Geometry"                                           
 [72] "Valid Geometry"                                           
 [73] "Valid Geometry"                                           
 [74] "Valid Geometry"                                           
 [75] "Valid Geometry"                                           
 [76] "Valid Geometry"                                           
 [77] "Valid Geometry"                                           
 [78] "Valid Geometry"                                           
 [79] "Valid Geometry"                                           
 [80] "Valid Geometry"                                           
 [81] "Valid Geometry"                                           
 [82] "Valid Geometry"                                           
 [83] "Valid Geometry"                                           
 [84] "Valid Geometry"                                           
 [85] "Valid Geometry"                                           
 [86] "Valid Geometry"                                           
 [87] "Valid Geometry"                                           
 [88] "Valid Geometry"                                           
 [89] "Valid Geometry"                                           
 [90] "Valid Geometry"                                           
 [91] "Valid Geometry"                                           
 [92] "Valid Geometry"                                           
 [93] "Valid Geometry"                                           
 [94] "Valid Geometry"                                           
 [95] "Valid Geometry"                                           
 [96] "Valid Geometry"                                           
 [97] "Ring Self-intersection[14484.6859999998 31330.1319999993]"
 [98] "Ring Self-intersection[12861.3828999996 32207.4923]"      
 [99] "Valid Geometry"                                           
[100] "Valid Geometry"                                           
[101] "Valid Geometry"                                           
[102] "Valid Geometry"                                           
[103] "Ring Self-intersection[19681.2353999997 31294.4521999992]"
[104] "Valid Geometry"                                           
[105] "Valid Geometry"                                           
[106] "Valid Geometry"                                           
[107] "Valid Geometry"                                           
[108] "Valid Geometry"                                           
[109] "Valid Geometry"                                           
[110] "Valid Geometry"                                           
[111] "Valid Geometry"                                           
[112] "Valid Geometry"                                           
[113] "Valid Geometry"                                           
[114] "Valid Geometry"                                           
[115] "Valid Geometry"                                           
[116] "Valid Geometry"                                           
[117] "Valid Geometry"                                           
[118] "Valid Geometry"                                           
[119] "Valid Geometry"                                           
[120] "Valid Geometry"                                           
[121] "Valid Geometry"                                           
[122] "Valid Geometry"                                           
[123] "Valid Geometry"                                           
[124] "Valid Geometry"                                           
[125] "Valid Geometry"                                           
[126] "Valid Geometry"                                           
[127] "Valid Geometry"                                           
[128] "Valid Geometry"                                           
[129] "Valid Geometry"                                           
[130] "Valid Geometry"                                           
[131] "Valid Geometry"                                           
[132] "Valid Geometry"                                           
[133] "Valid Geometry"                                           
[134] "Valid Geometry"                                           
[135] "Valid Geometry"                                           
[136] "Valid Geometry"                                           
[137] "Valid Geometry"                                           
[138] "Valid Geometry"                                           
[139] "Valid Geometry"                                           
[140] "Valid Geometry"                                           
[141] "Valid Geometry"                                           
[142] "Valid Geometry"                                           
[143] "Valid Geometry"                                           
[144] "Valid Geometry"                                           
[145] "Valid Geometry"                                           
[146] "Valid Geometry"                                           
[147] "Valid Geometry"                                           
[148] "Valid Geometry"                                           
[149] "Valid Geometry"                                           
[150] "Valid Geometry"                                           
[151] "Valid Geometry"                                           
[152] "Valid Geometry"                                           
[153] "Valid Geometry"                                           
[154] "Valid Geometry"                                           
[155] "Valid Geometry"                                           
[156] "Valid Geometry"                                           
[157] "Valid Geometry"                                           
[158] "Valid Geometry"                                           
[159] "Valid Geometry"                                           
[160] "Valid Geometry"                                           
[161] "Valid Geometry"                                           
[162] "Valid Geometry"                                           
[163] "Valid Geometry"                                           
[164] "Valid Geometry"                                           
[165] "Valid Geometry"                                           
[166] "Valid Geometry"                                           
[167] "Valid Geometry"                                           
[168] "Valid Geometry"                                           
[169] "Valid Geometry"                                           
[170] "Valid Geometry"                                           
[171] "Valid Geometry"                                           
[172] "Valid Geometry"                                           
[173] "Valid Geometry"                                           
[174] "Valid Geometry"                                           
[175] "Valid Geometry"                                           
[176] "Valid Geometry"                                           
[177] "Valid Geometry"                                           
[178] "Valid Geometry"                                           
[179] "Valid Geometry"                                           
[180] "Valid Geometry"                                           
[181] "Valid Geometry"                                           
[182] "Valid Geometry"                                           
[183] "Valid Geometry"                                           
[184] "Valid Geometry"                                           
[185] "Valid Geometry"                                           
[186] "Valid Geometry"                                           
[187] "Valid Geometry"                                           
[188] "Valid Geometry"                                           
[189] "Valid Geometry"                                           
[190] "Valid Geometry"                                           
[191] "Valid Geometry"                                           
[192] "Valid Geometry"                                           
[193] "Valid Geometry"                                           
[194] "Valid Geometry"                                           
[195] "Valid Geometry"                                           
[196] "Valid Geometry"                                           
[197] "Valid Geometry"                                           
[198] "Valid Geometry"                                           
[199] "Valid Geometry"                                           
[200] "Valid Geometry"                                           
[201] "Valid Geometry"                                           
[202] "Valid Geometry"                                           
[203] "Valid Geometry"                                           
[204] "Valid Geometry"                                           
[205] "Valid Geometry"                                           
[206] "Valid Geometry"                                           
[207] "Valid Geometry"                                           
[208] "Valid Geometry"                                           
[209] "Valid Geometry"                                           
[210] "Valid Geometry"                                           
[211] "Valid Geometry"                                           
[212] "Valid Geometry"                                           
[213] "Valid Geometry"                                           
[214] "Valid Geometry"                                           
[215] "Valid Geometry"                                           
[216] "Valid Geometry"                                           
[217] "Valid Geometry"                                           
[218] "Valid Geometry"                                           
[219] "Valid Geometry"                                           
[220] "Valid Geometry"                                           
[221] "Valid Geometry"                                           
[222] "Valid Geometry"                                           
[223] "Valid Geometry"                                           
[224] "Valid Geometry"                                           
[225] "Valid Geometry"                                           
[226] "Valid Geometry"                                           
[227] "Valid Geometry"                                           
[228] "Valid Geometry"                                           
[229] "Valid Geometry"                                           
[230] "Valid Geometry"                                           
[231] "Valid Geometry"                                           
[232] "Valid Geometry"                                           
[233] "Valid Geometry"                                           
[234] "Valid Geometry"                                           
[235] "Valid Geometry"                                           
[236] "Valid Geometry"                                           
[237] "Valid Geometry"                                           
[238] "Valid Geometry"                                           
[239] "Valid Geometry"                                           
[240] "Valid Geometry"                                           
[241] "Valid Geometry"                                           
[242] "Valid Geometry"                                           
[243] "Valid Geometry"                                           
[244] "Valid Geometry"                                           
[245] "Valid Geometry"                                           
[246] "Valid Geometry"                                           
[247] "Valid Geometry"                                           
[248] "Valid Geometry"                                           
[249] "Valid Geometry"                                           
[250] "Valid Geometry"                                           
[251] "Valid Geometry"                                           
[252] "Valid Geometry"                                           
[253] "Valid Geometry"                                           
[254] "Valid Geometry"                                           
[255] "Valid Geometry"                                           
[256] "Valid Geometry"                                           
[257] "Valid Geometry"                                           
[258] "Valid Geometry"                                           
[259] "Valid Geometry"                                           
[260] "Valid Geometry"                                           
[261] "Valid Geometry"                                           
[262] "Valid Geometry"                                           
[263] "Valid Geometry"                                           
[264] "Valid Geometry"                                           
[265] "Valid Geometry"                                           
[266] "Valid Geometry"                                           
[267] "Valid Geometry"                                           
[268] "Valid Geometry"                                           
[269] "Valid Geometry"                                           
[270] "Valid Geometry"                                           
[271] "Valid Geometry"                                           
[272] "Valid Geometry"                                           
[273] "Valid Geometry"                                           
[274] "Valid Geometry"                                           
[275] "Valid Geometry"                                           
[276] "Ring Self-intersection[38542.2260999996 44605.4089000002]"
[277] "Valid Geometry"                                           
[278] "Valid Geometry"                                           
[279] "Valid Geometry"                                           
[280] "Valid Geometry"                                           
[281] "Valid Geometry"                                           
[282] "Valid Geometry"                                           
[283] "Valid Geometry"                                           
[284] "Valid Geometry"                                           
[285] "Valid Geometry"                                           
[286] "Valid Geometry"                                           
[287] "Valid Geometry"                                           
[288] "Valid Geometry"                                           
[289] "Valid Geometry"                                           
[290] "Ring Self-intersection[41375.108 40432.8588999994]"       
[291] "Valid Geometry"                                           
[292] "Valid Geometry"                                           
[293] "Valid Geometry"                                           
[294] "Valid Geometry"                                           
[295] "Valid Geometry"                                           
[296] "Valid Geometry"                                           
[297] "Valid Geometry"                                           
[298] "Valid Geometry"                                           
[299] "Valid Geometry"                                           
[300] "Valid Geometry"                                           
[301] "Valid Geometry"                                           
[302] "Valid Geometry"                                           
[303] "Valid Geometry"                                           
[304] "Valid Geometry"                                           
[305] "Valid Geometry"                                           
[306] "Valid Geometry"                                           
[307] "Valid Geometry"                                           
[308] "Valid Geometry"                                           
[309] "Valid Geometry"                                           
[310] "Valid Geometry"                                           
[311] "Valid Geometry"                                           
[312] "Valid Geometry"                                           
[313] "Valid Geometry"                                           
[314] "Valid Geometry"                                           
[315] "Valid Geometry"                                           
[316] "Valid Geometry"                                           
[317] "Valid Geometry"                                           
[318] "Valid Geometry"                                           
[319] "Valid Geometry"                                           
[320] "Valid Geometry"                                           
[321] "Valid Geometry"                                           
[322] "Ring Self-intersection[21702.5623000003 48125.1154999994]"
[323] "Valid Geometry"                                           </code></pre>
</div>
</div>
<p>The below code chunk visualises the invalid geometries.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>invalid_polygons <span class="ot">&lt;-</span> mpsz[<span class="sc">!</span><span class="fu">st_is_valid</span>(mpsz),]</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(invalid_polygons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TakeHome3_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In addressing the above point, we will use st_buffer() of sf package to compute a 5-metres buffers around the data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(mpsz, <span class="at">dist =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="bus-stops" class="level3" data-number="1.5.4">
<h3 data-number="1.5.4" class="anchored" data-anchor-id="bus-stops"><span class="header-section-number">1.5.4</span> Bus Stops</h3>
<p>In inspecting the sf, we noticed that when we sort the column “BUS_STOP_N”, there are two rows that retains the geometry however there are nil indication of the bus stop number and location. Hence both of the rows will be deleted.</p>
<p>Additionally, in checking for duplicates through its geometry, we noticed two rows share the geometry. One is named as “YUSEN LOGISTICS” while the other is “yusen logistics”</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for duplicate geometries in the eldercare sf object</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>duplicate_busstop <span class="ot">&lt;-</span> busstop[<span class="fu">duplicated</span>(busstop<span class="sc">$</span>geometry), ]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the duplicate geometries if any</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(duplicate_busstop) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(duplicate_busstop)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No duplicate geometries found."</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 42187.23 ymin: 34995.78 xmax: 42187.23 ymax: 34995.78
Projected CRS: SVY21
     BUS_STOP_N BUS_ROOF_N        LOC_DESC                  geometry
3195      96319        NIL YUSEN LOGISTICS POINT (42187.23 34995.78)</code></pre>
</div>
</div>
<p>Hence, with the above adjustments and extracting coordinates, the data is cleaned.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>busstop_cleaned <span class="ot">&lt;-</span> busstop <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(LOC_DESC <span class="sc">!=</span> <span class="st">"YUSEN LOGISTICS"</span>)  <span class="co"># Delete the specified row</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coordinates after filtering</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>coordinates <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(busstop_cleaned)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add longitude and latitude columns</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>busstop_cleaned <span class="ot">&lt;-</span> busstop_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude =</span> coordinates[, <span class="dv">1</span>],    <span class="co"># First column is longitude</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude =</span> coordinates[, <span class="dv">2</span>]) <span class="sc">%&gt;%</span>  </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(LOC_DESC, longitude, latitude, geometry) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(busstop_cleaned) <span class="ot">&lt;-</span> <span class="dv">3414</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="eldercare" class="level3" data-number="1.5.5">
<h3 data-number="1.5.5" class="anchored" data-anchor-id="eldercare"><span class="header-section-number">1.5.5</span> Eldercare</h3>
<p>In ensuring there are no duplicates the below code chunk was churned. However,we noticed that there is two rows that shares the same geometry. Through closer inspection, we realised that both addresses are formatted differently “117 Bukit Merah View” &amp; “Blk 117 Bukit Merah View #01-205”. Thus, one of the row will be deleted.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for duplicate geometries in the eldercare sf object</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>duplicate_geometries <span class="ot">&lt;-</span> eldercare[<span class="fu">duplicated</span>(eldercare<span class="sc">$</span>geometry), ]</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the duplicate geometries if any</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(duplicate_geometries) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(duplicate_geometries)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No duplicate geometries found."</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 13 features and 18 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 23147.94 ymin: 29642.15 xmax: 41665.14 ymax: 45761.17
Projected CRS: SVY21
First 10 features:
    OBJECTID ADDRESSBLO ADDRESSBUI ADDRESSPOS
51        51       &lt;NA&gt;       &lt;NA&gt;     190005
59        59       &lt;NA&gt;       &lt;NA&gt;     190008
62        62       &lt;NA&gt;       &lt;NA&gt;     731569
65        65       &lt;NA&gt;       &lt;NA&gt;     540182
66        66       &lt;NA&gt;       &lt;NA&gt;     523499
70        70       &lt;NA&gt;       &lt;NA&gt;     151117
97        97       &lt;NA&gt;       &lt;NA&gt;     560123
102      102       &lt;NA&gt;       &lt;NA&gt;     312062
106      106       &lt;NA&gt;       &lt;NA&gt;     560469
114      114       &lt;NA&gt;       &lt;NA&gt;     151117
                              ADDRESSSTR ADDRESSTYP DESCRIPTIO HYPERLINK
51                   5 Beach Rd #02-4915       &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
59                 Blk 8 North Bridge Rd       &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
62                Blk 569A Champions Way       &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
65            Blk 182 Rivervale Crescent       &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
66               Blk 499C Tampines Ave 9       &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
70                  117 Bukit Merah View       &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
97  Blk 123 Ang Mo Kio Avenue 6 #01-4011       &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
102       62B Lorong 4 Toa Payoh #02-121       &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
106 Blk 469 Ang Mo Kio Avenue 10 #01-940       &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
114     Blk 117 Bukit Merah View #01-205       &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
    LANDXADDRE LANDYADDRE                                                NAME
51           0          0                      Peace-Connect Cluster Operator
59           0          0                   PEACE-Connect Senior Group Home@8
62           0          0                            Care Corner SGH @ WL569A
65           0          0       COMNET Senior Group Home @ Rivervale Crescent
66           0          0 Lions Befrienders Senior Group Home @ Tampines 499C
70           0          0           NTUC Health Senior Group Home @ Henderson
97           0          0                         AWWA Senior Activity Centre
102          0          0          Care Corner Senior Activity Centre (TP62B)
106          0          0   Teck Ghee Senior Activity Centre Branch @ Blk 469
114          0          0                    Henderson Senior Activity Centre
    PHOTOURL ADDRESSFLO          INC_CRC FMEL_UPD_D ADDRESSUNI   X_ADDR
51      &lt;NA&gt;       &lt;NA&gt; A2C058FC1751FFE7 2016-07-28       &lt;NA&gt; 31505.35
59      &lt;NA&gt;       &lt;NA&gt; D1A1515DCC76C221 2016-07-28       &lt;NA&gt; 31415.01
62      &lt;NA&gt;       &lt;NA&gt; 4DC6800EF15E4B70 2016-07-28       &lt;NA&gt; 23147.94
65      &lt;NA&gt;       &lt;NA&gt; 6BB0D76986F8C512 2016-07-28       &lt;NA&gt; 36446.37
66      &lt;NA&gt;       &lt;NA&gt; 5DB6B9F0F16BCA80 2016-07-28       &lt;NA&gt; 41665.14
70      &lt;NA&gt;       &lt;NA&gt; 7FF38742987329FE 2016-07-28       &lt;NA&gt; 26715.04
97      &lt;NA&gt;       &lt;NA&gt; B275FB9D13DD7091 2016-07-28       &lt;NA&gt; 29261.31
102     &lt;NA&gt;       &lt;NA&gt; 13908BA85D11F6DC 2016-07-28       &lt;NA&gt; 29998.73
106     &lt;NA&gt;       &lt;NA&gt; 8F9B74A5A73579D9 2016-07-28       &lt;NA&gt; 30594.50
114     &lt;NA&gt;       &lt;NA&gt; 7FF387421A0883F4 2016-07-28       &lt;NA&gt; 26715.04
      Y_ADDR                  geometry
51  31853.52 POINT (31505.35 31853.52)
59  31880.06 POINT (31415.01 31880.06)
62  45761.17 POINT (23147.94 45761.17)
65  41376.90  POINT (36446.37 41376.9)
66  37956.92 POINT (41665.14 37956.92)
70  29642.15 POINT (26715.04 29642.15)
97  39169.61 POINT (29261.31 39169.61)
102 35335.92 POINT (29998.73 35335.92)
106 38507.25  POINT (30594.5 38507.25)
114 29642.15 POINT (26715.04 29642.15)</code></pre>
</div>
</div>
<p>The code below selects the necessary variables of ease of manipulation</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>eldercare_cleaned <span class="ot">&lt;-</span> eldercare <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(INC_CRC <span class="sc">!=</span> <span class="st">"7FF38742987329FE"</span>) <span class="sc">%&gt;%</span>  <span class="co">#deletes the duplicated row</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">longitude =</span> X_ADDR) <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">latitude =</span> Y_ADDR) <span class="sc">%&gt;%</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(NAME, longitude, latitude, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(eldercare_cleaned) <span class="ot">&lt;-</span> <span class="dv">3414</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="hawker" class="level3" data-number="1.5.6">
<h3 data-number="1.5.6" class="anchored" data-anchor-id="hawker"><span class="header-section-number">1.5.6</span> Hawker</h3>
<p>The code chunk below checks if there are any duplicates geometries and it returns nil.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>duplicate_geometries <span class="ot">&lt;-</span> hawker[<span class="fu">duplicated</span>(<span class="fu">st_geometry</span>(hawker)), ]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Display duplicate geometries if any</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(duplicate_geometries) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(duplicate_geometries)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No duplicate geometries found."</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "No duplicate geometries found."</code></pre>
</div>
</div>
<p>As the CRS of hawker sf is in WGS84, st_transform() is then used to transform it to SVY21.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>hawker <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(hawker, <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The data is then split into longitude and latitude and selected columns were chosen.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>coordinates <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(hawker)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>hawker_cleaned <span class="ot">&lt;-</span> hawker <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude =</span> coordinates[, <span class="dv">1</span>],    <span class="co"># First column is longitude</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude =</span> coordinates[, <span class="dv">2</span>]) <span class="sc">%&gt;%</span>  </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(longitude, latitude, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="kindergarten" class="level3" data-number="1.5.7">
<h3 data-number="1.5.7" class="anchored" data-anchor-id="kindergarten"><span class="header-section-number">1.5.7</span> Kindergarten</h3>
<p>The code chunk below checks if there are any duplicates geometries and it returns nil.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>duplicate_kindergarten <span class="ot">&lt;-</span> kindergarten[<span class="fu">duplicated</span>(<span class="fu">st_geometry</span>(kindergarten)), ]</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Display duplicate geometries if any</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(duplicate_kindergarten) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(duplicate_kindergarten)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No duplicate geometries found."</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 66 features and 2 fields
Geometry type: POINT
Dimension:     XYZ
Bounding box:  xmin: 12882.62 ymin: 25596.33 xmax: 41916.49 ymax: 48384.34
z_range:       zmin: 0 zmax: 0
Projected CRS: SVY21 / Singapore TM
First 10 features:
       Name
271 kml_271
284 kml_284
288 kml_288
291 kml_291
349 kml_349
354 kml_354
355 kml_355
356 kml_356
358 kml_358
360 kml_360
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Description
271                                     &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;423731&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;252 Tembeling Road  #02-07 S(423731)&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;Kindergartens&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;Seeds D' Learning House&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;30BE9FB7740C8654&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201143423&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;
284                                 &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;287994&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;200 Turf Club Road   S(287994)&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;Kindergartens&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;Swallows And Amazons Kindergarten&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;AC4EDF1099057112&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201143423&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;
288 &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;287994&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;200, TURF CLUB ROAD, #06-08,THE GRANDSTAND, (S)287994&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;Kindergartens&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;The Little House (Montessori) Kindergarten&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;AC4EDF101AAB7C05&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201143423&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;
291                              &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;760102&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;102 Yishun Avenue 5  #03-115 S(760102)&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;Kindergartens&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;Tots Town Preschool @ Yishun&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;0CEB47AFBABB448C&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201143423&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;
349                                          &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;579792&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;4 Bishan Street 13   S(579792)&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;Kindergartens&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;Zion Bishan Kindergarten&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;2809ADC0B5232EF6&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201143423&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;
354                                      &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;519420&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;4 Pasir Ris Drive 6&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;Kindergartens&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;Pentecost Methodist Church Kindergarten&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;8C80D608E5D43802&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201143423&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;
355                                                           &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;299574&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;1 Dunearn Close&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;Kindergartens&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;Pibos Garden Preschool&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;7F8CBC68533FFB92&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201143423&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;
356                                                  &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;423731&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;252 Tembeling Road #01-07&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;Kindergartens&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;Pink Tower Montessori&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;30BE9FB7FCB667DE&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201143423&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;
358                                                 &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;522497&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;497C Tampines Street 45 #01-54&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;Kindergartens&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;Prodigy Preschool&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;724ECBCAF5159E3E&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201143423&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;
360                                               &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;730408&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;408 Woodlands Street 41&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;Kindergartens&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;Putra - Putri Kindergarten&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;BA7D15B0567CD551&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201143423&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;
                         geometry
271  POINT Z (36012.9 32087.99 0)
284 POINT Z (23527.86 35684.78 0)
288 POINT Z (23527.86 35684.78 0)
291 POINT Z (27493.03 45816.02 0)
349 POINT Z (30399.37 36579.97 0)
354 POINT Z (41780.92 39252.46 0)
355 POINT Z (25915.86 33987.34 0)
356  POINT Z (36012.9 32087.99 0)
358 POINT Z (41916.49 37814.51 0)
360 POINT Z (21217.24 45620.86 0)</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>kindergarten <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(kindergarten, <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The data is then split into longitude and latitude and selected columns were chosen.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>coordinates <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(kindergarten)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>kindergarten_cleaned <span class="ot">&lt;-</span> kindergarten <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude =</span> coordinates[, <span class="dv">1</span>],    <span class="co"># First column is longitude</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude =</span> coordinates[, <span class="dv">2</span>]) <span class="sc">%&gt;%</span>  </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(longitude, latitude, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="school" class="level3" data-number="1.5.8">
<h3 data-number="1.5.8" class="anchored" data-anchor-id="school"><span class="header-section-number">1.5.8</span> School</h3>
<p>Despite importing the data and ensuring that postal code is in character form, there are still incomplete postal code as seen in the below code.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(school<span class="sc">$</span>postal_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
  [1] "738907" "737916" "768643" "768928" "579646" "159016" "544969" "569785"
  [9] "569206" "569843" "569920" "569362" "487012" "139745" "309919" "139650"
 [17] "227988" "309918" "529366" "678117" "679697" "538403" "679944" "318990"
 [25] "469317" "469722" "468585" "469293" "339948" "327919" "109100" "649930"
 [33] "648354" "547529" "399935" "658962" "159050" "689809" "679676" "598112"
 [41] "659634" "659633" "757714" "757699" "387621" "88256"  "518935" "579767"
 [49] "297822" "349692" "349700" "529894" "529896" "424821" "99757"  "449150"
 [57] "659401" "558979" "534793" "679287" "319765" "319764" "548595" "569405"
 [65] "99138"  "768959" "529392" "737924" "689905" "688845" "439012" "768547"
 [73] "129903" "129904" "608784" "545083" "689814" "648347" "247961" "609561"
 [81] "479226" "479229" "659441" "689285" "569277" "659204" "436895" "529093"
 [89] "529258" "529231" "828869" "828814" "518866" "757521" "573838" "738908"
 [97] "738489" "139648" "139649" "217567" "469680" "797538" "797701" "319252"
[105] "648200" "739063" "739062" "609647" "649410" "158901" "159561" "389706"
[113] "389705" "529176" "828848" "828866" "677744" "679938" "737942" "579807"
[121] "519421" "427072" "278790" "659250" "534786" "536451" "327829" "828819"
[129] "534238" "534256" "649371" "768857" "269734" "737888" "768515" "569228"
[137] "528906" "528933" "688258" "609476" "618652" "648368" "648348" "609790"
[145] "649038" "659762" "127368" "319580" "399772" "689189" "689333" "579793"
[153] "579795" "618310" "659243" "519073" "408931" "408940" "368051" "738927"
[161] "739110" "297754" "569948" "569384" "828867" "518798" "518901" "599986"
[169] "599986" "658965" "538786" "538785" "545079" "545080" "129956" "128806"
[177] "288683" "556111" "268097" "288913" "769028" "768689" "148812" "139657"
[185] "449149" "529283" "545088" "768960" "544974" "545081" "768692" "769026"
[193] "768578" "327830" "757622" "828671" "129957" "828716" "458436" "768454"
[201] "168622" "544822" "519524" "518934" "518968" "529400" "536741" "536742"
[209] "319320" "597610" "797702" "129857" "556094" "575566" "768687" "649076"
[217] "529067" "569845" "659163" "828674" "828772" "538787" "828870" "828845"
[225] "128104" "738525" "149303" "148800" "149295" "99840"  "289072" "318871"
[233] "575954" "469719" "689621" "649961" "237993" "737803" "738524" "545092"
[241] "555855" "649295" "138572" "227968" "757715" "757704" "545166" "545090"
[249] "797636" "555889" "534237" "649332" "739067" "309437" "309437" "737913"
[257] "689762" "737758" "544799" "529593" "357691" "359337" "359342" "469701"
[265] "469700" "556742" "556140" "529706" "528986" "308274" "309331" "387724"
[273] "259240" "429058" "455789" "659322" "518799" "529565" "529426" "529427"
[281] "439272" "437259" "438796" "449761" "569299" "688261" "479239" "469278"
[289] "469300" "465561" "569730" "688268" "689143" "828728" "449035" "448880"
[297] "828802" "757702" "649223" "679946" "677737" "677742" "649188" "648350"
[305] "519075" "579747" "738079" "738990" "738853" "738240" "738239" "739111"
[313] "538882" "649036" "538784" "538789" "768611" "556108" "689100" "538720"
[321] "569868" "768675" "768679" "768516" "768610" "469623" "618654" "609558"
[329] "649406" "529393" "658712" "538884" "169485" "679002" "677741" "556095"
[337] "556123"</code></pre>
</div>
</div>
<p>The below code chunk churned out 3 incomplete postal codes.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display postal codes that are not 6 digits</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>invalid_postal_codes <span class="ot">&lt;-</span> school <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">nchar</span>(<span class="fu">as.character</span>(postal_code)) <span class="sc">!=</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(address, postal_code)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the result</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(invalid_postal_codes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  address                  postal_code
  &lt;chr&gt;                    &lt;chr&gt;      
1 1    Cantonment Close    88256      
2 1    Bukit Teresa Road   99757      
3 160  LOWER DELTA ROAD    99138      
4 1    BUKIT PURMEI AVENUE 99840      </code></pre>
</div>
</div>
<p>The correct postal code has been changed with the assistance of Google Maps and it piped back to the main df school.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>school <span class="ot">&lt;-</span> school <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">postal_code =</span> <span class="fu">ifelse</span>(postal_code <span class="sc">==</span> <span class="st">"88256"</span>, <span class="st">"088256"</span>, postal_code)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">postal_code =</span> <span class="fu">ifelse</span>(postal_code <span class="sc">==</span> <span class="st">"99757"</span>, <span class="st">"099757"</span>, postal_code)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">postal_code =</span> <span class="fu">ifelse</span>(postal_code <span class="sc">==</span> <span class="st">"99840"</span>, <span class="st">"099840"</span>, postal_code))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>school <span class="ot">&lt;-</span> school <span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(school_name, address, postal_code, mainlevel_code) <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mainlevel_code <span class="sc">==</span><span class="st">"PRIMARY"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>postal_list <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(school<span class="sc">$</span>postal_code)) <span class="co">#parse a list as API cannot read df</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co">#unique reduces records to pass to portal</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">#sort is used to easier to find geo codes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Fetching Data from onemap API</p>
<p>As the primary schools lack of geometry coordinates, API was used to extract the coordinates.</p>
<p>This will return WGS84 xy coordinates alongside SVY21 xy coordinates.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>get_coords <span class="ot">&lt;-</span> <span class="cf">function</span>(postal_list){</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame to store all retrieved coordinates</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  postal_coords <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (postal <span class="cf">in</span> postal_list){</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">'https://www.onemap.gov.sg/api/common/elastic/search?'</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">query=</span><span class="fu">list</span>(<span class="at">searchVal=</span>postal,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">returnGeom=</span><span class="st">'Y'</span>,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">getAddrDetails=</span><span class="st">'Y'</span>))</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="fu">rawToChar</span>(r<span class="sc">$</span>content))</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    found <span class="ot">&lt;-</span> data<span class="sc">$</span>found</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> data<span class="sc">$</span>results</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a new data frame for each postal code</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If single result, append </span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (found <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>      postal_code <span class="ot">&lt;-</span> res<span class="sc">$</span>POSTAL </span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>      lat <span class="ot">&lt;-</span> res<span class="sc">$</span>LATITUDE</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>      lng <span class="ot">&lt;-</span> res<span class="sc">$</span>LONGITUDE</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>      new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">postal_code =</span> postal, </span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">postal_found =</span> postal_code, </span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">latitude_wgs84 =</span> lat,</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>                           <span class="at">longitude_wgs84 =</span> lng)</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If multiple results, use the exact postal code match</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (found <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Find exact match for postal code</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>      res_match <span class="ot">&lt;-</span> res[res<span class="sc">$</span>POSTAL <span class="sc">==</span> postal, ]</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>      <span class="co"># If exact match found, use it</span></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(res_match) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>        postal_code <span class="ot">&lt;-</span> res_match<span class="sc">$</span>POSTAL[<span class="dv">1</span>]</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>        lat <span class="ot">&lt;-</span> res_match<span class="sc">$</span>LATITUDE[<span class="dv">1</span>]</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>        lng <span class="ot">&lt;-</span> res_match<span class="sc">$</span>LONGITUDE[<span class="dv">1</span>]</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>        new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">postal_code =</span> postal,</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>                             <span class="at">postal_found =</span> postal_code,</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>                             <span class="at">latitude_wgs84 =</span> lat,</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>                             <span class="at">longitude_wgs84 =</span> lng)</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>      <span class="co"># If no exact match, set as NA</span></span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> {</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>        new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">postal_code =</span> postal,</span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>                             <span class="at">postal_found =</span> <span class="cn">NA</span>,</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>                             <span class="at">latitude_wgs84 =</span> <span class="cn">NA</span>,</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>                             <span class="at">longitude_wgs84 =</span> <span class="cn">NA</span>)</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If no results found</span></span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>      new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">postal_code =</span> postal,</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>                           <span class="at">postal_found =</span> <span class="cn">NA</span>,</span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>                           <span class="at">latitude_wgs84 =</span> <span class="cn">NA</span>,</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>                           <span class="at">longitude_wgs84 =</span> <span class="cn">NA</span>)</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the row</span></span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>    postal_coords <span class="ot">&lt;-</span> <span class="fu">rbind</span>(postal_coords, new_row)</span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to sf object with WGS84 coordinates (EPSG:4326)</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out rows with NA coordinates first</span></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>  valid_coords <span class="ot">&lt;-</span> postal_coords[<span class="sc">!</span><span class="fu">is.na</span>(postal_coords<span class="sc">$</span>latitude_wgs84) <span class="sc">&amp;</span> </span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">!</span><span class="fu">is.na</span>(postal_coords<span class="sc">$</span>longitude_wgs84), ]</span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(valid_coords) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>    coords_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(valid_coords, </span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>                         <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude_wgs84"</span>, <span class="st">"latitude_wgs84"</span>),</span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a>                         <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Transform to SVY21 (EPSG:3414)</span></span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>    coords_svy21 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(coords_sf, <span class="dv">3414</span>)</span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract coordinates</span></span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a>    coords_matrix <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(coords_svy21)</span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add SVY21 coordinates back to the original dataframe</span></span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a>    valid_coords<span class="sc">$</span>longitude <span class="ot">&lt;-</span> coords_matrix[, <span class="dv">1</span>]  <span class="co"># SVY21 X coordinate</span></span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a>    valid_coords<span class="sc">$</span>latitude <span class="ot">&lt;-</span> coords_matrix[, <span class="dv">2</span>]   <span class="co"># SVY21 Y coordinate</span></span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add geometry column</span></span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a>    valid_coords<span class="sc">$</span>geometry <span class="ot">&lt;-</span> <span class="fu">st_geometry</span>(coords_svy21)</span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-86"><a href="#cb63-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Merge back with rows that had NA coordinates</span></span>
<span id="cb63-87"><a href="#cb63-87" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">merge</span>(postal_coords, </span>
<span id="cb63-88"><a href="#cb63-88" aria-hidden="true" tabindex="-1"></a>                   valid_coords[<span class="fu">c</span>(<span class="st">"postal_code"</span>, <span class="st">"longitude"</span>, <span class="st">"latitude"</span>, <span class="st">"geometry"</span>)], </span>
<span id="cb63-89"><a href="#cb63-89" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="st">"postal_code"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-90"><a href="#cb63-90" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb63-91"><a href="#cb63-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If no valid coordinates, add empty SVY21 columns</span></span>
<span id="cb63-92"><a href="#cb63-92" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> postal_coords</span>
<span id="cb63-93"><a href="#cb63-93" aria-hidden="true" tabindex="-1"></a>    result<span class="sc">$</span>longitude <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb63-94"><a href="#cb63-94" aria-hidden="true" tabindex="-1"></a>    result<span class="sc">$</span>latitude <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb63-95"><a href="#cb63-95" aria-hidden="true" tabindex="-1"></a>    result<span class="sc">$</span>geometry <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb63-96"><a href="#cb63-96" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-97"><a href="#cb63-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-98"><a href="#cb63-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb63-99"><a href="#cb63-99" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-100"><a href="#cb63-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-101"><a href="#cb63-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage example:</span></span>
<span id="cb63-102"><a href="#cb63-102" aria-hidden="true" tabindex="-1"></a>add_list_school <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(school<span class="sc">$</span>postal_code))</span>
<span id="cb63-103"><a href="#cb63-103" aria-hidden="true" tabindex="-1"></a>coords_school <span class="ot">&lt;-</span> <span class="fu">get_coords</span>(add_list_school)</span>
<span id="cb63-104"><a href="#cb63-104" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(coords_school))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  postal_code postal_found   latitude_wgs84  longitude_wgs84 longitude latitude
1      088256       088256 1.27547252623201 103.839962631748  28739.43 28660.79
2      099757       099757   1.275022722964 103.828157564896  27425.62 28611.06
3      099840       099840 1.27489701529771 103.824115781658  26975.80 28597.16
4      109100       109100 1.27612047924037 103.808628535239  25252.19 28732.45
5      128104       128104  1.3132658326807 103.756629101811  19465.19 32839.91
6      128806       128806 1.31920159956387 103.761095065761  19962.23 33496.24
                   geometry
1 POINT (28739.43 28660.79)
2 POINT (27425.62 28611.06)
3  POINT (26975.8 28597.16)
4 POINT (25252.19 28732.45)
5 POINT (19465.19 32839.91)
6 POINT (19962.23 33496.24)</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Convert result to sf object for spatial operations</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>coords_school_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(coords_school[<span class="sc">!</span><span class="fu">is.na</span>(coords_school<span class="sc">$</span>geometry), ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Below is the code chunk that populates the coordinates in longitude, latitude and postal code against the address in the <em>add_list</em>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>coords_school <span class="ot">&lt;-</span> <span class="fu">get_coords</span>(postal_list)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coords_school)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    postal_code postal_found   latitude_wgs84  longitude_wgs84 longitude
1        088256       088256 1.27547252623201 103.839962631748  28739.43
2        099757       099757   1.275022722964 103.828157564896  27425.62
3        099840       099840 1.27489701529771 103.824115781658  26975.80
4        109100       109100 1.27612047924037 103.808628535239  25252.19
5        128104       128104  1.3132658326807 103.756629101811  19465.19
6        128806       128806 1.31920159956387 103.761095065761  19962.23
7        129857       129857 1.31666529308968 103.767438999533  20668.24
8        129903       129903 1.31506321827875 103.763144493687  20190.30
9        139648       139648 1.30100441916733 103.785455606827  22673.28
10       148812       148812 1.29981138884057 103.799964819895  24288.03
11       149303       149303 1.29552905587752 103.807648475656  25143.14
12       158901       158901 1.28559516494962 103.815547410064  26022.22
13       159016       159016 1.29133439161334 103.824424680531  27010.19
14       169485       169485 1.28421153855474 103.825951884637  27180.15
15       217567       217567 1.31236867681371 103.850766402965  29941.78
16       227988       227988 1.30935041274966 103.840950265464  28849.34
17       237993       237993 1.29418347842837 103.836018941571  28300.53
18       268097       268097 1.32107094241153 103.807681852799  25146.89
19       278790       278790 1.31667646178347 103.784296227747  22544.29
20       289072       289072 1.33004178068277 103.806397828938  25004.00
21       297754       297754 1.34043840661368 103.839811736775  28722.62
22       309331       309331 1.31781476118551 103.845633334522  29370.51
23       309437       309437  1.3206340835184 103.828164966953  27426.45
24       309918       309918 1.31837054523521 103.835609732354  28254.98
25       319252       319252 1.34032299499938 103.855529906182  30471.88
26       319320       319320 1.33677864390672 103.855341310212  30450.90
27       319580       319580  1.3373381935639 103.847148501824  29539.12
28       319765       319765 1.33275264711587 103.841847263786  28949.15
29       327829       327829 1.32175999964553 103.857628468881  30705.45
30       339948       339948 1.32181250780475 103.865404167629  31570.81
31       349700       349700 1.33566084356265  103.87562006259  32707.71
32       359337       359337 1.33140255308868 103.865117134385  31538.85
33       387621       387621 1.32664424544839 103.882227964852  33443.12
34       387724       387724 1.32439150290682 103.881624837373  33376.00
35       389706       389706 1.31814416827374 103.883628501601  33599.00
36       399772       399772 1.31099674009193 103.888352029067  34124.70
37       408931       408931 1.32858023873554 103.901306904157  35566.41
38       424821       424821 1.30648535277087 103.911105620496  36656.98
39       427072       427072 1.31194344271383 103.902902557195  35744.04
40       437259       437259 1.30498489044822 103.899999965407  35421.03
41       449149       449149 1.30553224180437 103.917570005713  37376.41
42       449761       449761 1.30528528687321 103.911553152326  36706.79
43       455789       455789 1.31878997295135 103.917258129598  37341.65
44       458436       458436 1.31996876377748 103.923752668632  38064.43
45       469300       469300 1.31720341663064  103.94575943784  40513.58
46       469317       469317 1.32344593287992 103.937878976352  39636.53
47       469623       469623 1.33398037894072 103.932015036296  38983.89
48       469680       469680 1.32980598760785 103.931710293058  38949.99
49       469701       469701  1.3347253730189 103.941234868202  40009.96
50       469719       469719 1.33405659580859 103.934317528484  39240.13
51       479226       479226 1.33524602829747 103.921286435321  37789.90
52       479239       479239 1.33109611001931 103.911005345855  36645.74
53       518798       518798 1.37550677054835 103.934953276155  39310.69
54       518866       518866 1.37505696315817 103.945289416873  40460.98
55       518935       518935 1.37246063927999 103.957020286115  41766.50
56       518968       518968 1.37245132722087 103.962922699031  42423.37
57       519075       519075 1.36563610941695 103.960861814678  42194.05
58       519524       519524 1.37801687647812   103.9392021807  39783.53
59       528906       528906 1.34787074766746 103.939221709073  39785.85
60       529067       529067 1.35765121877679 103.935246486174  39343.40
61       529176       529176 1.35711606790292 103.949144797277  40890.13
62       529258       529258 1.35268400746357 103.961676849165  42284.83
63       529366       529366 1.34828400809545 103.951482746538  41150.37
64       529392       529392 1.35061130568554 103.951317297552  41131.94
65       529393       529393 1.35131569890862 103.950551091373  41046.67
66       529426       529426  1.3504863946694 103.943573098509  40270.10
67       529565       529565 1.36048786025607 103.948768900518  40848.28
68       529706       529706 1.34967978969837 103.937016363397  39540.41
69       529896       529896 1.34023163951633 103.952080114035  41216.89
70       534238       534238 1.37738245231461 103.880805274557  33284.68
71       534793       534793 1.37330297140128 103.897575728303  35151.03
72       536451       536451 1.36693830877349 103.894114899795  34765.90
73       536741       536741  1.3502545600894 103.884846876112  33734.52
74       538720       538720 1.37793264345276 103.885643682171  33823.13
75       538784       538784 1.37176798317468  103.88280991785  33507.78
76       538786       538786 1.37362445234082 103.889741457901  34279.17
77       538787       538787 1.37820062547641 103.894667159512  34827.33
78       538882       538882 1.35799653782463 103.890216355459  34332.07
79       544799       544799 1.39528544463377 103.889416413501  34242.94
80       544822       544822 1.38376923022123 103.891354675017  34458.68
81       544969       544969 1.39036998654612 103.887165375933  33992.45
82       544974       544974 1.38255066171151  103.89626457548  35005.09
83       545080       545080 1.39221149906592 103.891180928186  34439.32
84       545088       545088 1.38706146494859 103.903202683028  35777.20
85       545092       545092 1.39333506298213 103.904545253288  35926.59
86       545166       545166 1.38925044778224 103.899527879229  35368.24
87       555855       555855  1.3728583654058  103.87477170399  32613.23
88       556095       556095 1.36026072476019 103.869712517383  32050.22
89       556108       556108  1.3489768083841 103.868467129954  31911.64
90       556742       556742 1.34930766795555 103.862309899986  31226.41
91       558979       558979 1.35742952269615 103.864009397373  31415.53
92       569228       569228 1.37196445720109 103.851763531681  30052.70
93       569299       569299 1.36565018546903 103.851009800453  29968.82
94       569730       569730 1.35994649477568 103.853768994775  30275.89
95       569785       569785 1.38419941907925 103.841411716006  28900.66
96       569920       569920 1.36932176584608 103.839630858752  28702.48
97       569948       569948 1.37614621670476 103.835805246743  28276.74
98       579646       579646  1.3605834338904 103.833020333986  27966.81
99       579793       579793 1.34939813669536 103.855018233311  30414.93
100      597610       597610 1.33807302121151 103.776250903095  21648.98
101      598112       598112  1.3377498622588 103.766855344779  20603.35
102      599986       599986 1.33266213599636 103.783382114018  22442.59
103      609476       609476 1.34843859698946 103.733156566858  16853.08
104      609558       609558 1.34291981622016 103.740861148879  17710.49
105      609647       609647 1.33659726465816 103.736089481883  17179.43
106      618310       618310 1.33820397704287 103.718089546664  15176.23
107      648200       648200 1.33641298743234  103.69970173931  13129.85
108      648347       648347 1.35148548772662 103.707578404944  14006.52
109      648368       648368 1.33917519796104 103.698803732244  13029.92
110      649036       649036 1.34270639669225 103.687588478681  11781.81
111      649076       649076 1.34883617453427 103.695003812477  12607.09
112      649188       649188  1.3477109654722 103.700467520791  13215.14
113      649223       649223 1.34471211768915 103.698964212988  13047.82
114      649295       649295 1.34673868889096 103.718457955487  15217.27
115      649332       649332 1.34686967259067 103.721559387203  15562.43
116      649930       649930 1.34284013791617 103.712858381937  14594.08
117      659163       659163 1.34919098857585 103.740719208011  17694.72
118      659243       659243 1.35424191127295 103.754165828711  19191.20
119      659401       659401 1.36411948475833 103.749251919049  18644.37
120      659441       659441  1.3591797447277  103.74847210784  18557.57
121      659634       659634 1.34586054788695  103.75366641455  19135.59
122      659762       659762 1.34552849960874 103.756449399351  19445.30
123      677742       677742 1.38378546546228 103.760273432258  19871.00
124      677744       677744  1.3858892193692 103.767794469258  20708.01
125      679002       679002 1.37942873617052  103.76970317201  20920.40
126      679287       679287   1.366603668561 103.767412204602  20665.41
127      679676       679676 1.37350089986584 103.769417337654  20888.58
128      679944       679944 1.38394936211823 103.773632022975  21357.65
129      679946       679946 1.38917971808454  103.76639772288  20552.58
130      688261       688261 1.38388660469396 103.753924558586  19164.46
131      688268       688268 1.40278303219036 103.746801233973  18371.80
132      689100       689100 1.39672603497195 103.751817992962  18930.07
133      689189       689189 1.39356050497104 103.747362720939  18434.25
134      689285       689285  1.3947078296399 103.743201812831  17971.20
135      689762       689762 1.38143123987698    103.747153671  18410.93
136      689814       689814 1.38026516111464 103.736554295636  17231.35
137      689905       689905 1.37775890093367 103.741832917421  17818.78
138      737803       737803 1.44700426493785 103.801889031334  24502.39
139      737888       737888 1.42896700684852 103.790607539185  23246.90
140      737942       737942 1.43989958331782 103.804725587384  24818.04
141      738079       738079 1.43273620725049  103.79023031392  23204.93
142      738240       738240 1.43485179380236  103.79741434351  24004.40
143      738525       738525 1.44203596557592 103.788339762066  22994.56
144      738853       738853 1.43658270720199 103.791791282236  23378.65
145      738907       738907  1.4426347903311 103.800040119743  24296.63
146      738908       738908 1.44414835451585 103.794545295922  23685.14
147      738927       738927 1.43383904037059 103.773643013846  21359.01
148      739063       739063 1.43047990810126 103.778192944298  21865.34
149      739067       739067 1.43240935732525 103.786035065192  22738.06
150      757521       757521 1.45388170417263 103.817174701639  26203.45
151      757622       757622 1.45732867302094 103.814075611175  25858.57
152      757702       757702 1.45168517614776 103.822516208087  26797.87
153      757714       757714 1.45125024371543 103.815858858929  26057.01
154      757715       757715  1.4457453096024 103.821152676215  26646.13
155      768515       768515 1.42768847665227 103.830425490093  27678.04
156      768611       768611 1.43347186925064 103.837755319448  28493.74
157      768643       768643 1.43315271543517 103.832942401086  27958.14
158      768679       768679 1.43397617334964 103.834050796658  28081.48
159      768687       768687 1.41741627551251 103.830143209875  27646.63
160      768857       768857 1.42697284512936 103.844240226564  29215.42
161      768959       768959 1.43839562897006 103.839309173817  28666.66
162      768960       768960 1.42745159462566 103.848378442893  29675.94
163      769026       769026 1.42130404159807 103.840792923345  28831.79
164      769028       769028 1.41590195697649 103.839100590207  28643.46
165      797538       797538 1.39726966050479 103.880330305684  33231.78
166      797636       797636  1.3925400930811 103.874984869551  32636.91
167      797701       797701 1.39030227963797 103.874445458032  32576.88
168      828671       828671 1.41842322079348 103.905147201163  35993.49
169      828674       828674 1.41158455562454  103.89890448429  35298.79
170      828716       828716 1.40507184758584 103.911200193835  36667.16
171      828728       828728 1.40744168163777 103.898762173662  35282.97
172      828772       828772 1.40172590450528 103.898794262307  35286.55
173      828802       828802 1.39889261226315 103.918585924582  37489.11
174      828819       828819   1.399550034492 103.913404855665  36912.52
175      828845       828845 1.40505250226058 103.905299026568  36010.44
176      828848       828848 1.39648195114256  103.91233462071  36793.43
177      828867       828867 1.39485356081865  103.90857257736  36374.77
178      828869       828869 1.40009139510996 103.907847599114  36294.07
    latitude                  geometry
1   28660.79 POINT (28739.43 28660.79)
2   28611.06 POINT (27425.62 28611.06)
3   28597.16  POINT (26975.8 28597.16)
4   28732.45 POINT (25252.19 28732.45)
5   32839.91 POINT (19465.19 32839.91)
6   33496.24 POINT (19962.23 33496.24)
7   33215.77 POINT (20668.24 33215.77)
8   33038.64  POINT (20190.3 33038.64)
9   31484.03 POINT (22673.28 31484.03)
10  31352.08 POINT (24288.03 31352.08)
11  30878.55 POINT (25143.14 30878.55)
12  29780.11 POINT (26022.22 29780.11)
13  30414.72 POINT (27010.19 30414.72)
14  29627.11 POINT (27180.15 29627.11)
15  32740.58 POINT (29941.78 32740.58)
16  32406.84 POINT (28849.34 32406.84)
17  30729.75 POINT (28300.53 30729.75)
18  33702.84 POINT (25146.89 33702.84)
19  33216.96 POINT (22544.29 33216.96)
20  34694.80     POINT (25004 34694.8)
21  35844.39 POINT (28722.62 35844.39)
22  33342.78 POINT (29370.51 33342.78)
23  33654.52 POINT (27426.45 33654.52)
24  33404.23 POINT (28254.98 33404.23)
25  35831.63 POINT (30471.88 35831.63)
26  35439.72  POINT (30450.9 35439.72)
27  35501.58 POINT (29539.12 35501.58)
28  34994.53 POINT (28949.15 34994.53)
29  33779.04 POINT (30705.45 33779.04)
30  33784.85 POINT (31570.81 33784.85)
31  35316.15 POINT (32707.71 35316.15)
32  34845.27 POINT (31538.85 34845.27)
33  34319.15 POINT (33443.12 34319.15)
34  34070.05    POINT (33376 34070.05)
35  33379.26    POINT (33599 33379.26)
36  32588.94  POINT (34124.7 32588.94)
37  34533.27 POINT (35566.41 34533.27)
38  32090.16 POINT (36656.98 32090.16)
39  32693.67 POINT (35744.04 32693.67)
40  31924.22 POINT (35421.03 31924.22)
41  31984.80  POINT (37376.41 31984.8)
42  31957.47 POINT (36706.79 31957.47)
43  33450.77 POINT (37341.65 33450.77)
44  33581.14 POINT (38064.43 33581.14)
45  33275.46 POINT (40513.58 33275.46)
46  33965.69 POINT (39636.53 33965.69)
47  35130.51 POINT (38983.89 35130.51)
48  34668.92 POINT (38949.99 34668.92)
49  35212.93 POINT (40009.96 35212.93)
50  35138.95 POINT (39240.13 35138.95)
51  35270.41  POINT (37789.9 35270.41)
52  34811.50  POINT (36645.74 34811.5)
53  39722.31 POINT (39310.69 39722.31)
54  39672.62 POINT (40460.98 39672.62)
55  39385.60   POINT (41766.5 39385.6)
56  39384.60  POINT (42423.37 39384.6)
57  38630.99 POINT (42194.05 38630.99)
58  39999.88 POINT (39783.53 39999.88)
59  36666.47 POINT (39785.85 36666.47)
60  37747.93  POINT (39343.4 37747.93)
61  37688.82 POINT (40890.13 37688.82)
62  37198.82 POINT (42284.83 37198.82)
63  36712.23 POINT (41150.37 36712.23)
64  36969.57 POINT (41131.94 36969.57)
65  37047.45 POINT (41046.67 37047.45)
66  36955.72  POINT (40270.1 36955.72)
67  38061.66 POINT (40848.28 38061.66)
68  36866.50  POINT (39540.41 36866.5)
69  35821.84 POINT (41216.89 35821.84)
70  39929.52 POINT (33284.68 39929.52)
71  39478.48 POINT (35151.03 39478.48)
72  38774.69  POINT (34765.9 38774.69)
73  36929.87 POINT (33734.52 36929.87)
74  39990.37 POINT (33823.13 39990.37)
75  39308.71 POINT (33507.78 39308.71)
76  39514.00    POINT (34279.17 39514)
77  40020.03 POINT (34827.33 40020.03)
78  37785.95 POINT (34332.07 37785.95)
79  41909.17 POINT (34242.94 41909.17)
80  40635.77 POINT (34458.68 40635.77)
81  41365.63 POINT (33992.45 41365.63)
82  40501.04 POINT (35005.09 40501.04)
83  41569.27 POINT (34439.32 41569.27)
84  40999.84  POINT (35777.2 40999.84)
85  41693.55 POINT (35926.59 41693.55)
86  41241.87 POINT (35368.24 41241.87)
87  39429.26 POINT (32613.23 39429.26)
88  38036.27 POINT (32050.22 38036.27)
89  36788.55 POINT (31911.64 36788.55)
90  36825.12 POINT (31226.41 36825.12)
91  37723.20  POINT (31415.53 37723.2)
92  39330.38  POINT (30052.7 39330.38)
93  38632.18 POINT (29968.82 38632.18)
94  38001.50  POINT (30275.89 38001.5)
95  40683.26 POINT (28900.66 40683.26)
96  39038.16 POINT (28702.48 39038.16)
97  39792.77 POINT (28276.74 39792.77)
98  38071.92 POINT (27966.81 38071.92)
99  36835.12 POINT (30414.93 36835.12)
100 35582.91 POINT (21648.98 35582.91)
101 35547.20  POINT (20603.35 35547.2)
102 34984.58 POINT (22442.59 34984.58)
103 36729.23 POINT (16853.08 36729.23)
104 36118.96 POINT (17710.49 36118.96)
105 35419.87 POINT (17179.43 35419.87)
106 35597.61 POINT (15176.23 35597.61)
107 35399.68 POINT (13129.85 35399.68)
108 37066.28 POINT (14006.52 37066.28)
109 35705.12 POINT (13029.92 35705.12)
110 36095.65 POINT (11781.81 36095.65)
111 36773.40  POINT (12607.09 36773.4)
112 36648.95 POINT (13215.14 36648.95)
113 36317.36 POINT (13047.82 36317.36)
114 36541.34 POINT (15217.27 36541.34)
115 36555.81 POINT (15562.43 36555.81)
116 36110.29 POINT (14594.08 36110.29)
117 36812.40  POINT (17694.72 36812.4)
118 37370.85  POINT (19191.2 37370.85)
119 38463.08 POINT (18644.37 38463.08)
120 37916.87 POINT (18557.57 37916.87)
121 36444.08 POINT (19135.59 36444.08)
122 36407.36  POINT (19445.3 36407.36)
123 40637.61    POINT (19871 40637.61)
124 40870.21 POINT (20708.01 40870.21)
125 40155.83  POINT (20920.4 40155.83)
126 38737.71 POINT (20665.41 38737.71)
127 39500.36 POINT (20888.58 39500.36)
128 40655.69 POINT (21357.65 40655.69)
129 41234.06 POINT (20552.58 41234.06)
130 40648.81 POINT (19164.46 40648.81)
131 42738.31  POINT (18371.8 42738.31)
132 42068.54 POINT (18930.07 42068.54)
133 41718.53 POINT (18434.25 41718.53)
134 41845.41  POINT (17971.2 41845.41)
135 40377.34 POINT (18410.93 40377.34)
136 40248.44 POINT (17231.35 40248.44)
137 39971.29 POINT (17818.78 39971.29)
138 47627.92 POINT (24502.39 47627.92)
139 45633.47  POINT (23246.9 45633.47)
140 46842.32 POINT (24818.04 46842.32)
141 46050.25 POINT (23204.93 46050.25)
142 46284.17  POINT (24004.4 46284.17)
143 47078.58 POINT (22994.56 47078.58)
144 46475.58 POINT (23378.65 46475.58)
145 47144.77 POINT (24296.63 47144.77)
146 47312.14 POINT (23685.14 47312.14)
147 46172.24 POINT (21359.01 46172.24)
148 45800.79 POINT (21865.34 45800.79)
149 46014.12 POINT (22738.06 46014.12)
150 48388.38 POINT (26203.45 48388.38)
151 48769.53 POINT (25858.57 48769.53)
152 48145.49 POINT (26797.87 48145.49)
153 48097.40  POINT (26057.01 48097.4)
154 47488.69 POINT (26646.13 47488.69)
155 45492.05 POINT (27678.04 45492.05)
156 46131.55 POINT (28493.74 46131.55)
157 46096.26 POINT (27958.14 46096.26)
158 46187.32 POINT (28081.48 46187.32)
159 44356.21 POINT (27646.63 44356.21)
160 45412.93 POINT (29215.42 45412.93)
161 46676.00    POINT (28666.66 46676)
162 45465.87 POINT (29675.94 45465.87)
163 44786.10  POINT (28831.79 44786.1)
164 44188.76 POINT (28643.46 44188.76)
165 42128.55 POINT (33231.78 42128.55)
166 41605.56 POINT (32636.91 41605.56)
167 41358.12 POINT (32576.88 41358.12)
168 44467.67 POINT (35993.49 44467.67)
169 43711.47 POINT (35298.79 43711.47)
170 42991.37 POINT (36667.16 42991.37)
171 43253.37 POINT (35282.97 43253.37)
172 42621.35 POINT (35286.55 42621.35)
173 42308.13 POINT (37489.11 42308.13)
174 42380.80  POINT (36912.52 42380.8)
175 42989.21 POINT (36010.44 42989.21)
176 42041.54 POINT (36793.43 42041.54)
177 41861.47 POINT (36374.77 41861.47)
178 42440.64 POINT (36294.07 42440.64)</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine latitude and longitude in `coords` int a single "geometry" column and convert to an sf object</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>coords_school <span class="ot">&lt;-</span> coords_school <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(postal_code, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><code>Following which, the coords_sf is then combined to the resale_selected df by address, forming a new df resale_geom</code></p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>school_cleaned <span class="ot">&lt;-</span> school <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(coords_school, <span class="at">by =</span> <span class="st">"postal_code"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the code chunk, we will extract the longitude and latitude from the geometry to facilitate transforming into sf.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>school_cleaned <span class="ot">&lt;-</span> school_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">longitude =</span> <span class="fu">st_coordinates</span>(geometry)[, <span class="dv">1</span>],  <span class="co"># Extract longitude</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">latitude =</span> <span class="fu">st_coordinates</span>(geometry)[, <span class="dv">2</span>]    <span class="co"># Extract latitude</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then, we are able to transform this into sf with the new longitude and latitude columns.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>school_cleaned<span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(school_cleaned, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="malls" class="level3" data-number="1.5.9">
<h3 data-number="1.5.9" class="anchored" data-anchor-id="malls"><span class="header-section-number">1.5.9</span> Malls</h3>
<p>As the af <em>mall</em> was in WGS84, it will transformed into SVY21 EPSG 3414.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an sf object with WGS 84 CRS</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>mall <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(mall, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, <span class="st">"LATITUDE"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to EPSG:3414</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>mall_cleaned <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(mall, <span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>From the code below, we noticed that there are two malls that are duplicated.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>geom_text <span class="ot">&lt;-</span> <span class="fu">st_as_text</span>(<span class="fu">st_geometry</span>(mall_cleaned))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Find duplicated geometries</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> mall_cleaned[<span class="fu">duplicated</span>(geom_text) <span class="sc">|</span> <span class="fu">duplicated</span>(geom_text, <span class="at">fromLast =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Number of duplicate geometries found:"</span>, <span class="fu">nrow</span>(duplicates)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of duplicate geometries found: 4"</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(duplicates) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Duplicate records:"</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(duplicates)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nDuplicate records:"
Simple feature collection with 4 features and 1 field
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 29695.5 ymin: 34261.3 xmax: 38710.09 ymax: 36920.73
Projected CRS: SVY21 / Singapore TM
# A tibble: 4 × 2
  `Mall Name`                  geometry
  &lt;chr&gt;                     &lt;POINT [m]&gt;
1 Junction 8         (29695.5 36920.73)
2 Djitsun Mall Bedok (38710.09 34261.3)
3 Djitsun Mall       (38710.09 34261.3)
4 Junction 8         (29695.5 36920.73)</code></pre>
</div>
</div>
<p>Hence, with the code below, we will remove the duplicate.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert geometry to text for comparison</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>geom_text <span class="ot">&lt;-</span> <span class="fu">st_as_text</span>(<span class="fu">st_geometry</span>(mall_cleaned))</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add row numbers to track which entries we keep</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>mall_cleaned<span class="sc">$</span>row_num <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mall_cleaned)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove duplicates, keeping first occurrence only</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>mall_cleaned<span class="ot">&lt;-</span> mall_cleaned[<span class="sc">!</span><span class="fu">duplicated</span>(geom_text), ]</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>mall_cleaned <span class="ot">&lt;-</span> mall_cleaned <span class="sc">%&gt;%</span> </span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Mall Name</span><span class="st">`</span>, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="park" class="level3" data-number="1.5.10">
<h3 data-number="1.5.10" class="anchored" data-anchor-id="park"><span class="header-section-number">1.5.10</span> Park</h3>
<p>The code chunk below checks if there are any duplicates geometries and it returns nil.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the geometries as text for easier comparison</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>geom_park <span class="ot">&lt;-</span> <span class="fu">st_as_text</span>(<span class="fu">st_geometry</span>(park))</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find duplicated geometries</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>duplicates_park <span class="ot">&lt;-</span> park[<span class="fu">duplicated</span>(geom_park) <span class="sc">|</span> <span class="fu">duplicated</span>(geom_park, <span class="at">fromLast =</span> <span class="cn">TRUE</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As the sf park was in WGS84, it will transformed into SVY21 EPSG 3414.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an sf object with WGS 84 CRS</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>park <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(park, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, <span class="st">"LATITUDE"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to EPSG:3414</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>park_cleaned <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(park, <span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="mrt" class="level3" data-number="1.5.11">
<h3 data-number="1.5.11" class="anchored" data-anchor-id="mrt"><span class="header-section-number">1.5.11</span> MRT</h3>
<p>Let’s take a quick glimpse at the data. We noticed that there duplicated station names, depots, command centres (i.e.&nbsp;BOCC - to which I derived it as a <a href="https://landtransportguru.net/trapeze-common-fleet-management-system/seletar-bus-depot-interiors-7/">Bus Operations Control Centre</a>, stations that are under construction.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mrt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 230
Columns: 6
$ TYP_CD     &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ STN_NAM    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ATTACHEMEN &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ TYP_CD_DES &lt;chr&gt; "MRT", "MRT", "MRT", "MRT", "MRT", "MRT", "MRT", "MRT", "LR…
$ STN_NAM_DE &lt;chr&gt; "GALI BATU DEPOT", "HILLVIEW MRT STATION", "BEAUTY WORLD MR…
$ geometry   &lt;POLYGON [m]&gt; POLYGON ((19210.61 41858.04..., POLYGON ((20650.33 …</code></pre>
</div>
</div>
<p>Thus, with the code chunk below, we use the duplicate function to check which are the duplciated stations. Noticeably, these stations are actually interchange where it consists of more than 1 metro line (i.e.&nbsp;Outram Park where it houses East-West, Thomson-EastCoast, and North-East Line). However, Bayshore MRT isn’t an interchange but there are 2 duplicates of it that is likely due to the construction of Bedok South where both links. Regardless, the decision to keep these variables retains as it serves as an important proximate to the residential areas in geospatial setting.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for duplicates in the STN_NAM_DE column and display the whole rows</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> mrt <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(STN_NAM_DE) <span class="sc">%&gt;%</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display duplicates if any</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(duplicates) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(duplicates)</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No duplicates found in the STN_NAM_DE column."</span>)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 50 features and 5 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 22616.72 ymin: 27478.44 xmax: 42456.47 ymax: 46579.58
Projected CRS: SVY21
# A tibble: 50 × 6
   TYP_CD STN_NAM ATTACHEMEN     TYP_CD_DES STN_NAM_DE                  geometry
    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;                  &lt;POLYGON [m]&gt;
 1      0 &lt;NA&gt;    &lt;NA&gt;           MRT        DHOBY GHA… ((29293.51 31312.53, 293…
 2      0 &lt;NA&gt;    CC15_BSH STN.… MRT        BISHAN MR… ((29683.2 37087.82, 2970…
 3      0 &lt;NA&gt;    CC13_SER STN.… MRT        SERANGOON… ((32244.31 36987.67, 322…
 4      0 &lt;NA&gt;    &lt;NA&gt;           MRT        TAMPINES … ((40488.79 37181.92, 404…
 5      0 &lt;NA&gt;    &lt;NA&gt;           MRT        STEVENS M… ((27140.4 33629.43, 2714…
 6      0 &lt;NA&gt;    CC10_MPS STN.… MRT        MACPHERSO… ((34310.59 34386.88, 343…
 7      0 &lt;NA&gt;    C504_S_CGA_MA… MRT        EXPO MRT … ((42293.7 35208.13, 4229…
 8      0 &lt;NA&gt;    NE1_HBF STN.z… MRT        HARBOURFR… ((26584.75 27512.49, 265…
 9      0 &lt;NA&gt;    CE2_MRB STN.z… MRT        MARINA BA… ((30397.79 28652.09, 303…
10      0 &lt;NA&gt;    CC9_PYL STN.z… MRT        PAYA LEBA… ((34495.6 33384.44, 3452…
# ℹ 40 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(duplicates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 50
Columns: 6
$ TYP_CD     &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ STN_NAM    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ATTACHEMEN &lt;chr&gt; NA, "CC15_BSH STN.zip", "CC13_SER STN.zip", NA, NA, "CC10_M…
$ TYP_CD_DES &lt;chr&gt; "MRT", "MRT", "MRT", "MRT", "MRT", "MRT", "MRT", "MRT", "MR…
$ STN_NAM_DE &lt;chr&gt; "DHOBY GHAUT MRT STATION", "BISHAN MRT STATION", "SERANGOON…
$ geometry   &lt;POLYGON [m]&gt; POLYGON ((29293.51 31312.53..., POLYGON ((29683.2 3…</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.lta.gov.sg/content/dam/ltagov/getting_around/public_transport/rail_network/image/SM_TEL4_Eng_(Ver150824)_TL_Main.pdf"><img src="images/Screenshot 2024-11-03 at 14.58.56.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="MRT System Map"></a></p>
</figure>
</div>
<figcaption>MRT System Map</figcaption>
</figure>
</div>
<p>In the below code chunk, we will cross-check with the MRT map above and remove the names are that are depots, operation centres, sub stations and columns that are not needed. The code chunks includes stations with “MRT STATION” or “LRT STATION”.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>mrt_cleaned <span class="ot">&lt;-</span> mrt <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>TYP_CD, <span class="sc">-</span>STN_NAM, <span class="sc">-</span>ATTACHEMEN) <span class="sc">%&gt;%</span>  <span class="co"># Remove specified columns</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"MRT STATION|LRT STATION"</span>, STN_NAM_DE, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>))  <span class="co"># Filter rows</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the cleaned sf object</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mrt_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 215 features and 2 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 6068.209 ymin: 27478.44 xmax: 45377.5 ymax: 47913.58
Projected CRS: SVY21
First 10 features:
   TYP_CD_DES                STN_NAM_DE                       geometry
1         MRT      HILLVIEW MRT STATION POLYGON ((20650.33 38282.33...
2         MRT  BEAUTY WORLD MRT STATION POLYGON ((21594.72 35882.94...
3         MRT          HUME MRT STATION POLYGON ((20808 37457.72, 2...
4         MRT BUKIT PANJANG MRT STATION POLYGON ((19996.27 40187.21...
5         MRT        CASHEW MRT STATION POLYGON ((20340.38 39136.76...
6         MRT   DHOBY GHAUT MRT STATION POLYGON ((29293.51 31312.53...
7         MRT      LAVENDER MRT STATION POLYGON ((31236.5 32085.76,...
8         LRT       RENJONG LRT STATION POLYGON ((34382.66 40949.64...
9         MRT         DOVER MRT STATION POLYGON ((21987.25 32576.91...
10        LRT       PHOENIX LRT STATION POLYGON ((19602.92 40048.64...</code></pre>
</div>
</div>
<p>In the list, we noticed that some of the MRT stations are actually under construction. Hence we cross-checked with the MRT map above and exclude those that are under construction.</p>
<p>First, we create a list of excluded MRT list. Then we use Regex to exclude it using if function.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the words to exclude</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>words_to_exclude <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"HUME"</span>, <span class="st">"SUNGEI BEDOK"</span>, <span class="st">"BEDOK SOUTH"</span>, <span class="st">"XILIN"</span>, </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"PUNGGOL COAST"</span>, <span class="st">"BUKIT BROWN"</span>, <span class="st">"MOUNT PLEASANT"</span>, </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"FOUNDERS' MEMORIAL"</span>)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a regular expression pattern to match any of the words</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>pattern <span class="ot">&lt;-</span> <span class="fu">paste</span>(words_to_exclude, <span class="at">collapse =</span> <span class="st">"|"</span>)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the train object is an sf object</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">inherits</span>(mrt_cleaned, <span class="st">"sf"</span>)) {</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"The 'train' object is not an sf object."</span>)</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the train sf object to exclude rows with specified words in STN_NAM_DE</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>mrt_cleaned  <span class="ot">&lt;-</span> mrt_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(STN_NAM_DE, <span class="fu">regex</span>(pattern, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the results</span></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(mrt_cleaned))  <span class="co"># Print the first few rows of the filtered object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 2 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 19932.72 ymin: 31220.26 xmax: 31375.01 ymax: 40255.73
Projected CRS: SVY21
  TYP_CD_DES                STN_NAM_DE                       geometry
1        MRT      HILLVIEW MRT STATION POLYGON ((20650.33 38282.33...
2        MRT  BEAUTY WORLD MRT STATION POLYGON ((21594.72 35882.94...
3        MRT BUKIT PANJANG MRT STATION POLYGON ((19996.27 40187.21...
4        MRT        CASHEW MRT STATION POLYGON ((20340.38 39136.76...
5        MRT   DHOBY GHAUT MRT STATION POLYGON ((29293.51 31312.53...
6        MRT      LAVENDER MRT STATION POLYGON ((31236.5 32085.76,...</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mrt_cleaned )      <span class="co"># Summary of the filtered object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  TYP_CD_DES         STN_NAM_DE                 geometry  
 Length:211         Length:211         POLYGON      :211  
 Class :character   Class :character   epsg:NA      :  0  
 Mode  :character   Mode  :character   +proj=tmer...:  0  </code></pre>
</div>
</div>
<p>We will then view() the mrt_cleaned sf and search for the excluded MRT stations in ensuring that it is not there.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(mrt_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(mrt_cleaned) <span class="ot">&lt;-</span> <span class="dv">3414</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="supermarket" class="level3" data-number="1.5.12">
<h3 data-number="1.5.12" class="anchored" data-anchor-id="supermarket"><span class="header-section-number">1.5.12</span> Supermarket</h3>
<p>The code chunk below checks if there are any duplicates geometries and it returns several duplicates.</p>
<p>In the table below, we noticed that there are 33 rows of geometries returned with 2-4 duplicates in each geometry. In explaining this issue, we can zoom into the description column and it will surface different supermarket names sharing the same geometry. This is likely due to the changing of the tenants.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>supermarket <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/geospatial/supermarket.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find duplicated geometries</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>duplicate_ids <span class="ot">&lt;-</span> supermarket <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">duplicated</span>(<span class="fu">st_geometry</span>(.)) <span class="sc">|</span> <span class="fu">duplicated</span>(<span class="fu">st_geometry</span>(.), <span class="at">fromLast =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(geometry) <span class="sc">%&gt;%</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(geometry)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table with duplicates together in a row and count</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>duplicates_table <span class="ot">&lt;-</span> supermarket <span class="sc">%&gt;%</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">st_geometry</span>(geometry) <span class="sc">%in%</span> duplicate_ids) <span class="sc">%&gt;%</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(geometry) <span class="sc">%&gt;%</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">duplicate_entries =</span> <span class="fu">list</span>(<span class="fu">cur_data</span>()), </span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">count =</span> <span class="fu">n</span>(),         <span class="co"># Count the number of duplicates</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="co"># View the duplicated entries together in a row with counts</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(duplicates_table) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Duplicated geometries found:"</span>)</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(duplicates_table)</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>  total_duplicates <span class="ot">&lt;-</span> <span class="fu">sum</span>(duplicates_table<span class="sc">$</span>count)</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Total number of duplicates:"</span>, total_duplicates, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No duplicated geometries found."</span>)</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Duplicated geometries found:"
Simple feature collection with 33 features and 2 fields
Geometry type: POINT
Dimension:     XYZ
Bounding box:  xmin: 103.6342 ymin: 1.27031 xmax: 103.9624 ymax: 1.451325
z_range:       zmin: 0 zmax: 0
Geodetic CRS:  WGS 84
# A tibble: 33 × 3
                  geometry duplicate_entries count
               &lt;POINT [°]&gt; &lt;list&gt;            &lt;int&gt;
 1 Z (103.8142 1.322573 0) &lt;tibble [2 × 2]&gt;      2
 2  Z (103.7627 1.37835 0) &lt;tibble [2 × 2]&gt;      2
 3 Z (103.8007 1.439916 0) &lt;tibble [2 × 2]&gt;      2
 4  Z (103.857 1.307785 0) &lt;tibble [2 × 2]&gt;      2
 5 Z (103.9132 1.402878 0) &lt;tibble [2 × 2]&gt;      2
 6 Z (103.8435 1.274588 0) &lt;tibble [2 × 2]&gt;      2
 7 Z (103.9051 1.301191 0) &lt;tibble [4 × 2]&gt;      4
 8 Z (103.8945 1.314692 0) &lt;tibble [2 × 2]&gt;      2
 9 Z (103.7653 1.303583 0) &lt;tibble [2 × 2]&gt;      2
10 Z (103.7882 1.306849 0) &lt;tibble [2 × 2]&gt;      2
# ℹ 23 more rows
Total number of duplicates: 74 </code></pre>
</div>
</div>
<p>In addressing the duplicate, only one geometry will be retained while the rest will be eradicated.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove duplicates while retaining unique geometries</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>supermarket <span class="ot">&lt;-</span> supermarket <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(geometry, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)  <span class="co"># Keep all columns for the unique geometries</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Following which, we can check again to see if there’s any duplicates remaining and it returns nil.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find duplicated geometries</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>duplicate_ids <span class="ot">&lt;-</span> supermarket <span class="sc">%&gt;%</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">duplicated</span>(<span class="fu">st_geometry</span>(.)) <span class="sc">|</span> <span class="fu">duplicated</span>(<span class="fu">st_geometry</span>(.), <span class="at">fromLast =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(geometry) <span class="sc">%&gt;%</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(geometry)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table with duplicates together in a row and count</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>duplicates_table <span class="ot">&lt;-</span> supermarket <span class="sc">%&gt;%</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">st_geometry</span>(geometry) <span class="sc">%in%</span> duplicate_ids) <span class="sc">%&gt;%</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(geometry) <span class="sc">%&gt;%</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">duplicate_entries =</span> <span class="fu">list</span>(<span class="fu">cur_data</span>()), </span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">count =</span> <span class="fu">n</span>(),         <span class="co"># Count the number of duplicates</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="co"># View the duplicated entries together in a row with counts</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(duplicates_table) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Duplicated geometries found:"</span>)</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(duplicates_table)</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>  total_duplicates <span class="ot">&lt;-</span> <span class="fu">sum</span>(duplicates_table<span class="sc">$</span>count)</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Total number of duplicates:"</span>, total_duplicates, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No duplicated geometries found."</span>)</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "No duplicated geometries found."</code></pre>
</div>
</div>
<p>The data is then transformed from WGS84 to SVY21.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an sf object with WGS 84 CRS</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>supermarket <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(supermarket, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, <span class="st">"LATITUDE"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to EPSG:3414</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>supermarket_cleaned <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(supermarket, <span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>coordinates <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(supermarket_cleaned)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>supermarket_cleaned <span class="ot">&lt;-</span> supermarket_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude =</span> coordinates[, <span class="dv">1</span>],    <span class="co"># First column is longitude</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude =</span> coordinates[, <span class="dv">2</span>]) <span class="sc">%&gt;%</span>  </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(longitude, latitude, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="computing-proximity-to-resale-transactions" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="computing-proximity-to-resale-transactions"><span class="header-section-number">1.6</span> Computing Proximity to Resale Transactions</h2>
<section id="bus-stop" class="level4" data-number="1.6.0.1">
<h4 data-number="1.6.0.1" class="anchored" data-anchor-id="bus-stop"><span class="header-section-number">1.6.0.1</span> Bus Stop</h4>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create busstop_resale with just the two columns we want</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>busstop_resale <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">busstop_prox =</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(resale_geom)),</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">within_350m_busstop =</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(resale_geom)))</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each resale point</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(resale_geom)) {</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get current resale point</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  current_point <span class="ot">&lt;-</span> resale_geom[i, ]</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate distances to all bus stops</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(current_point, busstop_cleaned)</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store minimum distance in km in busstop_prox</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>  busstop_resale<span class="sc">$</span>busstop_prox[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">min</span>(distances)) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count bus stops within 350 meters</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>  busstop_resale<span class="sc">$</span>within_350m_busstop[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(distances) <span class="sc">&lt;=</span> <span class="dv">350</span>)</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify results</span></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(busstop_resale))             <span class="co"># Print the first few rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  busstop_prox within_350m_busstop
1   0.09807302                  10
2   0.11396279                   6
3   0.12282400                   3
4   0.12282400                   3
5   0.10566508                   3
6   0.16643716                   6</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(busstop_resale)                 <span class="co"># Summary of both columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  busstop_prox     within_350m_busstop
 Min.   :0.01543   Min.   : 0.000     
 1st Qu.:0.07418   1st Qu.: 6.000     
 Median :0.10727   Median : 8.000     
 Mean   :0.11449   Mean   : 7.907     
 3rd Qu.:0.14582   3rd Qu.:10.000     
 Max.   :0.39147   Max.   :19.000     </code></pre>
</div>
</div>
</section>
<section id="eldercare-1" class="level4" data-number="1.6.0.2">
<h4 data-number="1.6.0.2" class="anchored" data-anchor-id="eldercare-1"><span class="header-section-number">1.6.0.2</span> Eldercare</h4>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create eldercare_resale with just the two columns we want</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>eldercare_resale <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">eldercare_prox =</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(resale_geom)),</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">within_350m_eldercare =</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(resale_geom)))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each point in busstop_resale</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(resale_geom)) {</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get current point</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  current_point <span class="ot">&lt;-</span> resale_geom[i, ]</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate distances to all eldercare centers</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(current_point, eldercare_cleaned)</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store minimum distance in km in eldercare_prox</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>  eldercare_resale<span class="sc">$</span>eldercare_prox[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">min</span>(distances)) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count eldercare facilities within 350 meters</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>  eldercare_resale<span class="sc">$</span>within_350m_eldercare[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(distances) <span class="sc">&lt;=</span> <span class="dv">350</span>)</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify results</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(eldercare_resale))             <span class="co"># Print the first few rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  eldercare_prox within_350m_eldercare
1      0.3419924                     1
2      0.2597442                     1
3      0.2811279                     1
4      0.2811279                     1
5      0.4296838                     0
6      0.4043587                     0</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(eldercare_resale)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> eldercare_prox   within_350m_eldercare
 Min.   :0.0000   Min.   :0.0000       
 1st Qu.:0.3303   1st Qu.:0.0000       
 Median :0.6308   Median :0.0000       
 Mean   :0.7983   Mean   :0.3898       
 3rd Qu.:1.0931   3rd Qu.:1.0000       
 Max.   :4.7675   Max.   :7.0000       </code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="hawker-1" class="level4" data-number="1.6.0.3">
<h4 data-number="1.6.0.3" class="anchored" data-anchor-id="hawker-1"><span class="header-section-number">1.6.0.3</span> Hawker</h4>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create eldercare_resale with just the two columns we want</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>hawker_resale <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">hawker_prox =</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(resale_geom)))</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each point in busstop_resale</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(resale_geom)) {</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get current point</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  current_point <span class="ot">&lt;-</span> resale_geom[i, ]</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate distances to all eldercare centers</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(current_point, hawker_cleaned)</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store minimum distance in km in eldercare_prox</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>  hawker_resale<span class="sc">$</span>hawker_prox[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">min</span>(distances)) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify results</span></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(hawker_resale))             <span class="co"># Print the first few rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  hawker_prox
1   0.1861061
2   0.4248262
3   0.3108075
4   0.3108075
5   0.3143604
6   0.1378719</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="kindergarten-1" class="level4" data-number="1.6.0.4">
<h4 data-number="1.6.0.4" class="anchored" data-anchor-id="kindergarten-1"><span class="header-section-number">1.6.0.4</span> Kindergarten</h4>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create eldercare_resale with just the two columns we want</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>kindergarten_resale <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">kindergarten_prox =</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(resale_geom)),</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">within_350m_kindergarten =</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(resale_geom)))</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each point in busstop_resale</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(resale_geom)) {</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get current point</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>  current_point <span class="ot">&lt;-</span> resale_geom[i, ]</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate distances to all eldercare centers</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(current_point, kindergarten_cleaned)</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store minimum distance in km in eldercare_prox</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>  kindergarten_resale<span class="sc">$</span>kindergarten_prox[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">min</span>(distances)) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count eldercare facilities within 350 meters</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>  kindergarten_resale<span class="sc">$</span>within_350m_kindergarten[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(distances) <span class="sc">&lt;=</span> <span class="dv">350</span>)</span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify results</span></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(kindergarten_resale))             <span class="co"># Print the first few rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  kindergarten_prox within_350m_kindergarten
1         0.5507577                        0
2         0.2085693                        1
3         0.2082784                        1
4         0.2082784                        1
5         0.1232351                        1
6         0.1951542                        2</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(kindergarten_resale)   <span class="co"># Summary of both columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> kindergarten_prox within_350m_kindergarten
 Min.   :0.0000    Min.   :0.0000          
 1st Qu.:0.1773    1st Qu.:0.0000          
 Median :0.2810    Median :1.0000          
 Mean   :0.3052    Mean   :0.9791          
 3rd Qu.:0.4021    3rd Qu.:1.0000          
 Max.   :3.1675    Max.   :8.0000          </code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)              </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="malls-1" class="level4" data-number="1.6.0.5">
<h4 data-number="1.6.0.5" class="anchored" data-anchor-id="malls-1"><span class="header-section-number">1.6.0.5</span> Malls</h4>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#change CRS of mall_cleaned to align to CRS EPSG 3414 </span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(mall_cleaned) <span class="ot">&lt;-</span> <span class="dv">3414</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create eldercare_resale with just the two columns we want</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>mall_resale <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mall_prox =</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(resale_geom)))</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each point in busstop_resale</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(resale_geom)) {</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get current point</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>  current_point <span class="ot">&lt;-</span> resale_geom[i, ]</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate distances to all eldercare centers</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(current_point, mall_cleaned)</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store minimum distance in km in eldercare_prox</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>  mall_resale<span class="sc">$</span>mall_prox[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">min</span>(distances)) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify results</span></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(mall_resale))             <span class="co"># Print the first few rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  mall_prox
1  48.70776
2  48.80401
3  48.81649
4  48.81649
5  48.60214
6  48.12243</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="mrt-1" class="level4" data-number="1.6.0.6">
<h4 data-number="1.6.0.6" class="anchored" data-anchor-id="mrt-1"><span class="header-section-number">1.6.0.6</span> MRT</h4>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create eldercare_resale with just the two columns we want</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>mrt_resale <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mrt_prox =</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(resale_geom)))</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each point in busstop_resale</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(resale_geom)) {</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get current point</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>  current_point <span class="ot">&lt;-</span> resale_geom[i, ]</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate distances to all eldercare centers</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(current_point, mrt_cleaned)</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store minimum distance in km in eldercare_prox</span></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>  mrt_resale<span class="sc">$</span>mrt_prox[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">min</span>(distances)) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify results</span></span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(mrt_resale))             <span class="co"># Print the first few rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    mrt_prox
1 0.90926089
2 0.27613980
3 0.33461983
4 0.33461983
5 0.06951106
6 0.39898970</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="park-1" class="level4" data-number="1.6.0.7">
<h4 data-number="1.6.0.7" class="anchored" data-anchor-id="park-1"><span class="header-section-number">1.6.0.7</span> Park</h4>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create eldercare_resale with just the two columns we want</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>park_resale <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">park_prox =</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(resale_geom)))</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each point in busstop_resale</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(resale_geom)) {</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get current point</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  current_point <span class="ot">&lt;-</span> resale_geom[i, ]</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate distances to all eldercare centers</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(current_point, park_cleaned)</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store minimum distance in km in eldercare_prox</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>  park_resale<span class="sc">$</span>park_prox[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">min</span>(distances)) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify results</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(park_resale))             <span class="co"># Print the first few rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  park_prox
1 0.2815657
2 0.3108840
3 0.3411321
4 0.3411321
5 0.2436839
6 0.1985831</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="school-1" class="level4" data-number="1.6.0.8">
<h4 data-number="1.6.0.8" class="anchored" data-anchor-id="school-1"><span class="header-section-number">1.6.0.8</span> School</h4>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create eldercare_resale with just the two columns we want</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>school_resale <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">school_prox =</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(resale_geom)),</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">within_1km_school =</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(resale_geom)))</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each point in busstop_resale</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(resale_geom)) {</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get current point</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>  current_point <span class="ot">&lt;-</span> resale_geom[i, ]</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate distances to all eldercare centers</span></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(current_point, school_cleaned)</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store minimum distance in km in eldercare_prox</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>  school_resale<span class="sc">$</span>school_prox[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">min</span>(distances)) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count eldercare facilities within 1000 meters</span></span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>  school_resale<span class="sc">$</span>within_1km_school[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(distances) <span class="sc">&lt;=</span> <span class="dv">1000</span>)</span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify results</span></span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(school_resale))             <span class="co"># Print the first few rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  school_prox within_1km_school
1   0.2279026                 2
2   0.4437104                 3
3   0.1210031                 3
4   0.1210031                 3
5   0.2472647                 2
6   0.2692533                 2</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(school_resale)   <span class="co"># Summary of both columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  school_prox      within_1km_school
 Min.   :0.04354   Min.   :0.000    
 1st Qu.:0.24063   1st Qu.:2.000    
 Median :0.37618   Median :3.000    
 Mean   :0.42942   Mean   :2.979    
 3rd Qu.:0.54703   3rd Qu.:4.000    
 Max.   :3.29166   Max.   :9.000    </code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="supermarkets" class="level4" data-number="1.6.0.9">
<h4 data-number="1.6.0.9" class="anchored" data-anchor-id="supermarkets"><span class="header-section-number">1.6.0.9</span> Supermarkets</h4>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create eldercare_resale with just the two columns we want</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>supermarket_resale <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">supermarket_prox =</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(resale_geom)))</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each point in busstop_resale</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(resale_geom)) {</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get current point</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  current_point <span class="ot">&lt;-</span> resale_geom[i, ]</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate distances to all eldercare centers</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(current_point, supermarket_cleaned)</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store minimum distance in km in eldercare_prox</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>  supermarket_resale<span class="sc">$</span>supermarket_prox[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">min</span>(distances)) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify results</span></span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(supermarket_resale))             <span class="co"># Print the first few rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  supermarket_prox
1        0.3872724
2        0.1666790
3        0.3212926
4        0.3212926
5        0.3413032
6        0.1577571</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="visualisations" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="visualisations"><span class="header-section-number">1.7</span> Visualisations</h2>
<p>In the code chunk below, we are able to view the mininum, maximum, median and quadrants of the data. Interesting, the minimum and maximum resale price were $150,000 and $1.58m. And the smallest age of unit was 3 whereas the oldest was 58.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(resale_geom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   address              town            resale_price        month          
 Length:47423       Length:47423       Min.   : 150000   Length:47423      
 Class :character   Class :character   1st Qu.: 460000   Class :character  
 Mode  :character   Mode  :character   Median : 565000   Mode  :character  
                                       Mean   : 587538                     
                                       3rd Qu.: 685000                     
                                       Max.   :1588000                     
  flat_type         floor_area_sqm   remaining_lease_yr   longitude    
 Length:47423       Min.   : 31.00   Min.   :41.0       Min.   :11519  
 Class :character   1st Qu.: 74.00   1st Qu.:60.0       1st Qu.:21661  
 Mode  :character   Median : 93.00   Median :73.0       Median :29281  
                    Mean   : 95.22   Mean   :73.3       Mean   :28655  
                    3rd Qu.:111.00   3rd Qu.:90.0       3rd Qu.:35078  
                    Max.   :366.70   Max.   :96.0       Max.   :45192  
    latitude              geometry        unit_age   
 Min.   :28098   POINT        :47423   Min.   : 3.0  
 1st Qu.:35670   epsg:3414    :    0   1st Qu.: 9.0  
 Median :38929   +proj=tmer...:    0   Median :26.0  
 Mean   :39069                         Mean   :25.7  
 3rd Qu.:42401                         3rd Qu.:39.0  
 Max.   :48741                         Max.   :58.0  </code></pre>
</div>
</div>
<p>We will use tmap to create an iteractive map of the resale prices. Noticebly, the “hotter” resale flats are concentrated in the south and middle area with scatters around the east and west.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz)<span class="sc">+</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(resale_geom) <span class="sc">+</span>  </span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"resale_price"</span>,</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">style=</span><span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TakeHome3_files/figure-html/unnamed-chunk-129-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz)<span class="sc">+</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(resale_geom) <span class="sc">+</span>  </span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"unit_age"</span>,</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">style=</span><span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TakeHome3_files/figure-html/unnamed-chunk-130-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In barchart below, we have populated the percentage of transactions stratified by town. Visibly, Punggol attains the highest 7.7% followed by Woodlands at 7.6%. Hence We would want to predict the HDB resale prices for these two towns.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>town_percentages <span class="ot">&lt;-</span> resale_geom <span class="sc">%&gt;%</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(town) <span class="sc">%&gt;%</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> (count<span class="sc">/</span><span class="fu">sum</span>(count))<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(percentage))  <span class="co"># Sort in descending order</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar chart</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(town_percentages, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(town, <span class="sc">-</span>percentage), <span class="at">y =</span> percentage)) <span class="sc">+</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, percentage)), </span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Percentage Distribution of Resale Transactions by Town"</span>,</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Town"</span>,</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage of Total Transactions (%)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TakeHome3_files/figure-html/unnamed-chunk-131-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="final-amendments" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="final-amendments"><span class="header-section-number">1.8</span> Final Amendments</h2>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> resale_geom <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(busstop_resale, eldercare_resale, hawker_resale,</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>            kindergarten_resale, mall_resale, mrt_resale,</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>            park_resale, school_resale, supermarket_resale)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Firstly, we will change the column “month” to POSIXct for easier manipulation.</p>
<p>As we are focusing on 4-room HDB flats, we will filter according to that.</p>
<p>Lastly, as we’re working with an sf (spatial features) object, we need to use a different approach to remove columns instead of using dplyr. We will use select(!matches) to remove the column address.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">as.POSIXct</span>(<span class="fu">paste0</span>(month, <span class="st">"-01"</span>), <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(flat_type <span class="sc">==</span> <span class="st">"4 ROOM"</span>) <span class="sc">%&gt;%</span> <span class="co"># Change from int to num</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(address, flat_type)) <span class="sc">%&gt;%</span> </span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">remaining_lease_yr =</span> <span class="fu">as.numeric</span>(remaining_lease_yr)) <span class="co"># Change from int to num</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="machine-learning" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="machine-learning"><span class="header-section-number">1.9</span> Machine Learning</h2>
<section id="data-sampling" class="level3" data-number="1.9.1">
<h3 data-number="1.9.1" class="anchored" data-anchor-id="data-sampling"><span class="header-section-number">1.9.1</span> Data Sampling</h3>
<p>The entire data are split into training (Jan 2023 - June 2024) and testing (July 2024 - Sept 2024) data sets into by using <em>initial_split()</em> of <strong>rsample</strong> package. rsample is one of the package of tigymodels.</p>
<p>In this section, we will split the data into training data - Jan 2023 to June 2024 &amp; test Data - July 2024 to Sept 2024 that is stratified by Punggol &amp; Woodlands. We can see there are 1549 training records and 300 testing records for Punggol whereas in Woodlands there are 1391 training records and 238 testing records.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>train_data_punggol <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span> <span class="fu">as.POSIXct</span>(<span class="st">"2023-01-01"</span>) <span class="sc">&amp;</span> </span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>         month <span class="sc">&lt;=</span> <span class="fu">as.POSIXct</span>(<span class="st">"2024-06-30"</span>) <span class="sc">&amp;</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>         town <span class="sc">==</span> <span class="st">"PUNGGOL"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(month))</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>test_data_punggol <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span> <span class="fu">as.POSIXct</span>(<span class="st">"2024-07-01"</span>) <span class="sc">&amp;</span> </span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>         month <span class="sc">&lt;=</span> <span class="fu">as.POSIXct</span>(<span class="st">"2024-09-30"</span>) <span class="sc">&amp;</span></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>         town <span class="sc">==</span> <span class="st">"PUNGGOL"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(month))</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: to check the filtered data</span></span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Number of training records:"</span>, <span class="fu">nrow</span>(train_data_punggol)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of training records: 1549"</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Number of testing records:"</span>, <span class="fu">nrow</span>(test_data_punggol)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of testing records: 300"</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(train_data_punggol, <span class="st">"data/rds/ml/punggol/train_data_punggol.rds"</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(test_data_punggol, <span class="st">"data/rds/ml/punggol/test_data_punggol.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>train_data_woodlands <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span> <span class="fu">as.POSIXct</span>(<span class="st">"2023-01-01"</span>) <span class="sc">&amp;</span> </span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>         month <span class="sc">&lt;=</span> <span class="fu">as.POSIXct</span>(<span class="st">"2024-06-30"</span>) <span class="sc">&amp;</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>         town <span class="sc">==</span> <span class="st">"WOODLANDS"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(month))</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>test_data_woodlands <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span> <span class="fu">as.POSIXct</span>(<span class="st">"2024-07-01"</span>) <span class="sc">&amp;</span> </span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>         month <span class="sc">&lt;=</span> <span class="fu">as.POSIXct</span>(<span class="st">"2024-09-30"</span>) <span class="sc">&amp;</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>         town <span class="sc">==</span> <span class="st">"WOODLANDS"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(month))</span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: to check the filtered data</span></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Number of training records:"</span>, <span class="fu">nrow</span>(train_data_woodlands)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of training records: 1391"</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Number of testing records:"</span>, <span class="fu">nrow</span>(test_data_woodlands)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of testing records: 238"</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(train_data_woodlands, <span class="st">"data/rds/ml/woodlands/train_data_woodlands.rds"</span>)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(test_data_woodlands, <span class="st">"data/rds/ml/woodlands/test_data_woodlands.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="computing-correlation-matrix" class="level3" data-number="1.9.2">
<h3 data-number="1.9.2" class="anchored" data-anchor-id="computing-correlation-matrix"><span class="header-section-number">1.9.2</span> Computing Correlation Matrix</h3>
<p>Prior to loading predictors into predictive model, a correlation matrix will be use to check for sign of multicollinearity. From the correlation matrix below, all correlation values are below 0.8, indicating no sign of multicollinearity.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>data_nogeo <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(month)) <span class="sc">%&gt;%</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="fu">cor</span>(data_nogeo[, <span class="dv">2</span><span class="sc">:</span><span class="dv">19</span>]), </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diag =</span> <span class="cn">FALSE</span>, </span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">order =</span> <span class="st">"AOE"</span>,</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.pos =</span> <span class="st">"td"</span>, </span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.cex =</span> <span class="fl">0.5</span>, </span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"number"</span>, </span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">"upper"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TakeHome3_files/figure-html/unnamed-chunk-143-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="retrieving-stored-data" class="level3" data-number="1.9.3">
<h3 data-number="1.9.3" class="anchored" data-anchor-id="retrieving-stored-data"><span class="header-section-number">1.9.3</span> Retrieving Stored Data</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>train_data_punggol <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/punggol/train_data_punggol.rds"</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>test_data_punggol <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/punggol/test_data_punggol.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>train_data_woodlands <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/woodlands/train_data_woodlands.rds"</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>test_data_woodlands <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/woodlands/test_data_woodlands.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="building-a-non-spatial-multiple-linear-regression" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="building-a-non-spatial-multiple-linear-regression"><span class="header-section-number">1.10</span> Building a non-spatial multiple linear regression</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the linear model for resale_price using the specified variables</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>price_mlr_p <span class="ot">&lt;-</span> <span class="fu">lm</span>(resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox,</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> train_data_punggol)</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the linear model</span></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(price_mlr_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = resale_price ~ floor_area_sqm + unit_age + within_350m_busstop + 
    within_350m_eldercare + hawker_prox + within_350m_kindergarten + 
    mall_prox + mrt_prox + park_prox + within_1km_school + supermarket_prox, 
    data = train_data_punggol)

Residuals:
    Min      1Q  Median      3Q     Max 
-136613  -26146     -96   26415  140294 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              -2425118.0   181420.5 -13.367  &lt; 2e-16 ***
floor_area_sqm              11207.8      669.0  16.754  &lt; 2e-16 ***
unit_age                    -3655.1      390.9  -9.351  &lt; 2e-16 ***
within_350m_busstop          -601.6      515.7  -1.167 0.243557    
within_350m_eldercare       18135.0     2457.4   7.380 2.59e-13 ***
hawker_prox                -73597.2     5073.0 -14.508  &lt; 2e-16 ***
within_350m_kindergarten     -788.8     2040.8  -0.387 0.699178    
mall_prox                   37612.1     3120.5  12.053  &lt; 2e-16 ***
mrt_prox                   -81583.3    11403.9  -7.154 1.30e-12 ***
park_prox                   64924.6     7539.8   8.611  &lt; 2e-16 ***
within_1km_school           -5807.9     1023.9  -5.673 1.68e-08 ***
supermarket_prox            41305.5    11410.9   3.620 0.000304 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 39990 on 1537 degrees of freedom
Multiple R-squared:  0.5345,    Adjusted R-squared:  0.5311 
F-statistic: 160.4 on 11 and 1537 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(price_mlr_p, <span class="st">"data/rds/ml/punggol/price_mlr_p.rds"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the linear model for resale_price using the specified variables</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>price_mlr_w <span class="ot">&lt;-</span> <span class="fu">lm</span>(resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox,</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> train_data_woodlands)</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the linear model</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(price_mlr_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = resale_price ~ floor_area_sqm + unit_age + within_350m_busstop + 
    within_350m_eldercare + hawker_prox + within_350m_kindergarten + 
    mall_prox + mrt_prox + park_prox + within_1km_school + supermarket_prox, 
    data = train_data_woodlands)

Residuals:
    Min      1Q  Median      3Q     Max 
-108605  -18479    -861   17651  118328 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              475932.61   72526.66   6.562 7.48e-11 ***
floor_area_sqm             2320.91     142.03  16.341  &lt; 2e-16 ***
unit_age                  -4309.72      84.93 -50.742  &lt; 2e-16 ***
within_350m_busstop         386.65     394.41   0.980   0.3271    
within_350m_eldercare      1333.49    1282.39   1.040   0.2986    
hawker_prox              -16533.03    3163.02  -5.227 1.99e-07 ***
within_350m_kindergarten   2531.64    1171.15   2.162   0.0308 *  
mall_prox                 -1004.92    1442.73  -0.697   0.4862    
mrt_prox                 -44163.93    4902.52  -9.008  &lt; 2e-16 ***
park_prox                -15524.87    2149.37  -7.223 8.38e-13 ***
within_1km_school           693.69     670.29   1.035   0.3009    
supermarket_prox             23.45    5293.65   0.004   0.9965    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 28570 on 1379 degrees of freedom
Multiple R-squared:  0.748, Adjusted R-squared:  0.746 
F-statistic: 372.1 on 11 and 1379 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(price_mlr_w, <span class="st">"data/rds/ml/woodlands/price_mlr_w.rds"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="geographically-weighted-regression" class="level2" data-number="1.11">
<h2 data-number="1.11" class="anchored" data-anchor-id="geographically-weighted-regression"><span class="header-section-number">1.11</span> Geographically Weighted Regression</h2>
<p>Now, we will calibrate a model to predict HDB resale price by using geographically weighted regression method of <a href="https://cran.r-project.org/web/packages/GWmodel/index.html"><strong>GWmodel</strong></a> package.</p>
<section id="converting-the-sf-data.frame-to-spatialpointdataframe" class="level3" data-number="1.11.1">
<h3 data-number="1.11.1" class="anchored" data-anchor-id="converting-the-sf-data.frame-to-spatialpointdataframe"><span class="header-section-number">1.11.1</span> Converting the sf data.frame to SpatialPointDataFrame</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>train_data_sp_p <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(train_data_punggol)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>train_data_sp_p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPointsDataFrame 
features    : 1549 
extent      : 34320.85, 37615.35, 41556.12, 43933.95  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 20
names       :    town, resale_price, floor_area_sqm, remaining_lease_yr,        longitude,         latitude, unit_age,       busstop_prox, within_350m_busstop,       eldercare_prox, within_350m_eldercare,      hawker_prox,    kindergarten_prox, within_350m_kindergarten,        mall_prox, ... 
min values  : PUNGGOL,       456000,             85,                 78, 34320.8500594051, 41556.1217510505,        4, 0.0232098182955299,                   2, 9.08133417710502e-07,                     0, 0.23549332350391, 3.08593427233971e-07,                        0, 54.6825044697734, ... 
max values  : PUNGGOL,        8e+05,             99,                 95, 37615.3527353946, 43933.9470685477,       21,  0.320676170721283,                  14,     1.69953951976499,                     2, 1.98905282800319,    0.804615824046136,                        3, 56.7005204705412, ... </code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>train_data_sp_w <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(train_data_woodlands)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>train_data_sp_w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPointsDataFrame 
features    : 1391 
extent      : 21177.26, 25268.25, 45373.58, 47860.89  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 20
names       :      town, resale_price, floor_area_sqm, remaining_lease_yr,        longitude,         latitude, unit_age,       busstop_prox, within_350m_busstop,     eldercare_prox, within_350m_eldercare,        hawker_prox,    kindergarten_prox, within_350m_kindergarten,        mall_prox, ... 
min values  : WOODLANDS,       350000,             83,                 49, 21177.2576852251, 45373.5757321722,        4, 0.0199595426953728,                   4, 0.0547017433825683,                     0, 0.0666360841718605, 6.84731226937912e-07,                        0, 50.0713376927117, ... 
max values  : WOODLANDS,       690000,            119,                 95, 25268.2547251521, 47860.8875505569,       50,  0.253082170943171,                  16,   1.73109192014879,                     3,   1.56805500852822,    0.760166885640459,                        4, 53.6923986369607, ... </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="computing-adaptive-bandwidth" class="level3" data-number="1.11.2">
<h3 data-number="1.11.2" class="anchored" data-anchor-id="computing-adaptive-bandwidth"><span class="header-section-number">1.11.2</span> Computing adaptive bandwidth</h3>
<p>Next, <code>bw.gwr()</code> of <strong>GWmodel</strong> package will be used to determine the optimal bandwidth to be used.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>bw_adaptive_p <span class="ot">&lt;-</span> <span class="fu">bw.gwr</span>(resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox,</span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>train_data_sp_p,</span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">approach=</span><span class="st">"CV"</span>,</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">kernel=</span><span class="st">"gaussian"</span>,</span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">adaptive=</span><span class="cn">TRUE</span>,</span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">longlat=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Take a cup of tea and have a break, it will take a few minutes.
          -----A kind suggestion from GWmodel development group
Adaptive bandwidth: 964 CV score: 2.37468e+12 
Adaptive bandwidth: 604 CV score: 2.273545e+12 
Adaptive bandwidth: 379 CV score: 2.179535e+12 
Adaptive bandwidth: 243 CV score: 2.073315e+12 
Adaptive bandwidth: 155 CV score: 2.011629e+12 
Adaptive bandwidth: 105 CV score: 1.983025e+12 
Adaptive bandwidth: 69 CV score: 1.946889e+12 
Adaptive bandwidth: 52 CV score: 1.916621e+12 
Adaptive bandwidth: 36 CV score: 1.894903e+12 
Adaptive bandwidth: 31 CV score: 1.888189e+12 
Adaptive bandwidth: 23 CV score: 1.901021e+12 
Adaptive bandwidth: 31 CV score: 1.888189e+12 </code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The result shows that 31 neighbour points will be the optimal bandwidth to be used if adaptive bandwidth is used for this data set.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Insights</p>
<p>The result shows that 86 neighbour points will be the optimal bandwidth to be used if adaptive bandwidth is used for this data set.</p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(bw_adaptive_p, <span class="st">"data/rds/ml/punggol/bw_adaptive_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>bw_adaptive_w <span class="ot">&lt;-</span> <span class="fu">bw.gwr</span>(resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox,</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>train_data_sp_w,</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">approach=</span><span class="st">"CV"</span>,</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">kernel=</span><span class="st">"gaussian"</span>,</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">adaptive=</span><span class="cn">TRUE</span>,</span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">longlat=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Adaptive bandwidth: 867 CV score: 1.120907e+12 
Adaptive bandwidth: 544 CV score: 1.112173e+12 
Adaptive bandwidth: 343 CV score: 1.101484e+12 
Adaptive bandwidth: 220 CV score: 1.079251e+12 
Adaptive bandwidth: 142 CV score: 1.057357e+12 
Adaptive bandwidth: 96 CV score: 1.047183e+12 
Adaptive bandwidth: 65 CV score: 1.027565e+12 
Adaptive bandwidth: 48 CV score: 1.015162e+12 
Adaptive bandwidth: 35 CV score: 1.307044e+12 
Adaptive bandwidth: 53 CV score: 1.017467e+12 
Adaptive bandwidth: 41 CV score: 1.303681e+12 
Adaptive bandwidth: 48 CV score: 1.015162e+12 </code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Insights</p>
<p>The results shows that 48 neighbour points will be the optimal bandwidth to be used if adaptive bandwidth is used for this data set.</p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(bw_adaptive_w, <span class="st">"data/rds/ml/woodlands/bw_adaptive_w.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="constructing-the-adaptive-bandwidth-gwr-model" class="level3" data-number="1.11.3">
<h3 data-number="1.11.3" class="anchored" data-anchor-id="constructing-the-adaptive-bandwidth-gwr-model"><span class="header-section-number">1.11.3</span> Constructing the adaptive bandwidth gwr model</h3>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>bw_adaptive_p <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/punggol/bw_adaptive_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>bw_adaptive_w <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/woodlands/bw_adaptive_w.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we can go ahead to calibrate the gwr-based hedonic pricing model by using adaptive bandwidth and Gaussian kernel as shown in the code chunk below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive_p <span class="ot">&lt;-</span> <span class="fu">gwr.basic</span>(<span class="at">formula =</span> resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox,</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>train_data_sp_p,</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">bw=</span>bw_adaptive_p, </span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">'gaussian'</span>, </span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">adaptive=</span><span class="cn">TRUE</span>,</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwr_adaptive_p, <span class="st">"data/rds/ml/punggol/gwr_adaptive_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive_w <span class="ot">&lt;-</span> <span class="fu">gwr.basic</span>(<span class="at">formula =</span> resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox,</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>train_data_sp_w,</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">bw=</span>bw_adaptive_w, </span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">'gaussian'</span>, </span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">adaptive=</span><span class="cn">TRUE</span>,</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwr_adaptive_w, <span class="st">"data/rds/ml/woodlands/gwr_adaptive_w.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="retrieve-gwr-output-object" class="level3" data-number="1.11.4">
<h3 data-number="1.11.4" class="anchored" data-anchor-id="retrieve-gwr-output-object"><span class="header-section-number">1.11.4</span> Retrieve gwr output object</h3>
<p>The code below can be used to display the model output.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive_p <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/punggol/gwr_adaptive_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive_p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   ***********************************************************************
   *                       Package   GWmodel                             *
   ***********************************************************************
   Program starts at: 2024-11-11 01:51:55.810254 
   Call:
   gwr.basic(formula = resale_price ~ floor_area_sqm + unit_age + 
    within_350m_busstop + within_350m_eldercare + hawker_prox + 
    within_350m_kindergarten + mall_prox + mrt_prox + park_prox + 
    within_1km_school + supermarket_prox, data = train_data_sp_p, 
    bw = bw_adaptive_p, kernel = "gaussian", adaptive = TRUE, 
    longlat = FALSE)

   Dependent (y) variable:  resale_price
   Independent variables:  floor_area_sqm unit_age within_350m_busstop within_350m_eldercare hawker_prox within_350m_kindergarten mall_prox mrt_prox park_prox within_1km_school supermarket_prox
   Number of data points: 1549
   ***********************************************************************
   *                    Results of Global Regression                     *
   ***********************************************************************

   Call:
    lm(formula = formula, data = data)

   Residuals:
    Min      1Q  Median      3Q     Max 
-136613  -26146     -96   26415  140294 

   Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)              -2425118.0   181420.5 -13.367  &lt; 2e-16 ***
   floor_area_sqm              11207.8      669.0  16.754  &lt; 2e-16 ***
   unit_age                    -3655.1      390.9  -9.351  &lt; 2e-16 ***
   within_350m_busstop          -601.6      515.7  -1.167 0.243557    
   within_350m_eldercare       18135.0     2457.4   7.380 2.59e-13 ***
   hawker_prox                -73597.2     5073.0 -14.508  &lt; 2e-16 ***
   within_350m_kindergarten     -788.8     2040.8  -0.387 0.699178    
   mall_prox                   37612.1     3120.5  12.053  &lt; 2e-16 ***
   mrt_prox                   -81583.3    11403.9  -7.154 1.30e-12 ***
   park_prox                   64924.6     7539.8   8.611  &lt; 2e-16 ***
   within_1km_school           -5807.9     1023.9  -5.673 1.68e-08 ***
   supermarket_prox            41305.5    11410.9   3.620 0.000304 ***

   ---Significance stars
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
   Residual standard error: 39990 on 1537 degrees of freedom
   Multiple R-squared: 0.5345
   Adjusted R-squared: 0.5311 
   F-statistic: 160.4 on 11 and 1537 DF,  p-value: &lt; 2.2e-16 
   ***Extra Diagnostic information
   Residual sum of squares: 2.457709e+12
   Sigma(hat): 39858.42
   AIC:  37237.26
   AICc:  37237.5
   BIC:  35853.24
   ***********************************************************************
   *          Results of Geographically Weighted Regression              *
   ***********************************************************************

   *********************Model calibration information*********************
   Kernel function: gaussian 
   Adaptive bandwidth: 31 (number of nearest neighbours)
   Regression points: the same locations as observations are used.
   Distance metric: Euclidean distance metric is used.

   ****************Summary of GWR coefficient estimates:******************
                                   Min.     1st Qu.      Median     3rd Qu.
   Intercept                -3.6026e+08 -1.8903e+07 -5.2468e+06  3.2394e+06
   floor_area_sqm           -9.3131e+05  4.9672e+03  9.1804e+03  1.6247e+04
   unit_age                 -7.2954e+03 -2.3589e+03  9.9553e+03  1.8568e+04
   within_350m_busstop      -2.1840e+04 -3.5978e+03  7.9328e+02  3.5622e+03
   within_350m_eldercare    -5.0557e+05 -2.9912e+03  1.7167e+04  5.6494e+04
   hawker_prox              -1.0870e+07 -3.7718e+05 -8.1130e+04  1.2870e+05
   within_350m_kindergarten -8.6012e+05 -2.8299e+04 -7.3968e+03  1.1648e+04
   mall_prox                -6.1324e+06 -5.6280e+04  8.8829e+04  3.3087e+05
   mrt_prox                 -1.5787e+06 -1.4296e+05 -9.5298e+03  2.0465e+05
   park_prox                -8.1186e+06 -1.7270e+05  1.5589e+04  3.1357e+05
   within_1km_school        -1.1002e+05 -7.9972e+03  4.7641e+02  8.1719e+03
   supermarket_prox         -3.4463e+06 -1.1782e+05 -4.4088e+04  5.4404e+04
                                 Max.
   Intercept                344376485
   floor_area_sqm              163021
   unit_age                     45035
   within_350m_busstop          20457
   within_350m_eldercare      3933539
   hawker_prox                1825411
   within_350m_kindergarten    323139
   mall_prox                  6261469
   mrt_prox                   8775702
   park_prox                  6609422
   within_1km_school           119709
   supermarket_prox          11102587
   ************************Diagnostic information*************************
   Number of data points: 1549 
   Effective number of parameters (2trace(S) - trace(S'S)): 216.9356 
   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 1332.064 
   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 36831.82 
   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 36605.4 
   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 36183.21 
   Residual sum of squares: 1.482095e+12 
   R-square value:  0.7192638 
   Adjusted R-square value:  0.6735097 

   ***********************************************************************
   Program stops at: 2024-11-11 01:51:57.180324 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Insights of 2 Regression Analysis in predicting resale price - Punggol</strong></p>
<ol type="1">
<li><p>Global Regression</p>
<ul>
<li><p><strong>Residuals</strong>: The residuals indicate the difference between the observed and predicted resale prices. The residuals range from -144,029 to 135,047, with a median of -1,271, suggesting that the model may not perfectly fit all data points, particularly those with extreme values.</p></li>
<li><p><strong>Coefficients</strong>: The estimated coefficients for each predictor variable indicate their respective impact on resale price.</p>
<ul>
<li><p><strong>Significant Variables</strong>: Variables like <code>floor_area_sqm</code>, <code>unit_age</code>, and <code>hawker_prox</code> are statistically significant with p-values less than 0.001, suggesting strong relationships with the resale price.</p></li>
<li><p><strong>Non-significant Variables</strong>: <code>within_350m_busstop</code> did not show significant effects on resale price, with p-values greater than 0.05.</p></li>
</ul></li>
<li><p><strong>Model Fit</strong>: The global regression model explains about <strong>51.57%</strong> of the variance in resale price (R-squared = 0.5157). The <strong>Adjusted R-squared</strong> is 0.5123, showing a modest fit after adjusting for the number of predictors. The <strong>F-statistic</strong> of 148.8, with a p-value less than 2.2e-16, indicates that the overall model is highly significant.</p></li>
<li><p><strong>AIC/BIC</strong>: The Akaike Information Criterion (AIC = 37,298.31) and the Bayesian Information Criterion (BIC = 35,914.29) suggest that the global model provides a reasonable fit, although these values are used for model comparison rather than absolute goodness-of-fit assessment.</p></li>
</ul></li>
<li><p>Geographically Weighted Regression</p></li>
</ol>
<p>This model was calibrated using the <strong>adaptive Gaussian kernel</strong> with an <strong>adaptive bandwidth</strong> of 31, meaning the model uses data from the 31 nearest neighbors to each observation.</p>
<ul>
<li><p><strong>Model Calibration</strong>: The GWR model was fitted using the same set of predictor variables as the global regression model. The use of an adaptive kernel and Euclidean distance metric enables the model to account for spatial heterogeneity in the relationships between predictors and resale price.</p></li>
<li><p><strong>Coefficient Estimates</strong>:</p>
<ul>
<li><p>The GWR model shows <strong>significant variation</strong> in the coefficient estimates across geographic locations. For instance:</p>
<ul>
<li><p>The coefficient for <code>floor_area_sqm</code> ranges from negative to positive values, indicating that the impact of floor area on resale price varies spatially.</p></li>
<li><p>The coefficient for <code>unit_age</code> shows a similar spatial variation, with the impact differing from location to location.</p></li>
<li><p><code>hawker_prox</code> and <code>supermarket_prox</code> also exhibit varying effects on resale price across locations.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Model Fit</strong>:</p>
<p><strong>R-squared</strong>: The GWR model explains approximately <strong>71.98%</strong> of the variance in resale price (R-squared = 0.7198), which is a substantial improvement over the global regression model. The <strong>Adjusted R-squared</strong> is 0.6743, indicating that the model explains a significant portion of the variance while accounting for the number of predictors.</p>
<p><strong>AIC/BIC</strong>: The GWR model shows lower AIC (36,602.13) and BIC (36,179.57) values than the global regression model, suggesting that the GWR model provides a better fit to the data when accounting for spatial variability.</p></li>
</ul>
<p><strong>Overall</strong></p>
<p>Spatially varying coefficients highlight that the impact of certain factors, such as <code>floor_area_sqm</code>, <code>unit_age</code>, and proximity to amenities like <code>hawker centers</code> and <code>supermarkets</code>, can differ significantly across different locations, suggesting that location-specific interventions or policies might be more effective in real estate pricing.</p>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive_w <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/woodlands/gwr_adaptive_w.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive_w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   ***********************************************************************
   *                       Package   GWmodel                             *
   ***********************************************************************
   Program starts at: 2024-11-11 01:51:57.292957 
   Call:
   gwr.basic(formula = resale_price ~ floor_area_sqm + unit_age + 
    within_350m_busstop + within_350m_eldercare + hawker_prox + 
    within_350m_kindergarten + mall_prox + mrt_prox + park_prox + 
    within_1km_school + supermarket_prox, data = train_data_sp_w, 
    bw = bw_adaptive_w, kernel = "gaussian", adaptive = TRUE, 
    longlat = FALSE)

   Dependent (y) variable:  resale_price
   Independent variables:  floor_area_sqm unit_age within_350m_busstop within_350m_eldercare hawker_prox within_350m_kindergarten mall_prox mrt_prox park_prox within_1km_school supermarket_prox
   Number of data points: 1391
   ***********************************************************************
   *                    Results of Global Regression                     *
   ***********************************************************************

   Call:
    lm(formula = formula, data = data)

   Residuals:
    Min      1Q  Median      3Q     Max 
-108605  -18479    -861   17651  118328 

   Coefficients:
                             Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)              475932.61   72526.66   6.562 7.48e-11 ***
   floor_area_sqm             2320.91     142.03  16.341  &lt; 2e-16 ***
   unit_age                  -4309.72      84.93 -50.742  &lt; 2e-16 ***
   within_350m_busstop         386.65     394.41   0.980   0.3271    
   within_350m_eldercare      1333.49    1282.39   1.040   0.2986    
   hawker_prox              -16533.03    3163.02  -5.227 1.99e-07 ***
   within_350m_kindergarten   2531.64    1171.15   2.162   0.0308 *  
   mall_prox                 -1004.92    1442.73  -0.697   0.4862    
   mrt_prox                 -44163.93    4902.52  -9.008  &lt; 2e-16 ***
   park_prox                -15524.87    2149.37  -7.223 8.38e-13 ***
   within_1km_school           693.69     670.29   1.035   0.3009    
   supermarket_prox             23.45    5293.65   0.004   0.9965    

   ---Significance stars
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
   Residual standard error: 28570 on 1379 degrees of freedom
   Multiple R-squared: 0.748
   Adjusted R-squared: 0.746 
   F-statistic: 372.1 on 11 and 1379 DF,  p-value: &lt; 2.2e-16 
   ***Extra Diagnostic information
   Residual sum of squares: 1.125708e+12
   Sigma(hat): 28468.32
   AIC:  32505.2
   AICc:  32505.46
   BIC:  31276.38
   ***********************************************************************
   *          Results of Geographically Weighted Regression              *
   ***********************************************************************

   *********************Model calibration information*********************
   Kernel function: gaussian 
   Adaptive bandwidth: 48 (number of nearest neighbours)
   Regression points: the same locations as observations are used.
   Distance metric: Euclidean distance metric is used.

   ****************Summary of GWR coefficient estimates:******************
                                   Min.     1st Qu.      Median     3rd Qu.
   Intercept                -1.1312e+09 -1.5632e+06  3.9476e+05  1.9149e+06
   floor_area_sqm           -1.5228e+04  9.8373e+02  2.1764e+03  2.7568e+03
   unit_age                 -5.2038e+03 -4.5082e+03 -3.9677e+03 -2.2334e+03
   within_350m_busstop      -5.5262e+03 -1.7354e+03 -5.3815e+02  1.2150e+03
   within_350m_eldercare    -4.4071e+05 -1.9180e+04 -5.4921e+03  3.5630e+02
   hawker_prox              -3.5823e+05 -3.8041e+04 -6.8955e+03  4.1019e+04
   within_350m_kindergarten -3.9285e+04 -4.2950e+03  6.3734e+02  6.3378e+03
   mall_prox                -2.4362e+05 -2.6020e+04  1.5904e+03  4.0938e+04
   mrt_prox                 -6.7648e+05 -6.8419e+04 -1.5806e+04  2.0814e+04
   park_prox                -3.5428e+05 -6.1010e+04 -2.2539e+04  2.6743e+03
   within_1km_school        -5.6562e+05 -9.8708e+03 -5.0483e+03 -2.4167e+03
   supermarket_prox         -5.4534e+05 -6.9462e+04 -3.9335e+04 -2.4152e+03
                                  Max.
   Intercept                13797986.0
   floor_area_sqm              18382.0
   unit_age                    13828.7
   within_350m_busstop          4947.6
   within_350m_eldercare     1085786.9
   hawker_prox              22332689.8
   within_350m_kindergarten   129965.6
   mall_prox                21420842.0
   mrt_prox                  3950844.9
   park_prox                  787950.9
   within_1km_school            7588.5
   supermarket_prox            94873.0
   ************************Diagnostic information*************************
   Number of data points: 1391 
   Effective number of parameters (2trace(S) - trace(S'S)): 131.5628 
   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 1259.437 
   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 32347.02 
   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 32221.73 
   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 31488.57 
   Residual sum of squares: 867184876654 
   R-square value:  0.8058492 
   Adjusted R-square value:  0.7855518 

   ***********************************************************************
   Program stops at: 2024-11-11 01:51:58.372047 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Insights of 2 Regression Analysis in predicting resale price - Woodlands</strong></p>
<ol type="1">
<li>Global Regression</li>
</ol>
<ul>
<li><p><strong>Residuals</strong>: The residuals range from -110,060 to 118,690, with a median of -926. This shows that the model can produce both underestimations and overestimations of resale price, with some extreme residuals indicating potential outliers.</p></li>
<li><p><strong>Coefficients</strong>:</p>
<ul>
<li><p><strong>Intercept</strong>: The base resale price when all predictors are zero is estimated at <strong>435,172.15</strong>.</p></li>
<li><p><strong>Significant Variables</strong>:</p>
<ul>
<li><p><strong><code>floor_area_sqm</code></strong>: Each additional square meter increases the resale price by <strong>2,247.33</strong>.</p></li>
<li><p><strong><code>unit_age</code></strong>: Each additional year of unit age decreases the resale price by <strong>4,322.06</strong>.</p></li>
<li><p><strong><code>hawker_prox</code></strong>: Proximity to hawker centers decreases resale price by <strong>-14,811.35</strong>.</p></li>
<li><p><strong><code>mrt_prox</code></strong>: Proximity to MRT stations has a significant negative effect of <strong>-45,257.65</strong> on resale price.</p></li>
<li><p><strong><code>park_prox</code></strong>: Proximity to parks also significantly decreases resale price by <strong>-15,817.05</strong>.</p></li>
<li><p><strong><code>within_350m_kindergarten</code></strong>: The presence of a kindergarten within 350 meters increases resale price by <strong>3,083.36</strong>.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Model Fit</strong>:</p>
<ul>
<li><p><strong>R-squared</strong>: The model explains about <strong>74.83%</strong> of the variance in resale price, indicating a strong overall fit.</p></li>
<li><p><strong>Adjusted R-squared</strong>: <strong>74.63%</strong>, which adjusts for the number of predictors.</p></li>
<li><p><strong>F-statistic</strong>: The F-statistic is <strong>372.7</strong>, with a p-value of less than 2.2e-16, indicating that the model is highly significant.</p></li>
</ul></li>
<li><p><strong>AIC/BIC</strong>:</p>
<ul>
<li><strong>AIC</strong>: 32,503.3, and <strong>BIC</strong>: 31,274.49, which provide a basis for model comparison and indicate that the global model fits the data reasonably well.</li>
</ul></li>
</ul>
<ol start="2" type="1">
<li>Geographical Weighted Regression</li>
</ol>
<ul>
<li><p><strong>Model Calibration</strong>:</p>
<ul>
<li><p><strong>Adaptive Bandwidth</strong>: 48 neighbors were used in the adaptive bandwidth, ensuring that the local influence of each observation is based on the proximity of other observations.</p></li>
<li><p><strong>Kernel Function</strong>: A Gaussian kernel was used, which gives more weight to observations closer to each location.</p></li>
</ul></li>
<li><p><strong>Coefficient Estimates</strong>: The coefficients for the predictors vary significantly across geographic locations:</p>
<ul>
<li><p><strong><code>floor_area_sqm</code></strong>: The effect of floor area on resale price ranges from negative to positive values. In some areas, additional floor space leads to a large increase in resale price, while in others, the impact is smaller.</p></li>
<li><p><strong><code>unit_age</code></strong>: The effect of unit age varies spatially, with some areas showing a significant negative impact on resale price, while in others, the impact is less pronounced.</p></li>
<li><p><strong><code>hawker_prox</code></strong>: The proximity to hawker centers shows a negative relationship with resale price in some regions, with a large range in coefficient estimates, suggesting that the effect of hawker centers on property prices varies significantly by location.</p></li>
<li><p><strong><code>mrt_prox</code></strong>: Proximity to MRT stations shows a negative effect in certain locations, with varying strength across different regions in Woodlands.</p></li>
<li><p><strong><code>park_prox</code></strong>: Proximity to parks also varies across locations, with some areas showing a stronger negative impact on resale price than others.</p></li>
</ul></li>
<li><p><strong>Model Fit</strong>:</p>
<ul>
<li><p><strong>R-squared</strong>: The GWR model explains <strong>80.58%</strong> of the variance in resale price, which represents a significant improvement over the global model (74.83%). This indicates that incorporating spatial variability greatly enhances model accuracy.</p></li>
<li><p><strong>Adjusted R-squared</strong>: <strong>78.52%</strong>, further indicating that the GWR model accounts for a significant amount of variance while adjusting for the number of predictors.</p></li>
</ul></li>
<li><p><strong>AIC/BIC</strong>:</p>
<ul>
<li><strong>AIC</strong>: 32,223.42 and <strong>BIC</strong>: 31,497.62, which are lower than the values for the global model, indicating that the GWR model provides a better fit for the data when accounting for spatial differences.</li>
</ul></li>
<li><p><strong>Residual Sum of Squares (RSS)</strong>: The GWR model has a residual sum of squares of <strong>8.67507e+11</strong>, suggesting that the model has reduced unexplained variance compared to the global model.</p></li>
</ul>
<p><strong>Overall</strong></p>
<p>The GWR model provides a much better fit for the resale price data in Woodlands compared to the global regression model. The improvement in <strong>R-squared</strong> (from 74.83% to 80.58%) suggests that there are significant spatial differences in the factors affecting resale prices.</p>
<ul>
<li><p><strong>Floor Area</strong>: The positive relationship between floor area and resale price varies significantly across Woodlands. In some areas, floor area is a strong predictor of resale price, while in others, it has a smaller effect.</p></li>
<li><p><strong>Unit Age</strong>: The negative effect of unit age on resale price is more pronounced in some parts of Woodlands, indicating that older units in certain locations have a larger impact on resale price.</p></li>
<li><p><strong>Proximity to Amenities</strong>: Variables such as proximity to MRT stations, parks, and hawker centers show varying effects across locations. For example, properties near MRT stations tend to have lower resale prices in some regions, while in others, the proximity to parks and kindergartens can increase prices.</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="converting-the-test-data-from-sf-data.frame-to-spatialpointdataframe" class="level3" data-number="1.11.5">
<h3 data-number="1.11.5" class="anchored" data-anchor-id="converting-the-test-data-from-sf-data.frame-to-spatialpointdataframe"><span class="header-section-number">1.11.5</span> Converting the test data from sf data.frame to SpatialPointDataFrame</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>test_data_sp_p <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(test_data_punggol)</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>test_data_sp_p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPointsDataFrame 
features    : 300 
extent      : 34320.85, 37549.49, 41631.21, 43933.95  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 20
names       :    town, resale_price, floor_area_sqm, remaining_lease_yr,        longitude,         latitude, unit_age,       busstop_prox, within_350m_busstop,       eldercare_prox, within_350m_eldercare,      hawker_prox,   kindergarten_prox, within_350m_kindergarten,        mall_prox, ... 
min values  : PUNGGOL,       495000,             85,                 77, 34320.8500594051, 41631.2121389891,        5, 0.0287942812318591,                   2, 9.08133417710502e-07,                     0, 0.28631929470226, 5.4646933332265e-07,                        0, 54.6825044697734, ... 
max values  : PUNGGOL,       788000,             99,                 94, 37549.4930230187, 43933.9470685477,       22,  0.286960879696002,                  14,     1.69953951976499,                     2, 1.94955185447985,   0.764704244775304,                        3, 56.6972972869625, ... </code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>test_data_sp_w <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(test_data_woodlands)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>test_data_sp_w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPointsDataFrame 
features    : 238 
extent      : 21177.26, 25186.96, 45373.58, 47860.89  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 20
names       :      town, resale_price, floor_area_sqm, remaining_lease_yr,        longitude,         latitude, unit_age,       busstop_prox, within_350m_busstop,     eldercare_prox, within_350m_eldercare,        hawker_prox,  kindergarten_prox, within_350m_kindergarten,        mall_prox, ... 
min values  : WOODLANDS,       355000,             83,                 48, 21177.2576852251, 45373.5757321722,        5, 0.0205869708371814,                   4, 0.0656405943898966,                     0, 0.0666360841718605, 8.502567959163e-07,                        0, 50.0713376927117, ... 
max values  : WOODLANDS,       701000,            111,                 94, 25186.9617010174, 47860.8875505569,       51,  0.253082170943171,                  16,   1.65460210369017,                     3,    1.5143514513644,  0.798763870107565,                        4, 53.6923986369607, ... </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="computing-adaptive-bandwidth-for-the-test-data" class="level3" data-number="1.11.6">
<h3 data-number="1.11.6" class="anchored" data-anchor-id="computing-adaptive-bandwidth-for-the-test-data"><span class="header-section-number">1.11.6</span> Computing adaptive bandwidth for the test data</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>gwr_bw_test_adaptive_p <span class="ot">&lt;-</span> <span class="fu">bw.gwr</span>(resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox,</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>test_data_sp_p,</span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">approach=</span><span class="st">"CV"</span>,</span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">kernel=</span><span class="st">"gaussian"</span>,</span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">adaptive=</span><span class="cn">TRUE</span>,</span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">longlat=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Adaptive bandwidth: 193 CV score: 461863083474 
Adaptive bandwidth: 127 CV score: 444482582747 
Adaptive bandwidth: 86 CV score: 429860319803 
Adaptive bandwidth: 60 CV score: 4.15545e+11 
Adaptive bandwidth: 45 CV score: 405403507470 
Adaptive bandwidth: 34 CV score: 406000083766 
Adaptive bandwidth: 50 CV score: 408265912967 
Adaptive bandwidth: 40 CV score: 406022699918 
Adaptive bandwidth: 46 CV score: 405735445126 
Adaptive bandwidth: 42 CV score: 406270763040 
Adaptive bandwidth: 44 CV score: 405653093262 
Adaptive bandwidth: 42 CV score: 406270763040 
Adaptive bandwidth: 43 CV score: 4.05838e+11 
Adaptive bandwidth: 42 CV score: 406270763040 
Adaptive bandwidth: 42 CV score: 406270763040 
Adaptive bandwidth: 41 CV score: 405877056522 
Adaptive bandwidth: 41 CV score: 405877056522 
Adaptive bandwidth: 40 CV score: 406022699918 
Adaptive bandwidth: 40 CV score: 406022699918 
Adaptive bandwidth: 39 CV score: 406410298495 
Adaptive bandwidth: 39 CV score: 406410298495 
Adaptive bandwidth: 38 CV score: 406480426659 
Adaptive bandwidth: 38 CV score: 406480426659 
Adaptive bandwidth: 37 CV score: 405643842893 
Adaptive bandwidth: 37 CV score: 405643842893 
Adaptive bandwidth: 36 CV score: 405801331672 
Adaptive bandwidth: 36 CV score: 405801331672 
Adaptive bandwidth: 35 CV score: 405721054702 
Adaptive bandwidth: 35 CV score: 405721054702 
Adaptive bandwidth: 34 CV score: 406000083766 
Adaptive bandwidth: 34 CV score: 406000083766 
Adaptive bandwidth: 33 CV score: 405311774904 </code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwr_bw_test_adaptive_p, <span class="st">"data/rds/ml/punggol/gwr_bw_test_adaptive_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>gwr_bw_test_adaptive_w<span class="ot">&lt;-</span> <span class="fu">bw.gwr</span>(resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox,</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>test_data_sp_w,</span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">approach=</span><span class="st">"CV"</span>,</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">kernel=</span><span class="st">"gaussian"</span>,</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">adaptive=</span><span class="cn">TRUE</span>,</span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">longlat=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Adaptive bandwidth: 154 CV score: 141474677352 
Adaptive bandwidth: 103 CV score: 140090697462 
Adaptive bandwidth: 70 CV score: 138907367486 
Adaptive bandwidth: 51 CV score: 137432823055 
Adaptive bandwidth: 38 CV score: 135519123552 
Adaptive bandwidth: 31 CV score: 134512516189 
Adaptive bandwidth: 25 CV score: 134598796510 
Adaptive bandwidth: 33 CV score: 1.34745e+11 
Adaptive bandwidth: 28 CV score: 135016725804 
Adaptive bandwidth: 31 CV score: 134512516189 </code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwr_bw_test_adaptive_w, <span class="st">"data/rds/ml/woodlands/gwr_bw_test_adaptive_w.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="computing-predicted-values-of-the-test-data" class="level3" data-number="1.11.7">
<h3 data-number="1.11.7" class="anchored" data-anchor-id="computing-predicted-values-of-the-test-data"><span class="header-section-number">1.11.7</span> Computing predicted values of the test data</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>gwr_pred_p <span class="ot">&lt;-</span> <span class="fu">gwr.predict</span>(<span class="at">formula =</span> resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox, </span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data=</span>train_data_sp_p, </span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">predictdata =</span> test_data_sp_p, </span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">bw=</span><span class="dv">100</span>, </span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">'gaussian'</span>, </span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">adaptive=</span><span class="cn">TRUE</span>, </span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb201-14"><a href="#cb201-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-15"><a href="#cb201-15" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>gwr_pred_p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   ***********************************************************************
   *                       Package   GWmodel                             *
   ***********************************************************************
   Program starts at: 2024-11-11 01:51:59.702211 
   Call:
   gwr.predict(formula = resale_price ~ floor_area_sqm + unit_age + 
    within_350m_busstop + within_350m_eldercare + hawker_prox + 
    within_350m_kindergarten + mall_prox + mrt_prox + park_prox + 
    within_1km_school + supermarket_prox, data = train_data_sp_p, 
    predictdata = test_data_sp_p, bw = 100, kernel = "gaussian", 
    adaptive = TRUE, longlat = FALSE)

   Dependent (y) variable for prediction:  resale_price
   Independent variables:  floor_area_sqm unit_age within_350m_busstop within_350m_eldercare hawker_prox within_350m_kindergarten mall_prox mrt_prox park_prox within_1km_school supermarket_prox
   Number of data points: 1549
   ***********************************************************************
   *     Results of Geographically Weighted Regression for prediction    *
   ***********************************************************************

   *********************Model calibration information*********************
   Kernel function: gaussian 
   Adaptive bandwidth: 100 (number of nearest neighbours)
   Distance metric: Euclidean distance metric is used.

   ****************Summary of GWR coefficient estimates:******************
                                        Min.     1st Qu.      Median
   Intercept_coef                -1.1137e+07 -4.0950e+06 -1.8008e+06
   floor_area_sqm_coef            6.5380e+02  7.4184e+03  9.3916e+03
   unit_age_coef                 -7.4305e+03 -3.9280e+03 -1.7500e+03
   within_350m_busstop_coef      -5.3279e+03 -2.1329e+03 -5.4695e+02
   within_350m_eldercare_coef    -3.0346e+04  2.0333e+03  1.8049e+04
   hawker_prox_coef              -4.4176e+05 -2.1443e+05 -7.7957e+04
   within_350m_kindergarten_coef -2.4241e+04 -1.6656e+04 -8.7511e+03
   mall_prox_coef                -1.9105e+05  9.2298e+03  2.5243e+04
   mrt_prox_coef                 -1.5919e+05 -8.3799e+04 -5.2551e+04
   park_prox_coef                -9.6160e+04  1.4933e+04  5.4488e+04
   within_1km_school_coef        -1.1990e+04 -6.1249e+03 -3.9312e+03
   supermarket_prox_coef         -1.2277e+05 -5.0793e+04 -2.8030e+04
                                     3rd Qu.       Max.
   Intercept_coef                -5.5879e+05 10743979.3
   floor_area_sqm_coef            1.2740e+04    19011.5
   unit_age_coef                  4.2753e+03    18101.9
   within_350m_busstop_coef       1.1316e+03     3852.9
   within_350m_eldercare_coef     2.8801e+04    65407.6
   hawker_prox_coef              -1.8368e+04   113086.4
   within_350m_kindergarten_coef -3.7455e+02    15082.2
   mall_prox_coef                 6.2916e+04   200516.3
   mrt_prox_coef                 -1.7414e+04   165209.6
   park_prox_coef                 1.3493e+05   365020.5
   within_1km_school_coef        -1.1988e+03     7789.1
   supermarket_prox_coef          3.2259e+04   117388.1

   ****************       Results of GW prediction       ******************
                        Min.    1st Qu.     Median    3rd Qu.       Max.
   prediction         459054     588680     609707     646438     708324
   prediction_var 1249829990 1264888497 1274282131 1284856043 1412261610

   ***********************************************************************
   Program stops at: 2024-11-11 01:52:47.242338 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwr_pred_p, <span class="st">"data/rds/ml/punggol/gwr_pred_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>GWR Coefficient Estimates</strong></p>
<p><strong>Interpretation</strong>:</p>
<ul>
<li><p>The <strong>Intercept</strong> varies greatly across locations, ranging from a negative coefficient (-1,441,251.41) to a positive coefficient (786,268.8), indicating that baseline resale prices are influenced differently across locations.</p></li>
<li><p><strong>floor_area_sqm</strong>: The effect of floor area on resale price ranges from negative to positive. In some locations, a larger floor area has a smaller impact, while in others it has a much larger effect.</p></li>
<li><p><strong>unit_age</strong>: The negative relationship between unit age and resale price is more pronounced in some areas, suggesting that older units may have a larger negative impact on property values in certain locations.</p></li>
<li><p><strong>Proximity to amenities</strong>: Variables such as <strong>hawker_prox</strong>, <strong>mrt_prox</strong>, <strong>park_prox</strong>, and <strong>supermarket_prox</strong> show a wide range of coefficients. For example, proximity to hawker centers has a strong negative impact in some regions, while proximity to parks and supermarkets has a positive impact in others.</p></li>
</ul>
<p><strong>Prediction Results</strong></p>
<p><strong>Interpretation</strong>:</p>
<ul>
<li><p>The predicted resale prices range from <strong>$463,945</strong> to <strong>$707,938</strong>, with a median prediction of <strong>$609,348</strong>. These values are within a reasonable range given the data and suggest a good predictive performance.</p></li>
<li><p>The <strong>prediction variance</strong> shows a substantial range, from about <strong>1.25 billion</strong> to <strong>1.4 billion</strong>, indicating that the predicted resale prices vary considerably. This is expected, as some locations may have more variability in resale price due to factors such as proximity to amenities and the overall market conditions.</p></li>
</ul>
<p><strong>Overall</strong></p>
<p>Key findings include:</p>
<ul>
<li><p>The <strong>effect of floor area</strong>, <strong>unit age</strong>, and <strong>proximity to amenities</strong> varies significantly across different locations in Woodlands.</p></li>
<li><p>The <strong>prediction results</strong> show a reasonable range of predicted resale prices, with substantial variance indicating the sensitivity of prices to local factors.</p></li>
</ul>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>gwr_pred_w <span class="ot">&lt;-</span> <span class="fu">gwr.predict</span>(<span class="at">formula =</span> resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox, </span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data=</span>train_data_sp_w, </span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">predictdata =</span> test_data_sp_w, </span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">bw=</span><span class="dv">100</span>, </span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">'gaussian'</span>, </span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">adaptive=</span><span class="cn">TRUE</span>, </span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>gwr_pred_w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   ***********************************************************************
   *                       Package   GWmodel                             *
   ***********************************************************************
   Program starts at: 2024-11-11 01:52:47.294196 
   Call:
   gwr.predict(formula = resale_price ~ floor_area_sqm + unit_age + 
    within_350m_busstop + within_350m_eldercare + hawker_prox + 
    within_350m_kindergarten + mall_prox + mrt_prox + park_prox + 
    within_1km_school + supermarket_prox, data = train_data_sp_w, 
    predictdata = test_data_sp_w, bw = 100, kernel = "gaussian", 
    adaptive = TRUE, longlat = FALSE)

   Dependent (y) variable for prediction:  resale_price
   Independent variables:  floor_area_sqm unit_age within_350m_busstop within_350m_eldercare hawker_prox within_350m_kindergarten mall_prox mrt_prox park_prox within_1km_school supermarket_prox
   Number of data points: 1391
   ***********************************************************************
   *     Results of Geographically Weighted Regression for prediction    *
   ***********************************************************************

   *********************Model calibration information*********************
   Kernel function: gaussian 
   Adaptive bandwidth: 100 (number of nearest neighbours)
   Distance metric: Euclidean distance metric is used.

   ****************Summary of GWR coefficient estimates:******************
                                        Min.     1st Qu.      Median
   Intercept_coef                -2.1902e+06 -9.3788e+04  6.7361e+05
   floor_area_sqm_coef           -3.3112e+03  1.8210e+03  2.2761e+03
   unit_age_coef                 -4.9718e+03 -4.5761e+03 -4.3469e+03
   within_350m_busstop_coef      -2.2179e+03 -6.0128e+02 -9.4503e+01
   within_350m_eldercare_coef    -4.5128e+04 -9.5403e+03 -5.8673e+03
   hawker_prox_coef              -2.2862e+05 -2.6585e+04 -1.4338e+04
   within_350m_kindergarten_coef -9.6328e+03 -2.6297e+03 -4.1932e+01
   mall_prox_coef                -4.8135e+04 -1.0964e+04 -3.7845e+03
   mrt_prox_coef                 -1.7215e+05 -4.2204e+04 -2.1621e+04
   park_prox_coef                -1.3435e+05 -4.0264e+04 -2.7108e+04
   within_1km_school_coef        -9.4865e+03 -5.4721e+03 -3.3587e+03
   supermarket_prox_coef         -9.7199e+04 -4.7539e+04 -3.3118e+04
                                     3rd Qu.      Max.
   Intercept_coef                 1.1117e+06 2976576.6
   floor_area_sqm_coef            2.5522e+03    3019.2
   unit_age_coef                 -3.7747e+03   -1769.4
   within_350m_busstop_coef       7.3075e+02    3301.4
   within_350m_eldercare_coef    -1.4672e+03    4353.7
   hawker_prox_coef               3.0435e+03  100863.4
   within_350m_kindergarten_coef  3.8679e+03   24965.7
   mall_prox_coef                 1.0691e+04   55502.5
   mrt_prox_coef                 -7.2434e+03  148627.2
   park_prox_coef                -1.3584e+04   94005.1
   within_1km_school_coef        -2.7247e+02    2829.4
   supermarket_prox_coef         -1.0807e+04   28141.1

   ****************       Results of GW prediction       ******************
                       Min.   1st Qu.    Median   3rd Qu.      Max.
   prediction        354574    475267    494160    528380    617913
   prediction_var 737877010 745713670 752120804 759546466 799428816

   ***********************************************************************
   Program stops at: 2024-11-11 01:53:19.356233 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwr_pred_w, <span class="st">"data/rds/ml/woodlands/gwr_pred_w.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Summary of GWR Coefficients</strong></p>
<p><strong>Interpretation</strong>:</p>
<ul>
<li><p><strong>Intercept</strong>: The baseline resale price in Woodlands varies significantly across locations, with a range from 373,726.15 to 929,191.50. This suggests that the average resale price can be strongly influenced by local spatial factors.</p></li>
<li><p><strong>Floor Area</strong>: The effect of floor area on resale price varies from a negative to a positive coefficient. In some locations, additional floor area has a relatively small positive impact, while in other locations, the effect is stronger.</p></li>
<li><p><strong>Unit Age</strong>: The negative impact of unit age on resale price is consistent across locations. Older units tend to have a more significant negative effect on resale prices, particularly in areas where newer properties dominate.</p></li>
<li><p><strong>Proximity to Amenities</strong>:</p>
<ul>
<li><p><strong>Bus Stops</strong>: Proximity to bus stops generally has a small positive effect in certain areas (range from -1,933.97 to 3,494.30).</p></li>
<li><p><strong>Elder Care Centers</strong>: The proximity to eldercare centers has a more varied effect, with the coefficient ranging from negative to positive. In some regions, this proximity significantly increases resale prices.</p></li>
<li><p><strong>Hawker Centers</strong>: The proximity to hawker centers shows a highly negative impact in many areas, especially in places where hawker centers are abundant and could be seen as less desirable.</p></li>
<li><p><strong>Kindergartens</strong>: Proximity to kindergartens has a positive effect on property prices in certain locations, especially in family-oriented neighborhoods.</p></li>
<li><p><strong>Malls, MRT, Parks</strong>: Proximity to malls and MRT stations tends to have a negative impact on resale prices in specific areas, while proximity to parks shows a more varied effect, with some areas benefiting from this proximity more than others.</p></li>
<li><p><strong>Supermarkets</strong>: Proximity to supermarkets has a small negative effect on resale prices in some areas but is generally less influential compared to other amenities.</p></li>
</ul></li>
</ul>
<p><strong>Prediction Results</strong></p>
<p><strong>Interpretation</strong>:</p>
<ul>
<li><p>The predicted resale prices range from <strong>$359,170</strong> to <strong>$616,562</strong>, with a median prediction of <strong>$493,786</strong>. This shows that the resale price in Woodlands varies significantly across locations.</p></li>
<li><p>The <strong>prediction variance</strong> is substantial, ranging from <strong>735 million</strong> to <strong>792 million</strong>. This suggests considerable variability in the predicted prices, likely due to differing local factors influencing property values across different areas of Woodlands.</p></li>
</ul>
<p><strong>Overall</strong></p>
<p>The <strong>Geographically Weighted Regression (GWR)</strong> model provides a more accurate prediction of resale prices in <strong>Woodlands</strong> compared to traditional global models. By accounting for spatial variability, the GWR model captures how the relationship between property features and resale price changes across different locations.</p>
<p><strong>Key findings</strong>:</p>
<ul>
<li><p><strong>Floor area</strong> and <strong>unit age</strong> have spatially varying impacts, with some regions showing stronger relationships between these variables and resale prices.</p></li>
<li><p><strong>Proximity to amenities</strong> such as <strong>hawker centers</strong>, <strong>MRT stations</strong>, and <strong>supermarkets</strong> shows spatial heterogeneity, with some areas benefiting more from proximity to these amenities than others.</p></li>
<li><p>The <strong>prediction results</strong> indicate that resale prices vary widely across Woodlands, with certain regions experiencing higher values based on local factors like proximity to key amenities.</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="random-forest" class="level2" data-number="1.12">
<h2 data-number="1.12" class="anchored" data-anchor-id="random-forest"><span class="header-section-number">1.12</span> Random Forest</h2>
<section id="extracting-coordinates-data" class="level3" data-number="1.12.1">
<h3 data-number="1.12.1" class="anchored" data-anchor-id="extracting-coordinates-data"><span class="header-section-number">1.12.1</span> Extracting coordinates data</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>coords_train_p <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(train_data_punggol)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>coords_test_p <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(test_data_punggol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Before continue, we write all the output into rds for future used.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>coords_train_p <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(coords_train_p, <span class="st">"data/rds/ml/punggol/coords_train_p.rds"</span> )</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>coords_test_p <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(coords_test_p, <span class="st">"data/rds/ml/punggol/coords_test_p.rds"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>coords_train_w <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(train_data_woodlands)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>coords_test_w <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(test_data_woodlands)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Before continue, we write all the output into rds for future used.</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>coords_train_w <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(coords_train_w, <span class="st">"data/rds/ml/coords_train_w.rds"</span> )</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>coords_test_w <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(coords_test_w, <span class="st">"data/rds/ml/coords_test_w.rds"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="dropping-geometry-field" class="level3" data-number="1.12.2">
<h3 data-number="1.12.2" class="anchored" data-anchor-id="dropping-geometry-field"><span class="header-section-number">1.12.2</span> Dropping geometry field</h3>
<p>First, we will drop geometry column of the sf data.frame by using <code>st_drop_geometry()</code> of sf package.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>train_data_punggol <span class="ot">&lt;-</span> train_data_punggol <span class="sc">%&gt;%</span> </span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>town)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>train_data_woodlands <span class="ot">&lt;-</span> train_data_woodlands <span class="sc">%&gt;%</span> </span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>town)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="calibrating-random-forest-model" class="level2" data-number="1.13">
<h2 data-number="1.13" class="anchored" data-anchor-id="calibrating-random-forest-model"><span class="header-section-number">1.13</span> Calibrating Random Forest Model</h2>
<p>In this section, you will learn how to calibrate a model to predict HDB resale price by using random forest function of <a href="https://cran.r-project.org/web/packages/ranger/index.html"><strong>ranger</strong></a> package.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>rf_p <span class="ot">&lt;-</span> <span class="fu">ranger</span>(resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox,</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>train_data_punggol)</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>rf_p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Ranger result

Call:
 ranger(resale_price ~ floor_area_sqm + unit_age + within_350m_busstop +      within_350m_eldercare + hawker_prox + within_350m_kindergarten +      mall_prox + mrt_prox + park_prox + within_1km_school + supermarket_prox,      data = train_data_punggol) 

Type:                             Regression 
Number of trees:                  500 
Sample size:                      1549 
Number of independent variables:  11 
Mtry:                             3 
Target node size:                 5 
Variable importance mode:         none 
Splitrule:                        variance 
OOB prediction error (MSE):       1285768219 
R squared (OOB):                  0.6229873 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(rf_p, <span class="st">"data/rds/ml/punggol/rf_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>rf_p <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/punggol/rf_p.rds"</span>)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>rf_p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Ranger result

Call:
 ranger(resale_price ~ floor_area_sqm + unit_age + within_350m_busstop +      within_350m_eldercare + hawker_prox + within_350m_kindergarten +      mall_prox + mrt_prox + park_prox + within_1km_school + supermarket_prox,      data = train_data_punggol) 

Type:                             Regression 
Number of trees:                  500 
Sample size:                      1549 
Number of independent variables:  11 
Mtry:                             3 
Target node size:                 5 
Variable importance mode:         none 
Splitrule:                        variance 
OOB prediction error (MSE):       1285768219 
R squared (OOB):                  0.6229873 </code></pre>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>rf_w <span class="ot">&lt;-</span> <span class="fu">ranger</span>(resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox,</span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>train_data_woodlands)</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>rf_w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Ranger result

Call:
 ranger(resale_price ~ floor_area_sqm + unit_age + within_350m_busstop +      within_350m_eldercare + hawker_prox + within_350m_kindergarten +      mall_prox + mrt_prox + park_prox + within_1km_school + supermarket_prox,      data = train_data_woodlands) 

Type:                             Regression 
Number of trees:                  500 
Sample size:                      1391 
Number of independent variables:  11 
Mtry:                             3 
Target node size:                 5 
Variable importance mode:         none 
Splitrule:                        variance 
OOB prediction error (MSE):       681781375 
R squared (OOB):                  0.7878284 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(rf_w, <span class="st">"data/rds/ml/woodlands/rf_w.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>rf_w <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/woodlands/rf_w.rds"</span>)</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>rf_w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Ranger result

Call:
 ranger(resale_price ~ floor_area_sqm + unit_age + within_350m_busstop +      within_350m_eldercare + hawker_prox + within_350m_kindergarten +      mall_prox + mrt_prox + park_prox + within_1km_school + supermarket_prox,      data = train_data_woodlands) 

Type:                             Regression 
Number of trees:                  500 
Sample size:                      1391 
Number of independent variables:  11 
Mtry:                             3 
Target node size:                 5 
Variable importance mode:         none 
Splitrule:                        variance 
OOB prediction error (MSE):       681781375 
R squared (OOB):                  0.7878284 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="calibrating-geographical-random-forest-model" class="level2" data-number="1.14">
<h2 data-number="1.14" class="anchored" data-anchor-id="calibrating-geographical-random-forest-model"><span class="header-section-number">1.14</span> Calibrating Geographical Random Forest Model</h2>
<p>In this section, you will learn how to calibrate a model to predict HDB resale price by using <code>grf()</code> of <a href="https://cran.r-project.org/web/packages/ranger/index.html"><strong>SpatialML</strong></a> package.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_p <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox,</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dframe=</span>train_data_punggol, </span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">bw=</span><span class="dv">55</span>,</span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">coords=</span>coords_train_p,</span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ntree =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Ranger result

Call:
 ranger(resale_price ~ floor_area_sqm + unit_age + within_350m_busstop +      within_350m_eldercare + hawker_prox + within_350m_kindergarten +      mall_prox + mrt_prox + park_prox + within_1km_school + supermarket_prox,      data = train_data_punggol, num.trees = 50, mtry = 3, importance = "impurity",      num.threads = NULL) 

Type:                             Regression 
Number of trees:                  50 
Sample size:                      1549 
Number of independent variables:  11 
Mtry:                             3 
Target node size:                 5 
Variable importance mode:         impurity 
Splitrule:                        variance 
OOB prediction error (MSE):       1310728297 
R squared (OOB):                  0.6156685 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>          floor_area_sqm                 unit_age      within_350m_busstop 
            6.326567e+11             1.156479e+12             1.244582e+11 
   within_350m_eldercare              hawker_prox within_350m_kindergarten 
            1.596830e+11             5.174056e+11             1.464665e+11 
               mall_prox                 mrt_prox                park_prox 
            5.932477e+11             3.333798e+11             2.561672e+11 
       within_1km_school         supermarket_prox 
            1.749702e+11             3.213997e+11 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-126714  -16526    2460    2945   23939  129080 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-96078.65 -13775.10    855.28    -58.52  14384.32 119674.72 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                               Min         Max       Mean        StD
floor_area_sqm                   0 91014202939 5906598515 9572494892
unit_age                 772992909 70292040371 9653682844 7816982408
within_350m_busstop              0 23284152693 2079171556 2163833036
within_350m_eldercare            0 22318151206  229763601  939144823
hawker_prox              125992847 77365795037 4763798655 4696341821
within_350m_kindergarten         0 22978183199  737940280 1744984043
mall_prox                 89425394 51937220048 4875866267 4755292035
mrt_prox                 131598882 29974992166 4057921881 3311668548
park_prox                108935979 38285549900 4649691712 4018345994
within_1km_school                0 22017741359  794052428 1434695546
supermarket_prox          38701460 63205009429 4233523256 4566974721</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_p, <span class="st">"data/rds/ml/punggol/gwRF_adaptive_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_p <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/punggol/gwRF_adaptive_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_w <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>                 unit_age <span class="sc">+</span> within_350m_busstop <span class="sc">+</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>                 within_350m_eldercare <span class="sc">+</span> hawker_prox <span class="sc">+</span> </span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>                 within_350m_kindergarten <span class="sc">+</span> mall_prox <span class="sc">+</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>                 mrt_prox <span class="sc">+</span> park_prox <span class="sc">+</span></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>                 within_1km_school <span class="sc">+</span></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>                 supermarket_prox,</span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dframe=</span>train_data_woodlands, </span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">bw=</span><span class="dv">55</span>,</span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">coords=</span>coords_train_w,</span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ntree =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Ranger result

Call:
 ranger(resale_price ~ floor_area_sqm + unit_age + within_350m_busstop +      within_350m_eldercare + hawker_prox + within_350m_kindergarten +      mall_prox + mrt_prox + park_prox + within_1km_school + supermarket_prox,      data = train_data_woodlands, num.trees = 50, mtry = 3, importance = "impurity",      num.threads = NULL) 

Type:                             Regression 
Number of trees:                  50 
Sample size:                      1391 
Number of independent variables:  11 
Mtry:                             3 
Target node size:                 5 
Variable importance mode:         impurity 
Splitrule:                        variance 
OOB prediction error (MSE):       699465884 
R squared (OOB):                  0.7823249 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>          floor_area_sqm                 unit_age      within_350m_busstop 
            6.498645e+11             1.523757e+12             8.640691e+10 
   within_350m_eldercare              hawker_prox within_350m_kindergarten 
            2.443447e+10             1.374084e+11             6.735891e+10 
               mall_prox                 mrt_prox                park_prox 
            2.366135e+11             4.865546e+11             2.638215e+11 
       within_1km_school         supermarket_prox 
            2.269810e+11             3.863464e+11 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-162753.7  -14222.8       0.0     207.3   15208.6  104482.1 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-73326.46  -8051.71    102.83    -40.93   8585.95  73157.76 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                               Min          Max       Mean         StD
floor_area_sqm                   0 119507423558 7235009419 12283139013
unit_age                 290434405 162351531337 9787543745 16190314956
within_350m_busstop       19024539 101166507333 3038063745  9092850294
within_350m_eldercare            0  43950239157  391375201  1601131616
hawker_prox              205434461 162703114194 4496604507  7941092644
within_350m_kindergarten         0  28289156658  710152654  1940630865
mall_prox                165366043  81654791451 4917757094  7011474221
mrt_prox                 310086561  77191474562 4237235607  5629134036
park_prox                166726290 137269067979 5310916373 12030607333
within_1km_school                0  70335686672 1024510779  4531548436
supermarket_prox         154822760 168893795321 5782731401 13086332964</code></pre>
</div>
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_w, <span class="st">"data/rds/ml/woodlands/gwRF_adaptive_w.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_w <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/woodlands/gwRF_adaptive_w.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<section id="predicting-by-using-test-data" class="level3" data-number="1.14.1">
<h3 data-number="1.14.1" class="anchored" data-anchor-id="predicting-by-using-test-data"><span class="header-section-number">1.14.1</span> Predicting by using test data</h3>
<section id="preparing-the-test-data" class="level4" data-number="1.14.1.1">
<h4 data-number="1.14.1.1" class="anchored" data-anchor-id="preparing-the-test-data"><span class="header-section-number">1.14.1.1</span> Preparing the test data</h4>
<p>The code chunk below will be used to combine the test data with its corresponding coordinates data.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>test_data_punggol <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data_punggol, coords_test_p) <span class="sc">%&gt;%</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>test_data_woodlands <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data_woodlands, coords_test_w) <span class="sc">%&gt;%</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="predicting-with-test-data" class="level4" data-number="1.14.1.2">
<h4 data-number="1.14.1.2" class="anchored" data-anchor-id="predicting-with-test-data"><span class="header-section-number">1.14.1.2</span> Predicting with test data</h4>
<p>Next, <code>predict.grf()</code> of spatialML package will be used to predict the resale value by using the test data and gwRF_adaptive model calibrated earlier.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>gwRF_pred_p <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_p, </span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>                           test_data_punggol, </span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y.var.name=</span><span class="st">"Y"</span>, </span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">global.w=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>GRF_pred_p <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(gwRF_pred_p, <span class="st">"data/rds/ml/punggol/gwRF_adaptive_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>gwRF_pred_w <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_w, </span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>                           test_data_woodlands, </span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y.var.name=</span><span class="st">"Y"</span>, </span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">global.w=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>GRF_pred_w <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(gwRF_pred_w, <span class="st">"data/rds/ml/woodlands/gwRF_adaptive_w.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="converting-the-predicting-output-into-a-data-frame" class="level4" data-number="1.14.1.3">
<h4 data-number="1.14.1.3" class="anchored" data-anchor-id="converting-the-predicting-output-into-a-data-frame"><span class="header-section-number">1.14.1.3</span> Converting the predicting output into a data frame</h4>
<p>The output of the <code>predict.grf()</code> is a vector of predicted values. It is wiser to convert it into a data frame for further visualisation and analysis.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>GRF_pred_p <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/punggol/gwRF_adaptive_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>GRF_pred_df_p <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(GRF_pred_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the code chunk below, <code>cbind()</code> is used to append the predicted values onto test_data</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>test_data_p <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data_punggol, GRF_pred_df_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(test_data_p, <span class="st">"data/rds/ml/punggol/test_data_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>GRF_pred_w <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ml/woodlands/gwRF_adaptive_w.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>GRF_pred_df_w <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(GRF_pred_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the code chunk below, <code>cbind()</code> is used to append the predicted values onto test_data</p>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>test_data_w <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data_woodlands, GRF_pred_df_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(test_data_w, <span class="st">"data/rds/ml/woodlands/test_data_w.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="calculating-root-mean-square-error" class="level3" data-number="1.14.2">
<h3 data-number="1.14.2" class="anchored" data-anchor-id="calculating-root-mean-square-error"><span class="header-section-number">1.14.2</span> Calculating Root Mean Square Error</h3>
<p>The root mean square error (RMSE) allows us to measure how far predicted values are from observed values in a regression analysis. In the code chunk below, rmse() of Metrics package is used to compute the RMSE.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rmse</span>(test_data_punggol<span class="sc">$</span>resale_price, </span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>     test_data_p<span class="sc">$</span>GRF_pred_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 49338.38</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(train_data_punggol<span class="sc">$</span>resale_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 456000  566000  605000  606094  645000  800000 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(test_data_p<span class="sc">$</span>resale_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 495000  610000  648000  650865  689166  788000 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Interpretation</strong></p>
<ol type="1">
<li><p><strong>Magnitude of the Error</strong>:</p>
<ul>
<li><p>The <strong>RMSE of</strong> $49,423.08 indicates that, on average, the model’s predicted resale prices deviate from the actual resale prices by approximately $<strong>49,423.08.</strong></p></li>
<li><p>Given that the <strong>mean resale price</strong> for the <strong>test dataset</strong> is $<strong>650,865</strong>, this RMSE represents about <strong>7.5%</strong> of the mean resale price. This indicates a relatively reasonable model performance, with predictions being on average about <strong>7.5%</strong> off from actual resale prices.</p></li>
</ul></li>
<li><p><strong>Comparison to Median</strong>:</p>
<ul>
<li><p>The <strong>median resale price</strong> in the <strong>test dataset</strong> is $<strong>648,000</strong>.</p></li>
<li><p>The <strong>RMSE of $49,423.08</strong> represents about <strong>7.6%</strong> of the median resale price, which suggests that the model’s predictions are, on average, off by <strong>7.6%</strong> from the actual resale price at the median.</p></li>
<li><p>Since the RMSE is around <strong>7.5-8%</strong> of both the <strong>mean</strong> and <strong>median resale prices</strong>, it suggests that the model performs fairly well, but there is still some degree of prediction error.</p></li>
</ul></li>
<li><p><strong>Model Performance</strong>:</p>
<ul>
<li>An RMSE of $<strong>49,423.08</strong> is typical for real estate predictive models. It shows that while the model has a strong performance, especially considering it accounts for the variance in resale prices, there’s still room for improvement, particularly for properties at the lower and higher price ranges.</li>
</ul></li>
<li><p><strong>Range of Resale Prices</strong>:</p>
<ul>
<li><p>The resale prices in the test dataset range from $495,000 to $788,000. Given this price range, the RMSE of $<strong>49,423.08</strong> suggests that the model is accurate within <strong>7-8%</strong> for most properties, but the error could be higher for properties at the extremes (either low or high price points).</p></li>
<li><p>The <strong>training dataset</strong> has similar price distributions, but with a slightly lower mean of $606,094 compared to the test dataset’s mean of $<strong>650,865</strong>, which suggests that the model may be slightly more optimistic for higher resale prices in the test set.</p></li>
</ul></li>
<li><p><strong>Comparison to the Training Data</strong>:</p>
<ul>
<li><p>The <strong>training dataset</strong> has a slightly higher mean resale price ($<strong>606,094</strong>) compared to the test dataset ($<strong>650,865</strong>), suggesting that the model might have been slightly undertrained or overfitted. This could be further analyzed by evaluating how well the model generalizes to the test data.</p></li>
<li><p>The relatively large <strong>spread</strong> between the lower and upper bounds of the resale prices (from $456,000 to $<strong>800,000</strong> in the training set) might also contribute to some variance in the predictions, though the RMSE indicates that the model is generally effective.</p></li>
</ul></li>
</ol>
<p><strong>Conclusion:</strong></p>
<p>The <strong>RMSE of</strong> $$49,423.08 for the Punggol test dataset, where the median resale price is <strong>648,000</strong>, indicates that the model’s predictions are on average about <strong>7.6%</strong> off from the actual resale prices. This suggests that the model performs reasonably well, with error margins that are typical for real estate prediction models. While this level of error is acceptable, there is still room for improvement, particularly for properties at the lower and higher ends of the price spectrum.</p>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rmse</span>(test_data_woodlands<span class="sc">$</span>resale_price, </span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>     test_data_w<span class="sc">$</span>GRF_pred_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 41784.94</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(train_data_woodlands<span class="sc">$</span>resale_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 350000  470000  500000  507168  545000  690000 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(test_data_w<span class="sc">$</span>resale_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 355000  508500  530000  540097  570000  701000 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Interpretation</strong></p>
<p>1. <strong>Magnitude of the Error</strong></p>
<ul>
<li><p>The <strong>RMSE of</strong> $42,038.73 indicates that, on average, the model’s predicted resale prices deviate from the actual resale prices by $<strong>42,038.73</strong></p></li>
<li><p>This is a <strong>7.8%</strong> error when compared to the <strong>mean resale price</strong> in the test dataset ($<strong>540,097</strong>). This suggests that, on average, the model’s predictions are off by about <strong>7.8%</strong> of the actual resale price, which is a reasonable error margin for many predictive models.</p></li>
</ul>
<p>2. <strong>Comparison to the Median</strong></p>
<ul>
<li><p>The <strong>median resale price</strong> in the <strong>test dataset</strong> is $<strong>530,000</strong>.</p></li>
<li><p>The <strong>RMSE of $42,038.73</strong> represents about <strong>7.9%</strong> of the median resale price. This level of error is typical for real estate predictive models, and the fact that the RMSE is about <strong>7.9%</strong> of the median indicates that the model performs well for most of the data points, but there may still be some variability in predictions for properties priced far below or above the median.</p></li>
</ul>
<p>3. <strong>Model Performance</strong></p>
<ul>
<li><p>The <strong>RMSE of $42,038.73</strong> shows that the model has a <strong>moderate level of predictive accuracy</strong>. An RMSE that is around <strong>7-8%</strong> of the median and mean resale prices is common for real estate prediction models, which often deal with diverse factors influencing property prices (e.g., location, condition of the property, etc.).</p></li>
<li><p>The fact that the RMSE is relatively small compared to the range of resale prices suggests that the model captures the general trends well. However, there could be room for improvement, especially for properties with prices that are on the lower or upper extremes of the price spectrum.</p></li>
</ul>
<p>4. <strong>Range of Resale Prices</strong></p>
<ul>
<li><p>The <strong>range of resale prices</strong> in the test dataset spans from $355,000 to $701,000, with the median at $530,000 and the mean at $<strong>540,097</strong>.</p></li>
<li><p>The RMSE of $42,038.73 indicates that, on average, the predicted resale prices are within 7-8% of the actual resale prices. This is reasonable for most properties, but properties at the lower end ($355,000) or the <strong>upper end</strong> ($701,000) of the price range might have higher prediction errors. This suggests that the model works well for mid-range properties, but its accuracy decreases as we move toward the extremes of the price range.</p></li>
</ul>
<p>5. <strong>Comparison to Training Data</strong></p>
<ul>
<li><p>The <strong>median resale price</strong> in the <strong>training dataset</strong> is $$500,000, which is 30,000 lower than the median resale price in the test dataset (5$<strong>30,000</strong>).</p></li>
<li><p>The <strong>mean</strong> resale price in the training dataset is $507,168, which is also slightly lower than the mean of $<strong>540,097</strong> in the test dataset.</p></li>
<li><p>This suggests that the test data might contain higher-value properties than the training data. Despite this difference, the model’s performance (as indicated by the RMSE) is fairly consistent, with the error remaining around <strong>7.8%</strong> of the test dataset’s mean resale price.</p></li>
<li><p>The <strong>RMSE of</strong> $42,038.73 relative to the training dataset’s median resale price of $<strong>500,000</strong> is approximately <strong>8.4%</strong>, which is slightly higher than the RMSE relative to the test dataset’s median. This indicates that the model performs slightly better on the test dataset, potentially due to the difference in price distributions.</p></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p>The <strong>RMSE of</strong> $42,038.73 for the Woodlands test dataset, where the median resale price is $<strong>530,000</strong>, suggests that the model’s predictions are, on average, about <strong>7.9%</strong> off from the actual resale prices. This is a reasonable level of predictive accuracy, indicating that the model is performing well overall, with small but acceptable prediction errors for properties within the typical price range.</p>
<p>The model appears to perform slightly better on the <strong>test dataset</strong>, which has higher property prices than the training dataset. Further model refinement or feature adjustment may help reduce errors for properties at the extremes of the price range. However, for general purposes, the model seems reliable for predicting resale prices within the observed price ranges.</p>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="visualising-the-predicted-values" class="level2" data-number="1.15">
<h2 data-number="1.15" class="anchored" data-anchor-id="visualising-the-predicted-values"><span class="header-section-number">1.15</span> Visualising the predicted values</h2>
<p>Alternatively, scatterplot can be used to visualise the actual resale price and the predicted resale price by using the code chunk below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code Chunk</summary>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test_data_p,</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> GRF_pred_p,</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> resale_price)) <span class="sc">+</span></span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TakeHome3_files/figure-html/unnamed-chunk-217-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Observation</p>
<ol type="1">
<li><p><strong>Positive Correlation</strong>:</p>
<ul>
<li><p>There is a clear <strong>positive relationship</strong> between the predicted resale prices (<strong>GRF_pred_p</strong>) and the actual resale prices (<strong>resale_price</strong>). As the predicted resale prices increase, the actual resale prices also tend to increase.</p></li>
<li><p>This suggests that the model’s predictions are generally in line with the observed data, as higher predicted values correspond to higher actual resale prices.</p></li>
</ul></li>
<li><p><strong>Trend and Distribution</strong>:</p>
<ul>
<li><p>The points follow an upward trend, with a generally <strong>tight clustering</strong> around the line of best fit (not shown, but implied by the alignment of points). This indicates that the model is effectively capturing the main trend in the data.</p></li>
<li><p>The scatter is somewhat <strong>spread out</strong>, indicating some variance between the predicted and actual resale prices. This is typical in any real-world prediction model, as it shows that the model is not perfect and that there are some discrepancies between predicted and actual values.</p></li>
</ul></li>
<li><p><strong>Outliers</strong>:</p>
<ul>
<li>Although the points generally follow a clear upward trend, there might be a few <strong>outliers</strong> or data points that deviate significantly from the general trend. These outliers could represent cases where the model performs poorly or where there are unusual observations in the data.</li>
</ul></li>
<li><p><strong>Model Fit</strong>:</p>
<ul>
<li>The strong linear trend suggests that the model has captured the general relationship between the variables, but some level of variability remains. To assess how well the model performs, you would typically calculate performance metrics like <strong>R-squared</strong>, <strong>RMSE</strong>, or <strong>MAE</strong> to quantify how well the model’s predictions match the actual values.</li>
</ul></li>
</ol>
<p>Conclusion:</p>
<p>The scatterplot shows that there is a positive relationship between predicted resale prices (<strong>GRF_pred_p</strong>) and actual resale prices (<strong>resale_price</strong>). This suggests that the model is successful in capturing the general trend of the data, but some discrepancies remain, which is expected in any predictive model. Further analysis, such as residual analysis or model evaluation metrics, could be done to refine the model and assess its performance more thoroughly.</p>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observation</strong></p>
<ol type="1">
<li><p><strong>Positive Correlation</strong>:</p>
<ul>
<li><p>There is a <strong>strong positive correlation</strong> between <strong>GRF_pred_w</strong> (predicted resale prices) and <strong>resale_price</strong> (actual resale prices). As the predicted resale prices increase, the actual resale prices also tend to increase.</p></li>
<li><p>This indicates that the model’s predictions are generally aligned with the observed data, and the higher predicted values tend to correspond to higher actual resale prices.</p></li>
</ul></li>
<li><p><strong>Trend and Distribution</strong>:</p>
<ul>
<li><p>The points show a clear <strong>upward trend</strong>, indicating a <strong>good linear relationship</strong> between the predicted and actual values.</p></li>
<li><p>The scatter around the trend is <strong>relatively tight</strong>, meaning that the model’s predictions are fairly close to the actual resale prices. This suggests that the model is capturing the trend in the data well.</p></li>
</ul></li>
<li><p><strong>Outliers</strong>:</p>
<ul>
<li>Some <strong>outliers</strong> may exist at the higher end of the resale price range. These points appear to deviate slightly from the general trend, but they do not seem to be too far from the line of best fit. These outliers could represent cases where the model does not predict well for certain properties, possibly due to extreme values or unique characteristics of those observations.</li>
</ul></li>
<li><p><strong>Model Fit</strong>:</p>
<ul>
<li>The strong linear relationship in the scatterplot indicates that the model fits the data well. However, there may still be room for improvement in reducing the variance in predictions, as indicated by the slight spread of points, especially for lower resale prices.</li>
</ul></li>
<li><p><strong>Comparison to the Previous Scatterplot</strong>:</p>
<ul>
<li>Compared to the first scatterplot with <strong>GRF_pred_p</strong>, this scatterplot (with <strong>GRF_pred_w</strong>) shows a <strong>similar pattern</strong> of positive correlation between predicted and actual resale prices. Both scatterplots indicate good predictive performance, with minor deviations in predicted values at the lower and higher ends.</li>
</ul></li>
</ol>
<p>Conclusion:</p>
<p>The scatterplot suggests that the model with <strong>GRF_pred_w</strong> effectively captures the relationship between the predictors and actual resale prices, with strong predictive accuracy. The positive correlation and tight clustering of points indicate that the model is reliable for predicting resale prices. However, further evaluation using residual analysis or model evaluation metrics could help identify areas for improvement, particularly in the presence of outliers.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="evaluation-of-model-geographically-weighted-regression-vs-random-forest" class="level2" data-number="1.16">
<h2 data-number="1.16" class="anchored" data-anchor-id="evaluation-of-model-geographically-weighted-regression-vs-random-forest"><span class="header-section-number">1.16</span> Evaluation of Model: Geographically Weighted Regression Vs Random Forest</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true"><strong>Punggol</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false"><strong>Woodlands</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<p>To compare the two methods—Random Forest (RF) and Geographically Weighted Regression (GWR)—for predicting resale prices in Punggol, let’s focus on the prediction accuracy and model performance.</p>
<p>1. Prediction Accuracy:</p>
<p>Random Forest:</p>
<ul>
<li><p>RMSE: The Random Forest model has an RMSE of 49,423.08, which measures the average error between the predicted and actual resale prices. A lower RMSE indicates better accuracy.</p></li>
<li><p>Price Distribution:</p>
<ul>
<li><p><strong>Training Data</strong>: Min 456,000, Median 605,000, Max 800,000.</p></li>
<li><p><strong>Test Data</strong>: Min 495,000, Median 648,000, Max 788,000.</p></li>
</ul></li>
</ul>
<p>The predicted resale prices in the test data are within the expected range and the RMSE indicates that the Random Forest model performs fairly well.</p>
<p>GWR:</p>
<ul>
<li><p>Predicted Values: The predicted resale prices from the GWR model range from 463,945 to 707,938, with a median of 609,348.</p></li>
<li><p>Prediction Variance: The variance of predictions ranges from 1.25 billion to 1.4 billion, indicating some spread in the predictions, which is typical of GWR since it accounts for spatial variability.</p></li>
</ul>
<p>The predicted resale prices from GWR are also within the expected range, with a similar spread as the actual test data.</p>
<ol start="2" type="1">
<li>Model Calibration:</li>
</ol>
<p>Random Forest:</p>
<ul>
<li><p>Strength: Random Forest is well-suited for handling complex, non-linear relationships between predictors without explicit assumptions about their functional form.</p></li>
<li><p>Weakness: It is harder to interpret and doesn’t directly provide insights into how individual variables (like distance to bus stops, malls, etc.) influence the resale prices.</p></li>
</ul>
<p>GWR:</p>
<ul>
<li><p>Strength: GWR allows for spatial variation in the coefficients, meaning it can show how the effect of each predictor (like <code>floor_area_sqm</code>, <code>unit_age</code>, etc.) changes across different locations. This makes GWR especially valuable for understanding local variations in resale prices.</p></li>
<li><p>Weakness: GWR requires more complex interpretation, as it provides different coefficients for each observation based on the local neighborhood.</p></li>
</ul>
<ol start="3" type="1">
<li>Which Model is Better?</li>
</ol>
<ul>
<li><p>Prediction Accuracy: Both models provide similar ranges of predicted resale prices. However, Random Forest has a slightly better RMSE (49,423.08), which suggests it may perform slightly better in terms of overall prediction accuracy.</p></li>
<li><p>Interpretability: GWR excels in interpretability, as it provides insights into how different factors affect resale prices in different parts of Punggol, thanks to its spatially varying coefficients. This is valuable if you need to understand the localized impact of each predictor.</p></li>
</ul>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<p>1. Prediction Accuracy:</p>
<p>Random Forest:</p>
<ul>
<li><p>RMSE: The RMSE for the Random Forest model is 42,038.73. Lower RMSE indicates better prediction accuracy, and this value is quite reasonable, suggesting good performance for predicting resale prices.</p></li>
<li><p>Price Summary:</p>
<ul>
<li><p><strong>Training Data</strong>: Min 350,000, Median 500,000, Max 690,000.</p></li>
<li><p><strong>Test Data</strong>: Min 355,000, Median 530,000, Max 701,000.</p></li>
</ul>
<p>The test data’s price distribution suggests that the model is predicting within the expected range.</p></li>
</ul>
<p>GWR:</p>
<ul>
<li><p>Prediction: The GWR model gives predicted resale prices ranging from 359,170 to 616,562, with a median of 493,786. This is fairly close to the actual resale prices in the test data (from 355,000 to 701,000), indicating that GWR is also performing reasonably well for predictions.</p></li>
<li><p>Prediction Variance: The prediction variance ranges from 735,748,898 to 792,698,476, suggesting that the GWR model’s predictions have some spread, but this is expected since GWR accounts for spatial variation.</p></li>
</ul>
<ol start="2" type="1">
<li>Model Calibration:</li>
</ol>
<p>Random Forest:</p>
<ul>
<li>Random Forest tends to perform well when capturing complex, non-linear relationships between predictors. It doesn’t offer easy interpretability, but it can model interactions between variables without explicitly specifying them. Given that the RMSE is relatively low (42,038.73), the model seems to be doing well in predicting resale prices.</li>
</ul>
<p>GWR:</p>
<ul>
<li><p>Model Calibration Information: The coefficients for the GWR model vary spatially, and the values seem reasonable (e.g., for <code>floor_area_sqm</code>, the coefficient ranges from -3419.735 to 3037.7). These coefficients represent the local effect of each variable on resale prices.</p></li>
<li><p>Interpretability: One key strength of GWR is that it allows you to understand how each variable affects resale prices differently in various spatial locations (e.g., the effect of proximity to bus stops, hawker centers, or supermarkets varies across the region).</p></li>
</ul>
<ol start="3" type="1">
<li>Which Model is Better?</li>
</ol>
<ul>
<li><p>Prediction Accuracy: Both models give similar ranges for predicted resale prices, and both seem to predict the prices reasonably well. However, Random Forest generally provides a more reliable prediction with lower RMSE (42,038.73), indicating better overall performance in terms of predictive accuracy.</p></li>
<li><p>Interpretability: If you need to understand how each factor influences resale prices in different regions of Woodlands, GWR is a better choice because of its spatially varying coefficients and ability to show how variables interact with location.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="limitations" class="level2" data-number="1.17">
<h2 data-number="1.17" class="anchored" data-anchor-id="limitations"><span class="header-section-number">1.17</span> Limitations</h2>
<p>This study only looks into two the top two towns that has the most transactions and the transactions are slightly below 2 years. Hence, the sample size may be size which inevitably affecting the model. Thus, future proposal may look into top 5 - 10 towns over a span of 5 years. Additonally, only two predictive models were used. Future studies may consider other models such as Xboost in comparing across the models predictive abilities.</p>
</section>
<section id="conclusion" class="level2" data-number="1.18">
<h2 data-number="1.18" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">1.18</span> Conclusion</h2>
<p>To summarise, Random Forest is better in predicting HDB resale prices. However, geospatial details are heavily embedded in HDB resale data, we shouldn’t discount the spatial aspects that will affect the resale prices too. If the study’s purpose is to understand spatial patterns, GWR is more suited. Conversely, if accuracy is a priority, Random Forest would be a better choice.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>